<!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.jpg?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.jpg?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="github,hexo,next,coding,"><meta name="description" content="这是一个关于搭建个人博客网站的折腾过程，自己的体会是：痛并快乐着！"><meta property="og:type" content="article"><meta property="og:title" content="hexo+next打造精美的个人博客网站"><meta property="og:url" content="https://www.qcmoke.cn/blog/hexo_next.html"><meta property="og:site_name" content="Qcmoke&#39;s Blog"><meta property="og:description" content="这是一个关于搭建个人博客网站的折腾过程，自己的体会是：痛并快乐着！"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="og:image" content="https://www.qcmoke.cn/images/loading-post.gif"><meta property="article:published_time" content="2018-09-13T20:13:00.000Z"><meta property="article:modified_time" content="2024-07-29T14:05:29.111Z"><meta property="article:author" content="Qcmoke"><meta property="article:tag" content="github"><meta property="article:tag" content="hexo"><meta property="article:tag" content="next"><meta property="article:tag" content="coding"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.qcmoke.cn/images/loading-post.gif"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"5.1.4",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!0,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.qcmoke.cn/blog/hexo_next.html"><title>hexo+next打造精美的个人博客网站 | Qcmoke's Blog</title><meta name="generator" content="Hexo 4.2.1"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Qcmoke's Blog</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Peace & Love ! Learning to think independently !</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-热文"><a href="/top/" rel="section"><i class="menu-item-icon fa fa-fw fa-fire"></i><br>热文</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="menu-item-icon fa fa-fw fa-link"></i><br>友链</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.qcmoke.cn/blog/hexo_next.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Qcmoke"><meta itemprop="description" content=""><meta itemprop="image" content="/images/logo.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Qcmoke's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">hexo+next打造精美的个人博客网站</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-14T04:13:00+08:00">2018-09-14 </time><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于&#58;</span> <time title="更新于" itemprop="dateModified" datetime="2024-07-29T22:05:29+08:00">2024-07-29 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/blog/" itemprop="url" rel="index"><span itemprop="name">blog</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/hexo_next.html#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/blog/hexo_next.html" itemprop="commentCount"></span> </a></span><span id="/blog/hexo_next.html" class="leancloud_visitors" data-flag-title="hexo+next打造精美的个人博客网站"><span class="post-meta-divider">|</span> <span class="lv-inline-block" style="display:inline-block"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数&#58;</span> <span class="leancloud-visitors-count"></span></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">30.9k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">148</span></div><div class="post-description">这是一个关于搭建个人博客网站的折腾过程，自己的体会是：痛并快乐着！</div></div></header><div class="post-body" itemprop="articleBody"><p><a href="https://hexo.io/zh-cn" target="_blank" rel="noopener">Hexo</a> 是一个快速、简洁且高效的博客框架。Hexo 使用 <a href="http://daringfireball.net/projects/markdown/" target="_blank" rel="noopener">Markdown</a>（或其他渲染引擎）解析文章，在几秒内，即可利用hexo生成静态网页。</p><a id="more"></a><h1 id="基础功能篇"><a class="header-anchor" href="#基础功能篇">¶</a>基础功能篇</h1><h2 id="1-搭建hexo环境"><a class="header-anchor" href="#1-搭建hexo环境">¶</a>1. 搭建hexo环境</h2><p>要搭建hexo+github的个人博客，首先需要确保安装了git和node.js。</p><h3 id="1-安装和配置git"><a class="header-anchor" href="#1-安装和配置git">¶</a>1) 安装和配置git</h3><p>关于git的安装和配置请参考《<a href="../tools/win_git.html" name="../tools/win_git.md" id="hexo-md-link">windows10安装git并连接github</a>》，确保git安装成功并能上传文件到github仓库。</p><blockquote><p>温馨提示：一定要配置好ssh key，参考的教程中有指导。</p></blockquote><h3 id="2-安装node-js"><a class="header-anchor" href="#2-安装node-js">¶</a>2) 安装node.js</h3><p>git安装配置好后还要安装node.js，请至<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">官网下载node.js</a>。</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1759057642.png" alt="1759057642.png"></p><p>node.js的具体安装从头到尾傻瓜式“下一步”。不过安装路径建议选择非系统盘目录。安装好后，检测PATH环境变量是否配置了Node.js，打开cmd 或者安装好git后的git bash，输入如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ node --version</span><br></pre></td></tr></table></figure><p>出现node.js的版本信息则说明安装成功。</p><h3 id="3-安装hexo"><a class="header-anchor" href="#3-安装hexo">¶</a>3) 安装hexo</h3><p>以上都完成后打开git bash输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli  <span class="comment">#使用 npm 安装 Hexo</span></span><br></pre></td></tr></table></figure><p>出现如下信息表示下载并安装完成。<br><img src="/blog/../images/loading-post.gif" data-original="hexo_next/999028275.png" alt="999028275.png"></p><h3 id="4-使用hexo"><a class="header-anchor" href="#4-使用hexo">¶</a>4) 使用hexo</h3><p>安装 Hexo 完成后，在任意目录执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init myblog  <span class="comment"># 初始化hexo工作区，此时myblog是工作区</span></span><br><span class="line">$ <span class="built_in">cd</span> myblog		  <span class="comment"># 进入工作区	</span></span><br><span class="line">$ npm install	  <span class="comment"># 安装hexo默认使用的一些基础包，可以不用执行，因为初始化时已经默认安装了这些基础包。但如果在初始化时安装这些基础包失败时，可以通过这条命令重新安装一遍。</span></span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂不要输入 <code>$</code>和 <code>#</code>及其之后的注释内容。</p></blockquote><p>新建完成后，指定文件夹的目录如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── <span class="built_in">source</span></span><br><span class="line">|   ├── _drafts</span><br><span class="line">|   └── _posts</span><br><span class="line">└── themes</span><br></pre></td></tr></table></figure><p>编译并运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g <span class="comment"># 编译生成静态文件</span></span><br><span class="line">$ hexo s <span class="comment"># 启动运行服务</span></span><br></pre></td></tr></table></figure><p>执行以上命令之后，hexo就会在 <code>public</code>文件夹生成相关 <code>html</code>文件，这些文件将来都是要提交到github去的。<code>hexo s</code>是开启本地预览服务，打开浏览器访问 <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> 即可看到内容，很多人会碰到浏览器一直在转圈但是就是加载不出来的问题，一般情况下是因为端口占用的缘故，可以使用:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo s -p port 	<span class="comment">#自定义端口方式启动hexo服务。</span></span><br></pre></td></tr></table></figure><p>其他命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean  	<span class="comment">#清理public的内容</span></span><br><span class="line">$ hexo n file 	<span class="comment">#新建文章，file指的是markdown文章文件的名称</span></span><br></pre></td></tr></table></figure><h2 id="2-编写文章"><a class="header-anchor" href="#2-编写文章">¶</a>2. 编写文章</h2><p>首先要在 <code>myblog/source</code>目录下创建一篇文章，命名为：<code>name.md</code>，如：<code>first-article.md</code> 。</p><p>或者用hexo创建一篇文章，打开git bash输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo n first_article</span><br></pre></td></tr></table></figure><p>完成后 <code>source/_posts</code>目录下会多出 <code>first-article.md</code>文件。 如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/2738396249.png" alt="15.PNG"></p><p>打开 <code>first-article.md</code>，修改表头后开始通过markdown语法来书写文章。 内容如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: first_article</span><br><span class="line">date: 2018-09-14 14:27:24</span><br><span class="line">tags:</span><br><span class="line"><span class="bullet">    - </span>分享</span><br><span class="line"><span class="bullet">    - </span>first</span><br><span class="line">categories: 碎碎念</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="section"># 正文</span></span><br><span class="line">哥们，这是你的第一篇文章~</span><br></pre></td></tr></table></figure><p>其中 <code>categories</code>是给分类栏添加分类项，或者将文章归纳到&quot;碎碎念&quot;分类项里；而 <code>tags</code>表示的是文字的标签，可以写多个，比如我写了 <code>分享</code>和 <code>first</code>。</p><p>完成后编译并运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure><p>然后浏览器访问测试博客，你会发现分类菜单和标签菜单里就会有内容显示了。</p><h2 id="3-更换主题"><a class="header-anchor" href="#3-更换主题">¶</a>3. 更换主题</h2><p>可以到 <a href="https://hexo.io/themes/" target="_blank" rel="noopener">hexo官方主题</a> 下载主题模板。在这里我推荐使用next主题，文档齐全，社区也活跃。官网：<a href="http://theme-next.iissnan.com" target="_blank" rel="noopener">http://theme-next.iissnan.com</a></p><p>下载主题包后放到 <code>myblog/themes/</code> 下。比如我们要用next主题（使用对的版本是5.1.4），则可以进入 <code>myblog/themes/</code>目录下然后执行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/iissnan/hexo-theme-next.git</span><br><span class="line">$ mv hexo-theme-next next</span><br></pre></td></tr></table></figure><p>然后修改 <code>myblog/_config.yml</code>中的 <code>theme: landscape</code>改为 <code>theme: next</code></p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1297497270.png" alt="1297497270.png"></p><p>完成后重新编译并运行测试。</p><h2 id="4-更换主题布局"><a class="header-anchor" href="#4-更换主题布局">¶</a>4. 更换主题布局</h2><p>next提供了4种布局供选择，我这里选的是Gemini。打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>Scheme Settings</code>找到如下代码块，并在 <code>scheme: Muse</code>的前面添加 <code>#</code>，然后去掉 <code>#scheme: Gemini</code>前面的 <code>#</code>,修改后如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Scheme Settings</span></span><br><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment">#scheme: Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br></pre></td></tr></table></figure><p>完成后重新编译运行测试，你会发现博客的主题布局已经变了。</p><h2 id="5-菜单栏添加菜单选项"><a class="header-anchor" href="#5-菜单栏添加菜单选项">¶</a>5. 菜单栏添加菜单选项</h2><p>next默认菜单栏只有 <code>home</code>和 <code>archives</code>菜单选项，你可以添加更多的菜单选项，比如这里我们添加 <code>tags</code>和 <code>categories</code>。只需打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>Menu Settings</code>找到如下图代码块，然后将 <code>tags</code>和 <code>categories</code>选项前的注释符号 <code>#</code>去掉就能启用这两个菜单。如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/772797496.png" alt="1.PNG"></p><blockquote><p>💁‍♂提示： NexT 使用的是 <a href="http://fontawesome.io/" target="_blank" rel="noopener">Font Awesome</a> 提供的图标，可以去Font Awesome获取自定义的图标。</p></blockquote><p>完成后重新编译并运行，然后浏览器输入<a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a>，你会发现多出来了两个菜单选项。如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/2915187449.png" alt="2.PNG"></p><p>虽然是有了这两个菜单选项，但当你点击这些新菜单时会发现只有类似 <code>Cannot GET /tags/</code>这样的提示。此时你肯定会手足无措。别担心，之所以会有这样的提示，是因为next默认只启动了这两个菜单项，然并没有找到 <code>tags</code>和 <code>categories</code>页面，你需要做的是创建这两个页面，创建的过程很简单，并不需要你有什么编程基础，你只需要输入以下命令hexo就能帮你生成这两个页面。</p><p>在站点根目录下打开你心爱的git bash。然后输入以下两条命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo n page tags</span><br><span class="line">$ hexo n page categories</span><br></pre></td></tr></table></figure><p>完成后你会发现 <code>myblog/source/</code>目录会出现两个文件夹，如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1245276923.png" alt="3.PNG"></p><p>打开 <code>myblog/source/categories</code>目录下的 <code>index.md</code>，修改内容为以下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 分类</span><br><span class="line">date: 2018-09-14 12:18:35</span><br><span class="line">type: categories</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>打开 <code>myblog/source/tags/</code>目录下的 <code>index.md</code>，修改内容为以下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2018-09-14 12:17:57</span><br><span class="line">type: tags</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，此时你再打开浏览器输入<a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a>，点击 <code>tags</code>和 <code>categories</code>菜单时会发现已经可以打开页面了。</p><h2 id="6-默认中文简体显示设置"><a class="header-anchor" href="#6-默认中文简体显示设置">¶</a>6. 默认中文简体显示设置</h2><p>打开全局配置文件 <code>myblog/_config.yml</code>，搜索找到 <code>language</code>，改为以下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">zh-Hans</span></span><br></pre></td></tr></table></figure><p>如图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/2120958148.png" alt="4.PNG"></p><p>这里的 <code>zh-Hans</code>要根据 <code>myblog/themes/next/languages</code>目录下的语言配置文件的名称来设置，也有可能是 <code>zh-CN</code>。(如在此目录里打开 <code>zh-Hans.yml</code>文件，发现里面是简体中文，那就对了，注意：这里的文件的名称不填文件后缀名 <code>.yml</code>)</p><p>完成后重新编译并运行测试，效果如下：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/3742059932.png" alt="5.PNG"></p><h2 id="7-更改博客作者名和主页地址"><a class="header-anchor" href="#7-更改博客作者名和主页地址">¶</a>7. 更改博客作者名和主页地址</h2><p>打开 <code>myblog/_config.yml</code>全局配置文件，搜索关键词 <code>Site</code>找到如下图的地方</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/2409326136.png" alt="7.PNG"></p><p>然后修改以下三处：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">Qcmoke's</span> <span class="string">Blog</span>  <span class="comment">#站点名称</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Qcmoke</span>        <span class="comment">#作者名称</span></span><br><span class="line"></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://qcmoke.github.io</span>   <span class="comment">#填github page的url即可</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，效果如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/893799543.png" alt="8.PNG"></p><h2 id="8-启用侧边栏社交链接"><a class="header-anchor" href="#8-启用侧边栏社交链接">¶</a>8. 启用侧边栏社交链接</h2><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>Social</code>找到下图位置：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1070341581.png" alt="9.PNG"></p><p>根据自身情况进行修改或者添加，注意：一定要去掉 <code>#social:</code>前的 <code>#</code>才能生效。我的如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/2059238549.png" alt="10.PNG"></p><p>完成后重新编译并运行，效果如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1706498607.png" alt="11.PNG"></p><h2 id="9-侧栏添加外链"><a class="header-anchor" href="#9-侧栏添加外链">¶</a>9. 侧栏添加外链</h2><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>Blog rolls</code>找到下图位置：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/2289683925.png" alt="12.PNG"></p><p>根据自身情况进行修改或者添加，注意：一定要去掉 <code>#links:</code>前的 <code>#</code>才能生效。我的如下图</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/3977116600.png" alt="13.PNG"></p><p>完成后重新编译并运行，效果如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/299295497.png" alt="14.PNG"></p><h2 id="10-去除侧栏目录自动生成的序数"><a class="header-anchor" href="#10-去除侧栏目录自动生成的序数">¶</a>10.去除侧栏目录自动生成的序数</h2><p>编辑 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>toc</code>找到如下代码，<code>number</code>默认是 <code>true</code>，将 <code>number</code>设置为 <code>false</code>，如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Automatically add list number to toc.</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># If true, all words will placed on next lines if header width longer then sidebar width.</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="11-设置头像"><a class="header-anchor" href="#11-设置头像">¶</a>11. 设置头像</h2><h3 id="1-基础设置"><a class="header-anchor" href="#1-基础设置">¶</a>1) 基础设置</h3><p>找一张你喜欢的头像图片放入 <code>myblog/themes/next/source/images</code>目录中，例如我这里放了一张 <code>logo.jpg</code>。然后打开 <code>myblog/themes/next/_config.yml</code>主题配置文件。找到关键字 <code>avatar</code>,在后面加入 <code>logo.jpg</code>的路径地址（注意：是想相对路径）。如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/4189536790.png" alt="6.PNG"></p><p>如果你想另外添加一个点击侧栏头像就能回到博客首页的功能，其实很简单，只需要将图片变成一个可以点击的图片链接。打开文件位置：<code>myblog/themes/next/layout/_macro/sidebar.swig</code>,找到如下代码块。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"site-author-image"</span> <span class="attr">itemprop</span>=<span class="string">"image"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for( theme.avatar | default(theme.images + '/avatar.gif') ) &#125;&#125;"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">alt</span>=<span class="string">"&#123;&#123; theme.author &#125;&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>将以上代码块外面添加一个指向博客主页的a标签。即修改成以下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"site-author-image"</span> <span class="attr">itemprop</span>=<span class="string">"image"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for( theme.avatar | default(theme.images + '/avatar.gif') ) &#125;&#125;"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">alt</span>=<span class="string">"&#123;&#123; theme.author &#125;&#125;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行进行测试。</p><h3 id="2-定制圆形头像"><a class="header-anchor" href="#2-定制圆形头像">¶</a>2) 定制圆形头像</h3><p>打开站点下的	<code>myblog/themes/next/source/css/_common/components/sidebar/sidebar-author.styl</code>文件 ,在 <code>.site-author-image</code>选择器的末尾（右括号前）添加</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line"><span class="attribute">transition</span>: <span class="number">2s</span> all;</span><br></pre></td></tr></table></figure><p>在 <code>.site-author-image</code>选择器右括号后另起一行,加入以下代码：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.site-author-image</span>:hover&#123;</span><br><span class="line">  <span class="attribute">transform</span>: rotate(<span class="number">360deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>或者你可以看下面的代码会更加直观。</p><p>原来的：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.site-author-image</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="variable">$site</span>-author-image-padding;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="variable">$site</span>-author-image-width;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">$site</span>-author-image-height;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">$site</span>-author-image-border-width solid <span class="variable">$site</span>-author-image-border-color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改后：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.site-author-image</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="variable">$site</span>-author-image-padding;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="variable">$site</span>-author-image-width;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">$site</span>-author-image-height;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">$site</span>-author-image-border-width solid <span class="variable">$site</span>-author-image-border-color;</span><br><span class="line">  <span class="attribute">opacity</span>: hexo-config(<span class="string">'avatar.opacity'</span>) is a <span class="string">'unit'</span> ? hexo-config(<span class="string">'avatar.opacity'</span>) : <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">2s</span> all;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.site-author-image</span>:hover&#123;</span><br><span class="line">  <span class="attribute">transform</span>: rotate(<span class="number">360deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，效果如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/3399304512.png" alt="17.PNG"></p><h2 id="12-设置浏览器标签图标"><a class="header-anchor" href="#12-设置浏览器标签图标">¶</a>12. 设置浏览器标签图标</h2><p>将一张图标32x32像素大小的图标favicon.jpg放入 <code>myblog/themes/next/source/images</code>目录里，打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>favicon</code>，找到如下代码块，并做相应修改。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">small:</span> <span class="string">/images/favicon-16x16-next.png</span>  </span><br><span class="line">  <span class="comment">#medium: /images/favicon-32x32-next.png</span></span><br><span class="line">  <span class="attr">medium:</span> <span class="string">/images/favicon.jpg</span>  <span class="comment">#浏览器标签图标在这里设置</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/images/apple-touch-icon-next.png</span></span><br><span class="line">  <span class="attr">safari_pinned_tab:</span> <span class="string">/images/logo.svg</span></span><br><span class="line">  <span class="comment">#android_manifest: /images/manifest.json</span></span><br><span class="line">  <span class="comment">#ms_browserconfig: /images/browserconfig.xml</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，浏览器输入<a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a>访问你的博客，发现你的博客的浏览器标签图标已经变了。</p><h2 id="13-首页文章缩略描述设置"><a class="header-anchor" href="#13-首页文章缩略描述设置">¶</a>13. 首页文章缩略描述设置</h2><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>auto_excerpt</code>找到如下位置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure><p>修改enable和length，修改后如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，效果如下图:</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/948096695.png" alt="18.PNG"></p><h2 id="14-添加3d动画背景"><a class="header-anchor" href="#14-添加3d动画背景">¶</a>14. 添加3D动画背景</h2><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>canvas</code>找到如下位置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Canvas-nest</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-canvas-nest</span></span><br><span class="line"><span class="attr">canvas_nest:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># JavaScript 3D library.</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-three</span></span><br><span class="line"><span class="comment"># three_waves</span></span><br><span class="line"><span class="attr">three_waves:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment"># canvas_lines</span></span><br><span class="line"><span class="attr">canvas_lines:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment"># canvas_sphere</span></span><br><span class="line"><span class="attr">canvas_sphere:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>看你喜欢哪种动画背景风格，分别有 <code>canvas_nest</code>、<code>three_waves</code>、<code>canvas_lines</code>、<code>canvas_sphere</code>四种，选择一种然后将冒号后面的 <code>false</code>改成 <code>true</code>。这里我选择的是第一种 <code>canvas_nest</code>，改成如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Canvas-nest</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-canvas-nest</span></span><br><span class="line"><span class="attr">canvas_nest:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># JavaScript 3D library.</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-three</span></span><br><span class="line"><span class="comment"># three_waves</span></span><br><span class="line"><span class="attr">three_waves:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment"># canvas_lines</span></span><br><span class="line"><span class="attr">canvas_lines:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment"># canvas_sphere</span></span><br><span class="line"><span class="attr">canvas_sphere:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，完成后你会发现博客网页已经出现好看的动态背景了。</p><h2 id="15-增加本地搜索功能"><a class="header-anchor" href="#15-增加本地搜索功能">¶</a>15. 增加本地搜索功能</h2><p>需要安装 <code>hexo-generator-searchdb</code>插件来实现这个功能，在站点的根目录下执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure><p>编辑 <code>myblog/_config.yml</code>全局配置文件，新增以下内容到任意位置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>local_search</code>找到如下代码，<code>enable</code>默认是 <code>false</code>，将 <code>enable</code>设置为 <code>true</code>，如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，完成后你会发现博客菜单栏上已经出现了搜索项了。</p><h2 id="16-置顶按钮显示百分比"><a class="header-anchor" href="#16-置顶按钮显示百分比">¶</a>16. 置顶按钮显示百分比</h2><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>scrollpercent</code>。 将其值设置为true。效果如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538356072444.png" alt="1538356072444"></p><h2 id="17-文章字数和阅读时长统计"><a class="header-anchor" href="#17-文章字数和阅读时长统计">¶</a>17. 文章字数和阅读时长统计</h2><p>需要安装 <code>hexo-wordcount</code>这个插件来实现这个功能，在站点根目录下打开git bash，输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-wordcount --save</span><br></pre></td></tr></table></figure><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>post_wordcount</code>。<br>将其配置修改成以下代码：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_wordcount:</span></span><br><span class="line">  <span class="attr">item_text:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">wordcount:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">totalcount:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行测试。</p><h2 id="18-隐藏底部的-强力驱动-内容"><a class="header-anchor" href="#18-隐藏底部的-强力驱动-内容">¶</a>18. 隐藏底部的“强力驱动”内容</h2><p>打开 <code>myblog/themes/next/layout/_partials/footer.swig</code>,搜索关键字 <code>theme.footer.powered.enable</code>，通过 <code>&lt;!-- --&gt;</code>注释掉如下代码。<br><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1147445624.png" alt="19.PNG"></p><p>完成后重新编译并运行，你会发现博客已经隐藏掉了底部的“强力驱动”内容了。</p><h2 id="19-图片点击放大功能支持"><a class="header-anchor" href="#19-图片点击放大功能支持">¶</a>19. 图片点击放大功能支持</h2><p>默认fancybox开启后，所有文字的图片都会强制被加入到了fancybox弹出框，并且fancybox会和图片链接冲突，如果想让某些图片禁用fancybox的话可以对next做一些修改来实现这个小功能。</p><p>修改 <code>themes/next/source/js/src/utils.js</code>文件：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  wrapImageWithFancyBox: function () &#123;</span><br><span class="line">    $('.content img')</span><br><span class="line">      .not('[hidden]')</span><br><span class="line">      .not('.group-picture img, .post-gallery img')</span><br><span class="line">      .each(function () &#123;</span><br><span class="line">        var $image = $(this);</span><br><span class="line"><span class="addition">+        if ($image.hasClass('nofancybox')) return;</span></span><br><span class="line">        var imageTitle = $image.attr('title');</span><br><span class="line">        var $imageWrapLink = $image.parent('a');</span><br></pre></td></tr></table></figure><p>然后在使用的时候，给不需要 fancybox 的标签中添加class属性 <code>class=&quot;nofancybox&quot;</code>，如果 class 属性中已经有其它内容，也可以以空格并列，比如下面：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"logoimg nofancybox"</span> <span class="attr">src</span>=<span class="string">"/images/logo.jpg"</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="20-文章应用本地图片"><a class="header-anchor" href="#20-文章应用本地图片">¶</a>20. 文章应用本地图片</h2><blockquote><p>写博客时虽然可以通过第三方图床给hexo文章插入图片，但如果你和我一样总害怕哪天第三方图床提供商被无故和谐了或者关闭服务了，那么通过相对路径从本地引入图片的方案无疑是再好不过的方案。hexo允许你在 <code>myblog/source/images</code>目录下放入图片（这里的images目录如果没有需要你自己创建），当hexo编译时会将图片放入到 <code>myblog/public/images</code>目录里。由于部署博客其实就是部署 <code>public</code>目录，所以引用图片的方式也就是 <code>![](/images/image.jpg)</code>。因此要将博客文章引用的本地图片都存到 <code>myblog/source/images</code>目录里。但如果所有的图片都放到同一个目录里会导致后期维护的成本很大。</p><p>为解决以上的问题，hexo支持通过其他目录的方式引入图片，只要修改 <code>myblog/_config.yml</code>全局配置文件，将 <code>post_asset_folder:</code>这个选项设置为 <code>true</code>，就能将图片放置到markdown文件所在目录下的同名文件夹里，但需要通过类似<code>![](2018/09/21/article/image.jpg)</code>的方式来引用图片，明显这样一长串的路径引用是很糟糕的。</p><p>为解决以上的问题，可以使用 <code>hexo-asset-image</code>插件来实现类似<code>![](article/image.jpg)</code>的相对路径引用方式来引用图片，操作如下：</p></blockquote><p>（1）安装hexo-asset-image</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure><p>（2）将全局配置文件 <code>myblog/_config.yml</code>里的 <code>post_asset_folder:</code>这个选项设置为 <code>true</code></p><p>（3）新建一篇markdown文章做测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#执行该命令会在myblog/source/_posts/文件夹内除了生成newpage.md文件外，还生成一个同名的newpage文件夹</span></span><br><span class="line">$ hexo n newpage</span><br></pre></td></tr></table></figure><p>（4）引用本地图片</p><p>要插入图片时，只需要将图片放入 <code>newpage</code>文件夹中，比如放入一张名为test.png的图片，那么在newpage.md中通过以下markdown语句来引用该图片：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">test</span>](<span class="link">newpage/test.png</span>)</span><br></pre></td></tr></table></figure><p>（5）编译并启动测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure><p>完成后你会发现博客中相关的文章能正常显示图片了。</p><h2 id="21-修改文章链接组成形式"><a class="header-anchor" href="#21-修改文章链接组成形式">¶</a>21. 修改文章链接组成形式</h2><blockquote><p>Hexo默认的文章链接形式是一个四级url——<code>https://domain/year/month/day/demo.html</code>，可能造成url过长，对搜索引擎是十分不友好。我们可以改成<code>https://domain/demo.html</code>的形式。</p></blockquote><p>编辑全局配置文件<code>myblog/_config.yml</code>，做如下修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#permalink: :year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:title.html</span></span><br></pre></td></tr></table></figure><p>执行以下命令重新部署即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure><blockquote><p>但是为了更好管理文章，我更愿意用<code>https://domain/分类/demo.html</code>的形式来定义文章的url。比如我本地<code>myblog/source/_posts</code>目录下管理的文章（markdown文件）非常多，会很不容易查找到。那我可以根据<code>_posts</code>目录下markdown文件的类别进行分类，并在<code>_posts</code>目录下建立与文章相关的文件夹，将这些文章分类好后放入到这些分类文件夹里存放。比如我有一篇文件名为hexo_next.md的文章。文章的标题叫《hexo next主题设置与完善》，那么我根据自己的喜好建立一个名为<code>blog</code>的文件夹，并将hexo_next.md放到这个文件夹里。以工作区根目录为起始点的大概的结构如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt;.</span><br><span class="line">&gt;├── _config.yml</span><br><span class="line">&gt;├── package.json</span><br><span class="line">&gt;├── scaffolds</span><br><span class="line">&gt;├── <span class="built_in">source</span></span><br><span class="line">&gt;|   ├── _drafts</span><br><span class="line">&gt;|   └── _posts</span><br><span class="line">&gt;|         ├── blog  <span class="comment">#本例分类文件夹</span></span><br><span class="line">&gt;|         |    ├── hexo_next.md    <span class="comment">#本例文章（markdown文件）</span></span><br><span class="line">&gt;|         |    ├── hexo_next       <span class="comment">#本地存放hexo_next.md里所需图片的文件夹</span></span><br><span class="line">	  |    ├── typecho_move.md <span class="comment">#其他同类别的文章 </span></span><br><span class="line">&gt;|         |    └── typecho_move       </span><br><span class="line">&gt;|		  ├── devops  <span class="comment">#其他分类文件夹</span></span><br><span class="line">&gt;|		  ├── linux</span><br><span class="line">&gt;|		  ├── sql</span><br><span class="line">&gt;|         └── tools</span><br><span class="line">&gt;└── themes</span><br></pre></td></tr></table></figure><p>经过静态化处理后，那么我的url形式就变成了<code>https://domain/blog/hexo_next.html</code>。这样处理的好处就是既能很好的管理文章，又能对seo起到很好的优化作用，那何乐而不为呢？</p></blockquote><h2 id="21-支持emoji文字表情"><a class="header-anchor" href="#21-支持emoji文字表情">¶</a>21. 支持emoji文字表情</h2><p>如何让markdown可以解析emoji呢？实际上我们发现，在一些编辑器中输入 <code>:blush:</code> 并没有表情出现（当然有的编辑器可以，比如我现在使用的typora就很给力），这是为什么呢？ 这是markdown编辑器渲染引擎的问题 。同样的，Hexo也要对markdown文件进行渲染，而Hexo目前默认渲染引擎是 <code>hexo-renderer-marked</code>,可惜这个渲染器似乎不支持插件扩展，当然就不行了。那怎么解决呢？这里就要说 <code>hexo-renderer-markdown-it</code>插件了，这个渲染器插件是支持扩展，我们可以使用这个渲染引擎来支持 <code>emoji</code>表情，具体实现过程如下：</p><ul><li><p>更换渲染器</p><p>进入blog跟目录，执行如下命令</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm un hexo-renderer-marked --save           <span class="comment">#卸载hexo默认渲染器hexo-renderer-marked</span></span><br><span class="line">$ npm i hexo-renderer-markdown-it --save       <span class="comment">#安装渲染器hexo-renderer-markdown-it</span></span><br></pre></td></tr></table></figure><ul><li>安装emoji插件，执行如下命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install markdown-it-emoji --save</span><br></pre></td></tr></table></figure><ul><li>编辑站点配置文件<br>打开 <code>myblog/_config.yml</code>站点配置文件，添加如下内容</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Markdown-it config</span></span><br><span class="line"><span class="comment">## Docs: https://github.com/celsomiranda/hexo-renderer-markdown-it/wiki</span></span><br><span class="line"><span class="attr">markdown:</span></span><br><span class="line">  <span class="attr">render:</span></span><br><span class="line">    <span class="attr">html:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">xhtmlOut:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">breaks:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">linkify:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">typographer:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">quotes:</span> <span class="string">'“”‘’'</span></span><br><span class="line">  <span class="attr">plugins:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">markdown-it-abbr</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">markdown-it-footnote</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">markdown-it-ins</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">markdown-it-sub</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">markdown-it-sup</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">markdown-it-emoji</span>  <span class="comment"># add emoji</span></span><br><span class="line">  <span class="attr">anchors:</span></span><br><span class="line">    <span class="attr">level:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">collisionSuffix:</span> <span class="string">'v'</span></span><br><span class="line">    <span class="attr">permalink:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">permalinkClass:</span> <span class="string">header-anchor</span></span><br><span class="line">    <span class="attr">permalinkSymbol:</span> <span class="string">¶</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，你会发现博客中相关的文章能正常显示 <code>emoji</code>表情了。比如下面的markdown经过编译成html后，网页访问会得到这个笑脸：😄</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: emoji test</span><br><span class="line">date: 2018-09-14 04:13:00</span><br><span class="line">---</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- more --&gt;</span></span></span><br><span class="line"></span><br><span class="line">:smile:</span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂更多的 <code>emoji</code>写法可参考:</p><p>📚https://www.webfx.com/tools/emoji-cheat-sheet/</p></blockquote><h2 id="22-更改上下篇的顺序"><a class="header-anchor" href="#22-更改上下篇的顺序">¶</a>22. 更改上下篇的顺序</h2><p>默认next文章下面的&quot;上一篇，下一篇&quot;是旧发布的文章在上篇里的，但是如果希望新的发布文章在上篇的话就要做修改或者配置了，最新版本的next似乎已经可以直接在主题配置文件里设置了，但我这里使用的是旧版本的next5.1.4，所以需要深入源码进行修改，可以参考下面的方案。</p><p>编辑 <code>blog/themes/next/layout/_macro/post.swig</code> 然后做以下修改：</p><p>找到以下代码块。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if not is_index and (post.prev or post.next) %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-nav"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-nav-next post-nav-item"</span>&gt;</span></span><br><span class="line">      &#123;% if post.next %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.next.path) &#125;&#125;"</span> <span class="attr">rel</span>=<span class="string">"next"</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; post.next.title &#125;&#125;"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-chevron-left"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> &#123;&#123; post.next.title &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-nav-divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-nav-prev post-nav-item"</span>&gt;</span></span><br><span class="line">      &#123;% if post.prev %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.prev.path) &#125;&#125;"</span> <span class="attr">rel</span>=<span class="string">"prev"</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; post.prev.title &#125;&#125;"</span>&gt;</span></span><br><span class="line">          &#123;&#123; post.prev.title &#125;&#125; <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-chevron-right"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>将以上代码修改成以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if not is_index and (post.prev or post.next) %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-nav"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-nav-next post-nav-item"</span>&gt;</span></span><br><span class="line">      &#123;% if post.prev %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.prev.path) &#125;&#125;"</span> <span class="attr">rel</span>=<span class="string">"prev"</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; post.prev.title &#125;&#125;"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-chevron-left"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> &#123;&#123; post.prev.title &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-nav-divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-nav-prev post-nav-item"</span>&gt;</span></span><br><span class="line">      &#123;% if post.next %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.next.path) &#125;&#125;"</span> <span class="attr">rel</span>=<span class="string">"next"</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; post.next.title &#125;&#125;"</span>&gt;</span></span><br><span class="line">          &#123;&#123; post.next.title &#125;&#125; <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-chevron-right"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h2 id="23-添加页面加载效果"><a class="header-anchor" href="#23-添加页面加载效果">¶</a>23. 添加页面加载效果</h2><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>pace_theme</code>找到如下代码位置，将 <code>pace</code>设置为 <code>true</code>，<code>pace_theme</code>可以根据列出了的样式进行选择：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Progress bar in the top during page loading.</span></span><br><span class="line"><span class="attr">pace:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># Themes list:</span></span><br><span class="line"><span class="comment">#pace-theme-big-counter</span></span><br><span class="line"><span class="comment">#pace-theme-bounce</span></span><br><span class="line"><span class="comment">#pace-theme-barber-shop</span></span><br><span class="line"><span class="comment">#pace-theme-center-atom</span></span><br><span class="line"><span class="comment">#pace-theme-center-circle</span></span><br><span class="line"><span class="comment">#pace-theme-center-radar</span></span><br><span class="line"><span class="comment">#pace-theme-center-simple</span></span><br><span class="line"><span class="comment">#pace-theme-corner-indicator</span></span><br><span class="line"><span class="comment">#pace-theme-fill-left</span></span><br><span class="line"><span class="comment">#pace-theme-flash</span></span><br><span class="line"><span class="comment">#pace-theme-loading-bar</span></span><br><span class="line"><span class="comment">#pace-theme-mac-osx</span></span><br><span class="line"><span class="comment">#pace-theme-minimal</span></span><br><span class="line"><span class="comment"># For example</span></span><br><span class="line"><span class="comment"># pace_theme: pace-theme-center-simple</span></span><br><span class="line"><span class="attr">pace_theme:</span> <span class="string">pace-theme-minimal</span></span><br></pre></td></tr></table></figure><p>效果如下：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/pace-gif.gif" alt="pace-gif"></p><h2 id="24-图片懒加载"><a class="header-anchor" href="#24-图片懒加载">¶</a>24. 图片懒加载</h2><p>懒加载，即在需要的时候才加载图片，而不是一次性加载完整个页面的图片,使用lazyload插件实现懒加载可以有效提高博客的访问速度。</p><p>在Hexo博客目录下，执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-lazyload-image --save</span><br></pre></td></tr></table></figure><p>编辑Hexo主配置文件 <code>myblog/_config.yml</code>,添加如下配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lazyload:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">onlypost:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment">#loadingImg: ../images/loading-post.gif</span></span><br></pre></td></tr></table></figure><blockquote><p>参数：</p><p>enable：是否开启图片做懒加载功能</p><p>onlypost：是否仅文章中的图片做懒加载，如果为 false，则主题中的其他图片，也会做懒加载，如头像，logo 等任何图片。</p><p>loadingImg：图片未加载时的代替图，不填写使用默认加载图片，如果需要自定义，添填入 loading 图片地址，如果是本地图片，不要忘记把图片添加到你的主题目录下。 Next 主题需将图片放到 <code>themes/next/source/images</code> 目录下，然后引用时：<code>loadingImg: ../images/xxx.gif</code></p></blockquote><p>效果如下：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/loading-gif.gif" alt="loading-gif"></p><h2 id="25-开启打赏功能"><a class="header-anchor" href="#25-开启打赏功能">¶</a>25. 开启打赏功能</h2><p>首先要将支付宝和微信的收款码图片放到 <code>myblog/themes/next/source/images</code>目录里。</p><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>reward</code>找到下图位置：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1600849011.png" alt="16.PNG"></p><p>根据自身情况进行修改或者添加，注意：一定去掉元素前面的 <code>#</code>才能生效。我的如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reward</span></span><br><span class="line">reward_comment: 如果你觉得我的文章对你有帮助，你可以打赏我哦~</span><br><span class="line">wechatpay: /images/wechatpay.png</span><br><span class="line">alipay: /images/alipay.jpg</span><br><span class="line"><span class="comment">#bitcoin: /images/bitcoin.png</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，浏览器访问博客时，你会发现每篇文章底部就会有打赏的小图标了。</p><h2 id="26-文章分享功能"><a class="header-anchor" href="#26-文章分享功能">¶</a>26. 文章分享功能</h2><p>这里我提供了三种方案，推荐下文说的第二种方案。</p><h3 id="方案1-jiathis"><a class="header-anchor" href="#方案1-jiathis">¶</a>方案1 jiathis</h3><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>jiathis</code>，找到如下代码。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#jiathis:</span></span><br><span class="line">  <span class="comment">##uid: Get this uid from http://www.jiathis.com/</span></span><br><span class="line"><span class="comment">#add_this_id:</span></span><br></pre></td></tr></table></figure><p>去掉 <code>#jiathis:</code>前的 <code>#</code>，并在其后添加 <code>true</code>结果如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jiathis:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment">##uid: Get this uid from http://www.jiathis.com/</span></span><br><span class="line"><span class="comment">#add_this_id:</span></span><br></pre></td></tr></table></figure><p>不知道为什么有bug，无法加载出图标，也不能点击。于是恢复原样后，改用第二种方案。</p><h3 id="方案2-needmoreshare2"><a class="header-anchor" href="#方案2-needmoreshare2">¶</a>方案2 needmoreshare2</h3><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>needmoreshare2</code>，找到如下代码并做以下修改。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">needmoreshare2:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">postbottom:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">options:</span></span><br><span class="line">      <span class="attr">iconStyle:</span> <span class="string">box</span></span><br><span class="line">      <span class="attr">boxForm:</span> <span class="string">horizontal</span></span><br><span class="line">      <span class="attr">position:</span> <span class="string">bottomCenter</span></span><br><span class="line">      <span class="attr">networks:</span> <span class="string">Weibo,Wechat,Douban,QQZone,Twitter,Facebook</span></span><br><span class="line">  <span class="attr">float:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">options:</span></span><br><span class="line">      <span class="attr">iconStyle:</span> <span class="string">box</span></span><br><span class="line">      <span class="attr">boxForm:</span> <span class="string">horizontal</span></span><br><span class="line">      <span class="attr">position:</span> <span class="string">middleRight</span></span><br><span class="line">      <span class="attr">networks:</span> <span class="string">Weibo,Wechat,Douban,QQZone,Twitter,Facebook</span></span><br></pre></td></tr></table></figure><p>不过我发现next 5.1.4版本中微信加载不出二维码,应该是封装好的微信分享链接失效了。我是通过老版本的仓库https://github.com/iissnan/hexo-theme-next安装的，所以有这个问题，而新版本的next是没有这个问题的。新版本仓库已经搬迁到了https://github.com/theme-next 。</p><p>虽然我安装的是老版本，不过这里我也提供了解决办法。站点根目录下打开git bash，输入以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rm -rf themes/next/<span class="built_in">source</span>/lib/needsharebutton</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/theme-next/theme-next-needmoreshare2 themes/next/<span class="built_in">source</span>/lib/needsharebutton</span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，你会发现博客已经出现分享服务图标了，并且点击微信分享图标也可以加载出分享二维码了。</p><h3 id="方案3-baidushare"><a class="header-anchor" href="#方案3-baidushare">¶</a>方案3 baidushare</h3><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>baidushare</code>，找到如下代码并做修改。修改后如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#baidushare:</span></span><br><span class="line"><span class="comment">##  type: button</span></span><br><span class="line"><span class="attr">baidushare:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">button</span></span><br><span class="line">  <span class="attr">baidushare:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，你会发现博客已经出现分享服务图标了。</p><h2 id="27-优化深色代码高亮背景"><a class="header-anchor" href="#27-优化深色代码高亮背景">¶</a>27. 优化深色代码高亮背景</h2><p>在主题配置文件修改代码高亮背景为深色背景后，当在博客文章上选择代码时，选择到的颜色也为深色，虽然和背景色还是有点点区别，但是不好区分。所以经过一番研究，才有了以下优化教程。</p><p>在 <code>myblog/themes/next/source/css/_custom/custom.styl</code>中添加以下样式代码：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//page code background-color</span></span><br><span class="line"><span class="selector-class">.code</span> ::selection &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#2593a6</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.code</span> +mobile() &#123;</span><br><span class="line">   <span class="attribute">background</span>: <span class="number">#2593a6</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//gitalk code background-color </span></span><br><span class="line"><span class="selector-class">.gt-container</span> <span class="selector-class">.gt-comment-content</span> <span class="selector-class">.highlight</span> pre, <span class="selector-class">.markdown-body</span> pre&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#2d2d2d</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.gt-container</span> <span class="selector-class">.gt-comment-content</span> <span class="selector-class">.highlight</span> ::selection &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#2593a6</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上代码优化了所以高亮代码区域，包括gitalk评论区的高亮代码。 这些样式代码是通过浏览器调试而得，如有其它样式的需求，可参考本示例在浏览器中调试。</p><h2 id="28-优化文章底部带标签"><a class="header-anchor" href="#28-优化文章底部带标签">¶</a>28. 优化文章底部带标签</h2><p>打开 <code>myblog/themes/next/layout/_macro/post.swig</code>文件,搜索 <code>rel=&quot;tag&quot;&gt;#</code>,将 <code>#</code> 换成 <code>&lt;i class=&quot;fa fa-tag&quot;&gt;</code>，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-tags"</span>&gt;</span></span><br><span class="line">    &#123;% for tag in post.tags %&#125;</span><br><span class="line">       <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(tag.path) &#125;&#125;"</span> <span class="attr">rel</span>=<span class="string">"tag"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-tag"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> &#123;&#123; tag.name &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="29-文章末尾添加-本文结束-标记"><a class="header-anchor" href="#29-文章末尾添加-本文结束-标记">¶</a>29. 文章末尾添加“本文结束”标记</h2><p>在路径 <code>myblog/themes/next/layout/_macro</code>中新建 <code>passage-end-tag.swig</code>文件,并复制以下代码到 <code>passage-end-tag.swig</code> 中：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% if not is_index %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align:center;color: #ccc;font-size:14px;"</span>&gt;</span>----------- 本文结束 -----------<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>打开myblog/themes/next/layout/_macro/下的post.swig文件,找到如下代码块：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;#####################&#125;</span><br><span class="line">&#123;### END POST BODY ###&#125;</span><br><span class="line">&#123;#####################&#125;</span><br></pre></td></tr></table></figure><p>在以上代码块的<strong>上面</strong>另起一行添加如下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% if not is_index %&#125;</span><br><span class="line">    &#123;% include 'passage-end-tag.swig' %&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后打开主题配置文件myblog/themes/next/_config.yml,在末尾添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文章末尾添加“本文结束”标记</span></span><br><span class="line"><span class="attr">passage_end_tag:</span></span><br><span class="line"><span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="30-优化文章内链接文本样式"><a class="header-anchor" href="#30-优化文章内链接文本样式">¶</a>30. 优化文章内链接文本样式</h2><p>在 <code>myblog/themes/next/source/css/_custom/custom.styl</code>中添加以下样式代码：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章内链接文本样式</span></span><br><span class="line"><span class="selector-class">.post-body</span> <span class="selector-tag">p</span> a&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#0593d3</span>;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: none;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>可以根据自己的喜好使用浏览器调试得到相应的样式。</p></blockquote><h2 id="31-gemini布局返回顶部按钮适配移动端"><a class="header-anchor" href="#31-gemini布局返回顶部按钮适配移动端">¶</a>31. Gemini布局返回顶部按钮适配移动端</h2><p>由于自己不才，为了解决以下问题，不知花了多少时间和精力。在这个折腾的过程中，有上过百度和谷歌搜了好多的教程但却无功而返；后来又尝试通过浏览器调试来解决这个问题，也同样以失败而告终。在几近绝望时，网友分享了一篇博客文章《<a href="https://leaferx.online/2017/02/05/EnableTOConMobile/" target="_blank" rel="noopener">在移动设备下启用NexT主题的目录页面和回到顶部按钮</a>》，经参考并做修改后才有了以下简陋的教程。</p><ul><li>教程开始：</li></ul><p>编辑 <code>themes/next/source/css/_common/components</code>目录下的 <code>back-to-top.styl</code>和 <code>back-to-top-sidebar.styl</code>文件。用 <code>/* */</code>注释掉以下代码。（注意：两个文件都要注释掉）</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+tablet() &#123;</span><br><span class="line">  fixbutton() if hexo-config('sidebar.onmobile');</span><br><span class="line">  hide() if not hexo-config('sidebar.onmobile');</span><br><span class="line">&#125;</span><br><span class="line">+mobile() &#123;</span><br><span class="line">  fixbutton() if hexo-config('sidebar.onmobile');</span><br><span class="line">  hide() if not hexo-config('sidebar.onmobile');</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注释后如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  +tablet() &#123;</span></span><br><span class="line"><span class="comment">    fixbutton() if hexo-config('sidebar.onmobile');</span></span><br><span class="line"><span class="comment">    hide() if not hexo-config('sidebar.onmobile');</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  +mobile() &#123;</span></span><br><span class="line"><span class="comment">    fixbutton() if hexo-config('sidebar.onmobile');</span></span><br><span class="line"><span class="comment">    hide() if not hexo-config('sidebar.onmobile');</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  */</span></span><br></pre></td></tr></table></figure><h2 id="32-禁用特定文章侧栏目录"><a class="header-anchor" href="#32-禁用特定文章侧栏目录">¶</a>32. 禁用特定文章侧栏目录</h2><p>对于Muse布局，如果页面含有多级标题，那么默认是会自动展开侧栏抽屉目录的，但实际的使用中，我们不希望比如关于页面，友情页面等等自动展开目录，那么就需要对next做一定的修改来实现这个需求。</p><p>找到了 <code>themes/next/layout/_marcro/sidebar.swig</code>中找到下一列信息。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">set</span> display_toc = is_post and theme.toc.enable or is_page and theme.toc.enable %&#125;</span><br></pre></td></tr></table></figure><p>将其修改为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">set</span> display_toc = is_post and theme.toc.enable and !page.no_toc or is_page and theme.toc.enable and !page.no_toc %&#125;</span><br></pre></td></tr></table></figure><p>如果需要指定某篇文章禁用侧栏目录，只需要在该文章Front-Matter部分添加一个 <code>no_toc: true</code>即可。</p><p>如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 友情链接</span><br><span class="line">date: 2020-02-18 22:32:49</span><br><span class="line">no_toc: true</span><br><span class="line">comments: true</span><br><span class="line">---</span><br></pre></td></tr></table></figure><blockquote><p>方案来源：<a href="http://master.hellosenlin.netlify.com/posts/24546/" target="_blank" rel="noopener">http://master.hellosenlin.netlify.com/posts/24546/</a></p></blockquote><h2 id="33-文章引用音乐和视频"><a class="header-anchor" href="#33-文章引用音乐和视频">¶</a>33. 文章引用音乐和视频</h2><h3 id="1-html原生方式"><a class="header-anchor" href="#1-html原生方式">¶</a>1) html原生方式</h3><h4 id="1-音乐面板"><a class="header-anchor" href="#1-音乐面板">¶</a>(1) 音乐面板</h4><p>在markdown文章里使用 HTML 的标签引入，写法如下</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">"https://什么什么什么.mp3"</span> <span class="attr">style</span>=<span class="string">"max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;"</span> <span class="attr">controls</span>=<span class="string">"controls"</span> <span class="attr">loop</span>=<span class="string">"loop"</span> <span class="attr">preload</span>=<span class="string">"meta"</span>&gt;</span>Your browser does not support the audio tag.<span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-视频面板"><a class="header-anchor" href="#2-视频面板">¶</a>(2) 视频面板</h4><p>在markdown文章里使用 HTML 的标签引入，写法如下</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">poster</span>=<span class="string">"https://封面图.jpg"</span> <span class="attr">src</span>=<span class="string">"https://什么什么什么.mp4"</span> <span class="attr">style</span>=<span class="string">"max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;"</span> <span class="attr">controls</span>=<span class="string">"controls"</span> <span class="attr">loop</span>=<span class="string">"loop"</span> <span class="attr">preload</span>=<span class="string">"meta"</span>&gt;</span>Your browser does not support the video tag.<span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-第三方插件方式"><a class="header-anchor" href="#2-第三方插件方式">¶</a>2) 第三方插件方式</h3><h4 id="1-音乐面板插件"><a class="header-anchor" href="#1-音乐面板插件">¶</a>(1) 音乐面板插件</h4><p>此前有尝试过使用网易云音乐外链的方式给博客加入音乐面板，但使用的过程中发现有一些音乐因为版权原因播放不了，还有就是不完全支持 https，导致小绿锁不见了。要解决这些缺点，就需要另辟蹊径转而安装第三方音乐面板插件了，<a href="https://github.com/MoePlayer/hexo-tag-aplayer" target="_blank" rel="noopener">hexo-tag-aplayer</a>是一个音乐面板插件，功能很强大，相比于原生html的视频面板而言，可玩性更丰富，比如可以有歌词，歌单列表等等。废话不多说，直接上教程。</p><p><strong>安装音乐面板插件</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-tag-aplayer --save</span><br></pre></td></tr></table></figure><p><strong>单首歌曲的形式</strong></p><p>通过模板语法在markdown文章里引入，写法如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% aplayer "歌曲名" "歌手名" "https://什么什么什么.mp3" "https://封面图.jpg" "lrc:https://歌词.lrc" %&#125;</span><br></pre></td></tr></table></figure><p><strong>歌单的形式</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% aplayerlist %&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">    "autoplay": false,</span></span><br><span class="line"><span class="code">    "showlrc": 3,</span></span><br><span class="line"><span class="code">    "mutex": true,</span></span><br><span class="line"><span class="code">    "music": [</span></span><br><span class="line"><span class="code">        &#123;</span></span><br><span class="line"><span class="code">            "title": "歌曲名",</span></span><br><span class="line"><span class="code">            "author": "歌手名",</span></span><br><span class="line"><span class="code">            "url": "https://什么什么什么.mp3",</span></span><br><span class="line"><span class="code">            "pic": "https://封面图.jpg",</span></span><br><span class="line"><span class="code">            "lrc": "https://歌词.lrc"</span></span><br><span class="line"><span class="code">        &#125;,</span></span><br><span class="line"><span class="code">        &#123;</span></span><br><span class="line"><span class="code">            "title": "歌曲名",</span></span><br><span class="line"><span class="code">            "author": "歌手名",</span></span><br><span class="line"><span class="code">            "url": "https://什么什么什么.mp3",</span></span><br><span class="line"><span class="code">            "pic": "https://封面图.jpg",</span></span><br><span class="line"><span class="code">            "lrc": "https://歌词.lrc"</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    ]</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;% endaplayerlist %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>详细参数见 <a href="https://github.com/MoePlayer/hexo-tag-aplayer" target="_blank" rel="noopener">README</a> 和这插件的“母亲” Aplayer 的<a href="https://aplayer.js.org/" target="_blank" rel="noopener">官方文档</a>。</p><p>关于 <a href="https://baike.baidu.com/item/lrc/46935" target="_blank" rel="noopener">lrc</a> 歌词，可以参考知乎的这篇文章https://www.zhihu.com/question/27638171下载网易云音乐的歌词，如果那歌词有错误（比如字母大小写和标点符号乱加）或者时间完全对不上，你可以一句一句自己查看修改……</p></blockquote><h4 id="2-视频面板-v2"><a class="header-anchor" href="#2-视频面板-v2">¶</a>(2) 视频面板</h4><p><a href="https://github.com/MoePlayer/hexo-tag-dplayer" target="_blank" rel="noopener">hexo-tag-dplayer</a>插件功能相比于原生html视频标签会更加强大，比如可以使用弹幕，非常建议食用。</p><p><strong>安装插件</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-tag-dplayer --save</span><br></pre></td></tr></table></figure><p>通过模板语法在markdown文章里引入，写法如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% dplayer "url=https://什么什么什么.mp4" "pic=https://封面图.jpg" "api=https://api.prprpr.me/dplayer/" "id=" "loop=false" %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果要使用弹幕，必须有 <code>api</code>和 <code>id</code>两项，并且若使用的是官方的 api 地址（即上面的），id 的值不能与<a href="https://api.prprpr.me/dplayer/list" target="_blank" rel="noopener">这个列表</a>的值一样。id 的值自己随便取，但建议使用视频的哈希值，可参考http://tool.oschina.net/encrypt?type=2。</p><p>目前发现官方api不能使用，可以寻求其他免费的弹幕服务器。也可自行搭建，可参考:</p><p>📚	<a href="https://alone88.cn/archives/484.html" target="_blank" rel="noopener">https://alone88.cn/archives/484.html</a></p><p>📚	<a href="https://dandoc.u2sb.top/" target="_blank" rel="noopener">https://dandoc.u2sb.top/</a></p><p>关于这个插件的更多内容可以去 <a href="https://github.com/MoePlayer/hexo-tag-dplayer" target="_blank" rel="noopener">README</a> 和这插件的“母亲” Dplayer 的<a href="https://dplayer.js.org/" target="_blank" rel="noopener">官方文档</a>看看。</p></blockquote><h3 id="3-音乐面板综合案例"><a class="header-anchor" href="#3-音乐面板综合案例">¶</a>3) 音乐面板综合案例</h3><p>新建一个hexo markdown文章文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo n music</span><br></pre></td></tr></table></figure><p>在新建的<code>music.md</code>文件里加入如下内容：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 关于我</span><br><span class="line">date: 2018-10-05 22:32:49</span><br><span class="line">comments: true</span><br><span class="line">---</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- more --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="code">	.description &#123;</span></span><br><span class="line"><span class="code">		margin: 0 auto;</span></span><br><span class="line"><span class="code">		text-align: center;</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	.logoimg&#123;</span></span><br><span class="line"><span class="code">		display: block;</span></span><br><span class="line"><span class="code">		margin: 0 auto;</span></span><br><span class="line"><span class="code">		padding: 2px;</span></span><br><span class="line"><span class="code">		max-width: 96px;</span></span><br><span class="line"><span class="code">		height: auto;</span></span><br><span class="line"><span class="code">		border: 2px solid #333;</span></span><br><span class="line"><span class="code">		border-radius: 50%;</span></span><br><span class="line"><span class="code">		transition: 2s all;</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	.logoimg:hover&#123;</span></span><br><span class="line"><span class="code">		transform: rotate(360deg);</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	.aboutbox &#123;</span></span><br><span class="line"><span class="code">		width: 90%;</span></span><br><span class="line"><span class="code">		height: 90%;</span></span><br><span class="line"><span class="code">		margin: 0 auto;</span></span><br><span class="line"><span class="code">		margin-top: 30px;</span></span><br><span class="line"><span class="code">		box-shadow: 0 0 10px 0 rgba(0,0,0,.5);</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	.musicbox &#123;</span></span><br><span class="line"><span class="code">		width: 90%;</span></span><br><span class="line"><span class="code">		margin: 60px auto;</span></span><br><span class="line"><span class="code">		padding: 10px;</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	.days&#123;</span></span><br><span class="line"><span class="code">		margin: 0 auto;</span></span><br><span class="line"><span class="code">		text-align: center;</span></span><br><span class="line"><span class="code">		font-weight: bold;</span></span><br><span class="line"><span class="code">		margin-top: 30px;</span></span><br><span class="line"><span class="code">		margin-bottom: 35px;</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"aboutbox"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"description"</span>&gt;</span></span></span><br><span class="line"><span class="code">	&lt;br/&gt;</span></span><br><span class="line"><span class="code">	&lt;a href="/"&gt;&lt;img class="logoimg nofancybox" itemprop="image" src="/images/logo.jpg"&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="code">	&lt;br /&gt;</span></span><br><span class="line"><span class="code">	本站于2018年9月22日创建，站点主要用于个人学习以及生活记录。</span></span><br><span class="line"><span class="code">	&lt;br /&gt;</span></span><br><span class="line"><span class="code">	博主：qcmoke</span></span><br><span class="line"><span class="code">	&lt;br /&gt;</span></span><br><span class="line"><span class="code">	联系方式：qcmoke@gmail.com</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"musicbox"</span>&gt;</span></span></span><br><span class="line"><span class="code">	&#123;% aplayerlist %&#125;</span></span><br><span class="line"><span class="code">	&#123;</span></span><br><span class="line"><span class="code">		"autoplay": false,</span></span><br><span class="line"><span class="code">		"showlrc": 3,</span></span><br><span class="line"><span class="code">		"mutex": true,</span></span><br><span class="line"><span class="code">		"music": [</span></span><br><span class="line"><span class="code">			&#123;</span></span><br><span class="line"><span class="code">				"title": "王牌冤家",</span></span><br><span class="line"><span class="code">				"author": "李荣浩",</span></span><br><span class="line"><span class="code">				"url": "https://source.qcmoke.cn/music/wangpaiyuanjia.mp3",</span></span><br><span class="line"><span class="code">				"pic": "https://source.qcmoke.cn/music/wangpaiyuanjia.jpg",</span></span><br><span class="line"><span class="code">				"lrc": "https://source.qcmoke.cn/music/wangpaiyuanjia.lrc"</span></span><br><span class="line"><span class="code">			&#125;,</span></span><br><span class="line"><span class="code">			&#123;</span></span><br><span class="line"><span class="code">				"title": "if you",</span></span><br><span class="line"><span class="code">				"author": "Bigbang",</span></span><br><span class="line"><span class="code">				"url": "https://source.qcmoke.cn/music/ifyou.mp3",</span></span><br><span class="line"><span class="code">				"pic": "https://source.qcmoke.cn/music/ifyou.jpg",</span></span><br><span class="line"><span class="code">				"lrc": "https://source.qcmoke.cn/music/ifyou.lrc"</span></span><br><span class="line"><span class="code">			&#125;,</span></span><br><span class="line"><span class="code">			&#123;</span></span><br><span class="line"><span class="code">				"title": "后会无期",</span></span><br><span class="line"><span class="code">				"author": "G.E.M. 邓紫棋",</span></span><br><span class="line"><span class="code">				"url": "https://source.qcmoke.cn/music/houhuiwuqi.mp3",</span></span><br><span class="line"><span class="code">				"pic": "https://source.qcmoke.cn/music/houhuiwuqi.jpg",</span></span><br><span class="line"><span class="code">				"lrc": "https://source.qcmoke.cn/music/houhuiwuqi.lrc"</span></span><br><span class="line"><span class="code">			&#125;,</span></span><br><span class="line"><span class="code">			&#123;</span></span><br><span class="line"><span class="code">				"title": "空空如也",</span></span><br><span class="line"><span class="code">				"author": "任然",</span></span><br><span class="line"><span class="code">				"url": "https://source.qcmoke.cn/music/kongkongruye.mp3",</span></span><br><span class="line"><span class="code">				"pic": "https://source.qcmoke.cn/music/kongkongruye.jpg",</span></span><br><span class="line"><span class="code">				"lrc": "https://source.qcmoke.cn/music/kongkongruye.lrc"</span></span><br><span class="line"><span class="code">			&#125;,</span></span><br><span class="line"><span class="code">			&#123;</span></span><br><span class="line"><span class="code">				"title": "日落大道",</span></span><br><span class="line"><span class="code">				"author": "梁博",</span></span><br><span class="line"><span class="code">				"url": "https://source.qcmoke.cn/music/riluodadao.mp3",</span></span><br><span class="line"><span class="code">				"pic": "https://source.qcmoke.cn/music/riluodadao.jpg",</span></span><br><span class="line"><span class="code">				"lrc": "https://source.qcmoke.cn/music/riluodadao.lrc"</span></span><br><span class="line"><span class="code">			&#125;,</span></span><br><span class="line"><span class="code">			&#123;</span></span><br><span class="line"><span class="code">				"title": "红昭愿",</span></span><br><span class="line"><span class="code">				"author": "音阙诗听",</span></span><br><span class="line"><span class="code">				"url": "https://source.qcmoke.cn/music/hongzhaoyuan.mp3",</span></span><br><span class="line"><span class="code">				"pic": "https://source.qcmoke.cn/music/hongzhaoyuan.jpg",</span></span><br><span class="line"><span class="code">				"lrc": "https://source.qcmoke.cn/music/hongzhaoyuan.lrc"</span></span><br><span class="line"><span class="code">			&#125;,</span></span><br><span class="line"><span class="code">			&#123;</span></span><br><span class="line"><span class="code">				"title": "笔记",</span></span><br><span class="line"><span class="code">				"author": "周笔畅",</span></span><br><span class="line"><span class="code">				"url": "https://source.qcmoke.cn/music/biji.mp3",</span></span><br><span class="line"><span class="code">				"pic": "https://source.qcmoke.cn/music/biji.jpg",</span></span><br><span class="line"><span class="code">				"lrc": "https://source.qcmoke.cn/music/biji.lrc"</span></span><br><span class="line"><span class="code">			&#125;</span></span><br><span class="line"><span class="code">		]</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	&#123;% endaplayerlist %&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//rf.revolvermaps.com/0/0/8.js?i=5xixmgxe8az<span class="symbol">&amp;amp;</span>m=0<span class="symbol">&amp;amp;</span>c=ff0000<span class="symbol">&amp;amp;</span>cr1=ffffff<span class="symbol">&amp;amp;</span>f=arial<span class="symbol">&amp;amp;</span>l=33"</span> <span class="attr">async</span>=<span class="string">"async"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"days"</span> <span class="attr">class</span>=<span class="string">"days"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="code">	function show_date_time()&#123;</span></span><br><span class="line"><span class="code">		window.setTimeout("show_date_time()", 1000);</span></span><br><span class="line"><span class="code">		BirthDay=new Date("09/22/2018 15:13:14");</span></span><br><span class="line"><span class="code">		today=new Date();</span></span><br><span class="line"><span class="code">		timeold=(today.getTime()-BirthDay.getTime());</span></span><br><span class="line"><span class="code">		sectimeold=timeold/1000</span></span><br><span class="line"><span class="code">		secondsold=Math.floor(sectimeold);</span></span><br><span class="line"><span class="code">		msPerDay=24*60*60*1000</span></span><br><span class="line"><span class="code">		e_daysold=timeold/msPerDay</span></span><br><span class="line"><span class="code">		daysold=Math.floor(e_daysold);</span></span><br><span class="line"><span class="code">		e_hrsold=(e_daysold-daysold)*24;</span></span><br><span class="line"><span class="code">		hrsold=setzero(Math.floor(e_hrsold));</span></span><br><span class="line"><span class="code">		e_minsold=(e_hrsold-hrsold)*60;</span></span><br><span class="line"><span class="code">		minsold=setzero(Math.floor((e_hrsold-hrsold)*60));</span></span><br><span class="line"><span class="code">		seconds=setzero(Math.floor((e_minsold-minsold)*60));</span></span><br><span class="line"><span class="code">		document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	function setzero(i)&#123;</span></span><br><span class="line"><span class="code">		if (i&lt;10)</span></span><br><span class="line"><span class="code">			&#123;i="0" + i&#125;;</span></span><br><span class="line"><span class="code">			return i;</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	show_date_time();</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>效果</strong></p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200302224536365.png" alt="image-20200302224536365"></p><h3 id="4-视频面板综合案例"><a class="header-anchor" href="#4-视频面板综合案例">¶</a>4) 视频面板综合案例</h3><p>新建一个hexo markdown文章文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo n video</span><br></pre></td></tr></table></figure><p>在新建的video.md文件里加入如下内容：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 我的视频页面</span><br><span class="line">date: 2020-03-02 22:21:39</span><br><span class="line">---</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- more --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">video</span> <span class="attr">poster</span>=<span class="string">"http://localhost:4000/images/logo.jpg"</span> <span class="attr">src</span>=<span class="string">"https://source.qcmoke.cn/video/VID_20190503_143115.mp4"</span> <span class="attr">style</span>=<span class="string">"max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;"</span> <span class="attr">controls</span>=<span class="string">"controls"</span> <span class="attr">loop</span>=<span class="string">"loop"</span> <span class="attr">preload</span>=<span class="string">"meta"</span>&gt;</span></span>Your browser does not support the video tag.<span class="xml"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% dplayer "url=https://source.qcmoke.cn/video/VID<span class="emphasis">_20190503_</span>143115.mp4" "http://localhost:4000/images/logo.jpg" "api=https://api.prprpr.me/dplayer/" "id=" "loop=false" %&#125;</span><br></pre></td></tr></table></figure><p>效果：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200302233729240.png" alt="image-20200302233729240"></p><h2 id="34-添加看板娘"><a class="header-anchor" href="#34-添加看板娘">¶</a>34) 添加看板娘</h2><p>目的是给博客页面添加小萌宠，给博客添加一点趣味性，下面就介绍使用live2d插件来实现这个功能。</p><p>（1）下载并安装插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure><p>（2）下载并安装萌宠模型</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install 模型名称</span><br></pre></td></tr></table></figure><p>官方提供了以下模型名称：</p><blockquote><ul><li><code>live2d-widget-model-chitose</code></li><li><code>live2d-widget-model-epsilon2_1</code></li><li><code>live2d-widget-model-gf</code></li><li><code>live2d-widget-model-haru/01</code> (use <code>npm install --save live2d-widget-model-haru</code>)</li><li><code>live2d-widget-model-haru/02</code> (use <code>npm install --save live2d-widget-model-haru</code>)</li><li><code>live2d-widget-model-haruto</code></li><li><code>live2d-widget-model-hibiki</code></li><li><code>live2d-widget-model-hijiki</code></li><li><code>live2d-widget-model-izumi</code></li><li><code>live2d-widget-model-koharu</code></li><li><code>live2d-widget-model-miku</code></li><li><code>live2d-widget-model-ni-j</code></li><li><code>live2d-widget-model-nico</code></li><li><code>live2d-widget-model-nietzsche</code></li><li><code>live2d-widget-model-nipsilon</code></li><li><code>live2d-widget-model-nito</code></li><li><code>live2d-widget-model-shizuku</code></li><li><code>live2d-widget-model-tororo</code></li><li><code>live2d-widget-model-tsumiki</code></li><li><code>live2d-widget-model-unitychan</code></li><li><code>live2d-widget-model-wanko</code></li><li><code>live2d-widget-model-z16</code></li></ul></blockquote><p>你可以查看<a href="https://huaji8.top/post/live2d-plugin-2.0/" target="_blank" rel="noopener">demo演示</a>后再决定做选择。</p><p>（3）编辑Hexo主配置文件 <code>myblog/_config.yml</code>,添加如下配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Live2D</span></span><br><span class="line"><span class="comment">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class="line"><span class="attr">live2d:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># enable: false</span></span><br><span class="line">    <span class="attr">scriptFrom:</span> <span class="string">local</span> <span class="comment"># 默认</span></span><br><span class="line">    <span class="attr">pluginRootPath:</span> <span class="string">live2dw/</span> <span class="comment"># 插件在站点上的根目录(相对路径)</span></span><br><span class="line">    <span class="attr">pluginJsPath:</span> <span class="string">lib/</span> <span class="comment"># 脚本文件相对与插件根目录路径</span></span><br><span class="line">    <span class="attr">pluginModelPath:</span> <span class="string">assets/</span> <span class="comment"># 模型文件相对与插件根目录路径</span></span><br><span class="line">  <span class="comment"># scriptFrom: jsdelivr # jsdelivr CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: unpkg # unpkg CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # 你的自定义 url</span></span><br><span class="line">    <span class="attr">tagMode:</span> <span class="literal">false</span> <span class="comment"># 标签模式, 是否仅替换 live2d tag标签而非插入到所有页面中</span></span><br><span class="line">    <span class="attr">debug:</span> <span class="literal">false</span> <span class="comment"># 调试, 是否在控制台输出日志</span></span><br><span class="line">    <span class="attr">model:</span></span><br><span class="line">      <span class="attr">use:</span> <span class="string">live2d-widget-model-haruto</span> <span class="comment"># npm-module package name</span></span><br><span class="line">    <span class="comment"># use: wanko # 博客根目录/live2d_models/ 下的目录名</span></span><br><span class="line">    <span class="comment"># use: ./wives/wanko # 相对于博客根目录的路径</span></span><br><span class="line">    <span class="comment"># use: https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json # 你的自定义 url</span></span><br><span class="line">    <span class="attr">display:</span> <span class="comment"># 模型位置，根据不同的模型自行调整</span></span><br><span class="line">      <span class="attr">position:</span> <span class="string">left</span></span><br><span class="line">      <span class="attr">width:</span> <span class="number">100</span></span><br><span class="line">      <span class="attr">height:</span> <span class="number">150</span></span><br><span class="line">    <span class="attr">mobile:</span> <span class="comment"># 是否适用于移动端</span></span><br><span class="line">      <span class="attr">show:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h1 id="第三方服务篇"><a class="header-anchor" href="#第三方服务篇">¶</a>第三方服务篇</h1><h2 id="1-添加评分功能"><a class="header-anchor" href="#1-添加评分功能">¶</a>1. 添加评分功能</h2><p>淘宝买东西，作为消费者的我们，看评价很重要。现在作为博主，写了一篇文章，很期待读者的反馈。而与淘宝一样，确认收货后，相比评论，更愿意五星好评。那么博客文章怎么加上呢？首先打开<strong>主题</strong>配置文件：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Star rating support to each article.</span></span><br><span class="line"><span class="comment"># To get your ID visit https://widgetpack.com</span></span><br><span class="line"><span class="attr">rating:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">id:</span> <span class="number">23</span><span class="string">****</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">fc6423</span></span><br></pre></td></tr></table></figure><p>先去https://widgetpack.com注册个帐号，填一下自己博客的信息，把左上角的 ID值，填进上面的 <code>rating.id</code>中，<code>color</code>改成自己喜欢的即可。</p><blockquote><p>💁‍♂说明：</p><ol><li>可以配置评分方式，侧栏 &gt; Rating &gt; Setting，建议用 IP address 或 Device(cookie)，免登录，毕竟 Socials 里面的选项几乎都被墙，不适合国内网络环境。</li><li>建议在侧栏 &gt; Site &gt; Setting 中勾选 Private 选项。</li><li>上面两步勾选后别忘了点击页面右下方的 <em>SAVE SETTING</em> 绿色按钮保存。</li></ol></blockquote><p>如果你想给评分的星星周围加内容，可以修改文件：<code>themes/next/layout/_macro/post.swig</code>，例如添加下面 <code>+</code>相关的内容：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.rating.enable %&#125;</span><br><span class="line">	&lt;div class="wp_rating"&gt;</span><br><span class="line"><span class="addition">+            &lt;div style="color: rgba(0, 0, 0, 0.75); font-size:13px; letter-spacing:3px"&gt;(&gt;看完记得五星好评哦亲&lt;)&lt;/div&gt;</span></span><br><span class="line">			&lt;div id="wpac-rating"&gt;&lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h2 id="2-网站访问统计"><a class="header-anchor" href="#2-网站访问统计">¶</a>2. 网站访问统计</h2><p>next主题默认集成了一些第三方访问统计插件。其中推荐使用不蒜子统计服务或者leancloud统计服务。选择一种就行。</p><blockquote><p>💁‍♂ 对比：</p><p>不蒜子统计：支持“本站访客数”、“本站总访问量”和“本文总阅读量”；暂不开放注册，没有用户 后台，不支持数据维护。</p><p>leancloud统计：只支持“本文总阅读量”统计；有用户后台，支持数据维护。</p></blockquote><p>由于以上可看出各自的长短，所以酌情选择。如果不关心数据维护的话，我个人比较推荐使用不蒜子统计，因为简单易用。</p><h3 id="1-不蒜子统计"><a class="header-anchor" href="#1-不蒜子统计">¶</a>1) 不蒜子统计</h3><p>官网：<a href="http://busuanzi.ibruce.info" target="_blank" rel="noopener">http://busuanzi.ibruce.info</a></p><p>只需要打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，搜索关键字 <code>busuanzi_count</code>。 将 <code>enable</code>的值改为 <code>true</code>,并对站点UV配置、站点PV配置、单页面PV进行配置。如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="comment"># count values only if the other configs are false</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># custom uv span for the whole site</span></span><br><span class="line">  <span class="comment"># 效果：本站访客数12345人次</span></span><br><span class="line">  <span class="attr">site_uv:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">site_uv_header:</span> <span class="string">本站访客数</span></span><br><span class="line">  <span class="attr">site_uv_footer:</span> <span class="string">人次</span></span><br><span class="line">  <span class="comment"># custom pv span for the whole site</span></span><br><span class="line">  <span class="comment"># 效果：本站总访问量12345次</span></span><br><span class="line">  <span class="attr">site_pv:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">site_pv_header:</span> <span class="string">本站总访问量</span></span><br><span class="line">  <span class="attr">site_pv_footer:</span> <span class="string">次</span></span><br><span class="line">  <span class="comment"># custom pv span for one page only</span></span><br><span class="line">  <span class="comment"># 效果：本文总阅读量12345次</span></span><br><span class="line">  <span class="attr">page_pv:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">page_pv_header:</span> <span class="string">本文总阅读量</span></span><br><span class="line">  <span class="attr">page_pv_footer:</span> <span class="string">次</span></span><br></pre></td></tr></table></figure><p>完成后重新编译并运行，你会发现每篇博客文章和网页底部已经出现了访问统计信息了。</p><p>💁‍♂ 温馨提示：</p><p>目前不蒜子『<a href="http://dn-lbstatics.qbox.me" target="_blank" rel="noopener">dn-lbstatics.qbox.me</a>』域名过期，更换域名到『<a href="http://busuanzi.ibruce.info" target="_blank" rel="noopener">busuanzi.ibruce.info</a>』！故你可能需要修改以下文件相关信息：</p><p>编辑 <code>myblog/themes/next/layout/_third-party/analytics/busuanzi-counter.swig</code>，找到以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>修改为:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><em>如果不蒜子又拿回原来的域名，那么再改回原来的域名吧~~~</em></p><h3 id="2-leancloud统计"><a class="header-anchor" href="#2-leancloud统计">¶</a>2) leancloud统计</h3><p>（1）登录leancloud官网注册账户。</p><blockquote><p>💁‍♂说明：</p><p>现在leancloud官方的云服务系统是国内和国际分别运营，所以官方网址也分为国内网址和国际网址，个人建议国际的。</p><ul><li>国内网址：<a href="https://leancloud.cn" target="_blank" rel="noopener">https://leancloud.cn</a></li><li>国际网址：<a href="https://leancloud.app" target="_blank" rel="noopener">https://leancloud.app</a></li></ul></blockquote><p>（2）登录leancloud后台，然后创建应用</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/5d0c995c86fac81746.jpg" alt="img"></p><p>（3）创建应用完成后就得到了 <code>appid</code>和 <code>appkey</code>:</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200306103635845.png" alt="image-20200306103635845"></p><p>（4）然后设置安全域名</p><p>将你网站首页的域名请求地址填进去即可，可以防止其他人攻击。</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20230619165215201.png" alt="image-20230619165215201"></p><blockquote><p>如果你是一个开发爱好者，可以将本地localhost（包括端口号）添加进去，开发完成后再删除即可</p></blockquote><p>（5）创建一个名称为Counter的Class，用于数据存储。</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200307024608388.png" alt="image-20200307024608388"></p><p>（6）绑定自定义域名作为api访问入口。</p><p>2022 年 8 月起，国际版共享域名不再向中国大陆提供服务，见：<a href="https://forum.leancloud.cn/t/2022-8/25408%E3%80%82%E6%95%85%E5%A6%82%E6%9E%9C%E4%B8%8D%E7%BB%91%E5%AE%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E5%88%99%E6%97%A0%E6%B3%95%E9%80%9A%E8%BF%87%E5%9B%BD%E5%86%85%E7%BD%91%E7%BB%9C%E6%AD%A3%E8%AE%BF%E9%97%AE%EF%BC%88%E4%B8%BB%E8%A6%81%E6%98%AF%E4%BC%9A%E6%8A%A5%E2%80%9C%E8%B7%A8%E5%9F%9F%E2%80%9D%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%EF%BC%89%EF%BC%8C%E8%8B%A5%E6%83%B3%E8%A6%81%E7%BB%A7%E7%BB%AD%E6%AD%A3%E5%B8%B8%E4%BD%BF%E7%94%A8%E8%A6%81%E4%B9%88%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E6%88%96%E8%80%85%E6%94%B9%E4%B8%BA%E5%9B%BD%E5%86%85%E7%89%88%EF%BC%8C%E5%8F%88%E6%88%96%E8%80%85%E5%9C%A8%E5%9B%BD%E9%99%85%E7%89%88%E4%B8%8A%E7%BB%91%E5%AE%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E3%80%82%E5%85%B6%E4%B8%AD%E5%9C%A8%E5%9B%BD%E9%99%85%E7%89%88%E4%B8%8A%E7%BB%91%E5%AE%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E6%93%8D%E4%BD%9C%E5%A6%82%E4%B8%8B%EF%BC%9A" target="_blank" rel="noopener">https://forum.leancloud.cn/t/2022-8/25408。故如果不绑定自定义域名则无法通过国内网络正访问（主要是会报“跨域”错误信息），若想要继续正常使用要么科学上网或者改为国内版，又或者在国际版上绑定自定义域名。其中在国际版上绑定自定义域名操作如下：</a></p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20230619165407595.png" alt="image-20230619165407595"></p><p>（7）编辑 <code>myblog/themes/next/_config.yml</code>主题配置文件，添加将leancloud后台得到的 <code>appid</code>和 <code>appkey</code>填入配置中。如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show number of visitors to each article.</span></span><br><span class="line"><span class="comment"># You can visit https://leancloud.cn / https://leancloud.app get AppID and AppKey.</span></span><br><span class="line"><span class="attr">leancloud_visitors:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">app_id:</span> <span class="string">6LNbUE*********XbMMI</span></span><br><span class="line">  <span class="attr">app_key:</span> <span class="string">d2FLy*********uDWx</span></span><br><span class="line">  <span class="attr">server_api:</span> <span class="string">https://leancloud.qcmoke.cn</span></span><br></pre></td></tr></table></figure><blockquote><p>👀 注意：</p><p>enable 要设置为 true 表示开启这个功能。</p></blockquote><p>（8）如果和我一样使用的next版本是5.1.4，并且使用的leancloud是国际版（leancloud是国内版的可以跳过），就还要做兼容处理，因为国际版leancloud是后来才有的，以致于旧版的next不兼容。</p><p>修改 <code>themes/next/layout/_third-party/analytics/lean-analytics.swig</code>,将其内容替换成下面：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--切换国际版leancloud替换代码--&gt;</span></span><br><span class="line">&#123;% if theme.leancloud_visitors.enable and !theme.valine.visitor %&#125;</span><br><span class="line">  &#123;# custom analytics part create by xiamo; edited by LEAFERx #&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    &#123;% <span class="keyword">if</span> page.layout === <span class="string">'post'</span> %&#125;</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">addCount</span><span class="params">(Counter)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> $visitors = $(<span class="string">'.leancloud_visitors'</span>);</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> url = $visitors.attr(<span class="string">'id'</span>).trim();</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> title = $visitors.attr(<span class="string">'data-flag-title'</span>).trim();</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      Counter(<span class="string">'get'</span>, <span class="string">'/classes/Counter'</span>, &#123; <span class="attr">where</span>: <span class="built_in">JSON</span>.stringify(&#123; url &#125;) &#125;)</span></span><br><span class="line"><span class="actionscript">        .done(<span class="function"><span class="keyword">function</span><span class="params">(&#123; results &#125;)</span> </span>&#123;</span></span><br><span class="line">          if (results.length &gt; 0) &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> counter = results[<span class="number">0</span>];</span></span><br><span class="line">            &#123;% if theme.leancloud_visitors.betterPerformance %&#125;</span><br><span class="line"><span class="javascript">              <span class="keyword">var</span> $element = $(<span class="built_in">document</span>.getElementById(url));</span></span><br><span class="line"><span class="actionscript">              $element.find(<span class="string">'.leancloud-visitors-count'</span>).text(counter.time + <span class="number">1</span>);</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line"><span class="javascript">            Counter(<span class="string">'put'</span>, <span class="string">'/classes/Counter/'</span> + counter.objectId, <span class="built_in">JSON</span>.stringify(&#123; <span class="attr">time</span>: &#123; <span class="string">'__op'</span>: <span class="string">'Increment'</span>, <span class="string">'amount'</span>: <span class="number">1</span> &#125; &#125;))</span></span><br><span class="line">            &#123;% if not theme.leancloud_visitors.betterPerformance %&#125;</span><br><span class="line"><span class="actionscript">              .done(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> $element = $(<span class="built_in">document</span>.getElementById(url));</span></span><br><span class="line"><span class="actionscript">                $element.find(<span class="string">'.leancloud-visitors-count'</span>).text(counter.time + <span class="number">1</span>);</span></span><br><span class="line">              &#125;)</span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line"><span class="actionscript">              .fail(<span class="function"><span class="keyword">function</span> <span class="params">(&#123; responseJSON &#125;)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'Failed to save Visitor num, with error message: '</span> + responseJSON.error);</span></span><br><span class="line">              &#125;)</span><br><span class="line"><span class="actionscript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line">            &#123;% if theme.leancloud_visitors.security %&#125;</span><br><span class="line"><span class="javascript">              <span class="keyword">var</span> $element = $(<span class="built_in">document</span>.getElementById(url));</span></span><br><span class="line"><span class="actionscript">              $element.find(<span class="string">'.leancloud-visitors-count'</span>).text(<span class="string">'Counter not initialized! More info at console err msg.'</span>);</span></span><br><span class="line"><span class="javascript">              <span class="built_in">console</span>.error(<span class="string">'ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.'</span>);</span></span><br><span class="line"><span class="actionscript">            &#123;% <span class="keyword">else</span> %&#125;</span></span><br><span class="line"><span class="javascript">              Counter(<span class="string">'post'</span>, <span class="string">'/classes/Counter'</span>, <span class="built_in">JSON</span>.stringify(&#123; <span class="attr">title</span>: title, <span class="attr">url</span>: url, <span class="attr">time</span>: <span class="number">1</span> &#125;))</span></span><br><span class="line"><span class="actionscript">                .done(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                  <span class="keyword">var</span> $element = $(<span class="built_in">document</span>.getElementById(url));</span></span><br><span class="line"><span class="actionscript">                  $element.find(<span class="string">'.leancloud-visitors-count'</span>).text(<span class="number">1</span>);</span></span><br><span class="line">                &#125;)</span><br><span class="line"><span class="actionscript">                .fail(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                  <span class="built_in">console</span>.log(<span class="string">'Failed to create'</span>);</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="actionscript">        .fail(<span class="function"><span class="keyword">function</span> <span class="params">(&#123; responseJSON &#125;)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'LeanCloud Counter Error: '</span> + responseJSON.code + <span class="string">' '</span> + responseJSON.error);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    &#123;% <span class="keyword">else</span> %&#125;</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">showTime</span><span class="params">(Counter)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> entries = [];</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> $visitors = $(<span class="string">'.leancloud_visitors'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">      $visitors.each(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        entries.push( $(<span class="keyword">this</span>).attr(<span class="string">'id'</span>).trim() );</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">      Counter(<span class="string">'get'</span>, <span class="string">'/classes/Counter'</span>, &#123; <span class="attr">where</span>: <span class="built_in">JSON</span>.stringify(&#123; <span class="attr">url</span>: &#123; <span class="string">'$in'</span>: entries &#125; &#125;) &#125;)</span></span><br><span class="line"><span class="actionscript">        .done(<span class="function"><span class="keyword">function</span><span class="params">(&#123; results &#125;)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> COUNT_CONTAINER_REF = <span class="string">'.leancloud-visitors-count'</span>;</span></span><br><span class="line"></span><br><span class="line">          if (results.length === 0) &#123;</span><br><span class="line">            $visitors.find(COUNT_CONTAINER_REF).text(0);</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span>;</span></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; results.length; i++) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> item = results[i];</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> url = item.url;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> time = item.time;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(url);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">            $(element).find(COUNT_CONTAINER_REF).text(time);</span></span><br><span class="line">          &#125;</span><br><span class="line"><span class="actionscript">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; entries.length; i++) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> url = entries[i];</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(url);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> countSpan = $(element).find(COUNT_CONTAINER_REF);</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (countSpan.text() == <span class="string">''</span>) &#123;</span></span><br><span class="line">              countSpan.text(0);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="actionscript">        .fail(<span class="function"><span class="keyword">function</span> <span class="params">(&#123; responseJSON &#125;)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'LeanCloud Counter Error: '</span> + responseJSON.code + <span class="string">' '</span> + responseJSON.error);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      $.<span class="keyword">get</span>('https://app-router.leancloud.cn/2/route?appId=' + '&#123;&#123; theme.leancloud_visitors.app_id &#125;&#125;<span class="string">')</span></span></span><br><span class="line"><span class="actionscript">        .done(<span class="function"><span class="keyword">function</span><span class="params">(&#123; api_server &#125;)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> Counter = <span class="function"><span class="keyword">function</span><span class="params">(method, url, data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> $.ajax(&#123;</span></span><br><span class="line">              method: method,</span><br><span class="line"><span class="actionscript">              <span class="comment">//url: 'https://' + api_server + '/1.1' + url,</span></span></span><br><span class="line"><span class="actionscript">              url: (<span class="string">'&#123;&#123; theme.leancloud_visitors.server_api &#125;&#125;'</span> || api_server) + <span class="string">'/1.1'</span> + url,</span></span><br><span class="line">              headers: &#123;</span><br><span class="line"><span class="actionscript">                <span class="string">'X-LC-Id'</span>: <span class="string">'&#123;&#123; theme.leancloud_visitors.app_id &#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">                <span class="string">'X-LC-Key'</span>: <span class="string">'&#123;&#123; theme.leancloud_visitors.app_key &#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">                <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>,</span></span><br><span class="line">              &#125;,</span><br><span class="line">              data: data</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;;</span><br><span class="line"><span class="actionscript">          &#123;% <span class="keyword">if</span> page.layout === <span class="string">'post'</span> %&#125;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> localhost = <span class="regexp">/http:\/\/(localhost|127.0.0.1|0.0.0.0)/</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (localhost.test(<span class="built_in">document</span>.URL)) <span class="keyword">return</span>;<span class="comment">//本地调试时不进行统计</span></span></span><br><span class="line">            addCount(Counter);</span><br><span class="line"><span class="actionscript">          &#123;% <span class="keyword">else</span> %&#125;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> ($(<span class="string">'.post-title-link'</span>).length &gt;= <span class="number">1</span>) &#123;</span></span><br><span class="line">              showTime(Counter);</span><br><span class="line">            &#125;</span><br><span class="line">          &#123;% endif %&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--next原来的版本--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&#123;% if theme.leancloud_visitors.enable %&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  &#123;# custom analytics part create by xiamo #&#125;</span></span><br><span class="line"><span class="comment">  &lt;script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">  &lt;script&gt;AV.initialize("&#123;&#123;theme.leancloud_visitors.app_id&#125;&#125;", "&#123;&#123;theme.leancloud_visitors.app_key&#125;&#125;");&lt;/script&gt;</span></span><br><span class="line"><span class="comment">  &lt;script&gt;</span></span><br><span class="line"><span class="comment">    function showTime(Counter) &#123;</span></span><br><span class="line"><span class="comment">      var query = new AV.Query(Counter);</span></span><br><span class="line"><span class="comment">      var entries = [];</span></span><br><span class="line"><span class="comment">      var $visitors = $(".leancloud_visitors");</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      $visitors.each(function () &#123;</span></span><br><span class="line"><span class="comment">        entries.push( $(this).attr("id").trim() );</span></span><br><span class="line"><span class="comment">      &#125;);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      query.containedIn('url', entries);</span></span><br><span class="line"><span class="comment">      query.find()</span></span><br><span class="line"><span class="comment">        .done(function (results) &#123;</span></span><br><span class="line"><span class="comment">          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">          if (results.length === 0) &#123;</span></span><br><span class="line"><span class="comment">            $visitors.find(COUNT_CONTAINER_REF).text(0);</span></span><br><span class="line"><span class="comment">            return;</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">          for (var i = 0; i &lt; results.length; i++) &#123;</span></span><br><span class="line"><span class="comment">            var item = results[i];</span></span><br><span class="line"><span class="comment">            var url = item.get('url');</span></span><br><span class="line"><span class="comment">            var time = item.get('time');</span></span><br><span class="line"><span class="comment">            var element = document.getElementById(url);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            $(element).find(COUNT_CONTAINER_REF).text(time);</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">          for(var i = 0; i &lt; entries.length; i++) &#123;</span></span><br><span class="line"><span class="comment">            var url = entries[i];</span></span><br><span class="line"><span class="comment">            var element = document.getElementById(url);</span></span><br><span class="line"><span class="comment">            var countSpan = $(element).find(COUNT_CONTAINER_REF);</span></span><br><span class="line"><span class="comment">            if( countSpan.text() == '') &#123;</span></span><br><span class="line"><span class="comment">              countSpan.text(0);</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">        &#125;)</span></span><br><span class="line"><span class="comment">        .fail(function (object, error) &#123;</span></span><br><span class="line"><span class="comment">          console.log("Error: " + error.code + " " + error.message);</span></span><br><span class="line"><span class="comment">        &#125;);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    function addCount(Counter) &#123;</span></span><br><span class="line"><span class="comment">      var $visitors = $(".leancloud_visitors");</span></span><br><span class="line"><span class="comment">      var url = $visitors.attr('id').trim();</span></span><br><span class="line"><span class="comment">      var title = $visitors.attr('data-flag-title').trim();</span></span><br><span class="line"><span class="comment">      var query = new AV.Query(Counter);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      query.equalTo("url", url);</span></span><br><span class="line"><span class="comment">      query.find(&#123;</span></span><br><span class="line"><span class="comment">        success: function(results) &#123;</span></span><br><span class="line"><span class="comment">          if (results.length &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">            var counter = results[0];</span></span><br><span class="line"><span class="comment">            counter.fetchWhenSave(true);</span></span><br><span class="line"><span class="comment">            counter.increment("time");</span></span><br><span class="line"><span class="comment">            counter.save(null, &#123;</span></span><br><span class="line"><span class="comment">              success: function(counter) &#123;</span></span><br><span class="line"><span class="comment">                var $element = $(document.getElementById(url));</span></span><br><span class="line"><span class="comment">                $element.find('.leancloud-visitors-count').text(counter.get('time'));</span></span><br><span class="line"><span class="comment">              &#125;,</span></span><br><span class="line"><span class="comment">              error: function(counter, error) &#123;</span></span><br><span class="line"><span class="comment">                console.log('Failed to save Visitor num, with error message: ' + error.message);</span></span><br><span class="line"><span class="comment">              &#125;</span></span><br><span class="line"><span class="comment">            &#125;);</span></span><br><span class="line"><span class="comment">          &#125; else &#123;</span></span><br><span class="line"><span class="comment">            var newcounter = new Counter();</span></span><br><span class="line"><span class="comment">            /* Set ACL */</span></span><br><span class="line"><span class="comment">            var acl = new AV.ACL();</span></span><br><span class="line"><span class="comment">            acl.setPublicReadAccess(true);</span></span><br><span class="line"><span class="comment">            acl.setPublicWriteAccess(true);</span></span><br><span class="line"><span class="comment">            newcounter.setACL(acl);</span></span><br><span class="line"><span class="comment">            /* End Set ACL */</span></span><br><span class="line"><span class="comment">            newcounter.set("title", title);</span></span><br><span class="line"><span class="comment">            newcounter.set("url", url);</span></span><br><span class="line"><span class="comment">            newcounter.set("time", 1);</span></span><br><span class="line"><span class="comment">            newcounter.save(null, &#123;</span></span><br><span class="line"><span class="comment">              success: function(newcounter) &#123;</span></span><br><span class="line"><span class="comment">                var $element = $(document.getElementById(url));</span></span><br><span class="line"><span class="comment">                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));</span></span><br><span class="line"><span class="comment">              &#125;,</span></span><br><span class="line"><span class="comment">              error: function(newcounter, error) &#123;</span></span><br><span class="line"><span class="comment">                console.log('Failed to create');</span></span><br><span class="line"><span class="comment">              &#125;</span></span><br><span class="line"><span class="comment">            &#125;);</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">        &#125;,</span></span><br><span class="line"><span class="comment">        error: function(error) &#123;</span></span><br><span class="line"><span class="comment">          console.log('Error:' + error.code + " " + error.message);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">      &#125;);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    $(function() &#123;</span></span><br><span class="line"><span class="comment">      var Counter = AV.Object.extend("Counter");</span></span><br><span class="line"><span class="comment">      if ($('.leancloud_visitors').length == 1) &#123;</span></span><br><span class="line"><span class="comment">        addCount(Counter);</span></span><br><span class="line"><span class="comment">      &#125; else if ($('.post-title-link').length &gt; 1) &#123;</span></span><br><span class="line"><span class="comment">        showTime(Counter);</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment">    &#125;);</span></span><br><span class="line"><span class="comment">  &lt;/script&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;% endif %&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>🙉注意：本地调试时不进行统计。如果看懂上面源码可以让其在本地调试是能进行统计。但小白直接复制粘贴就好，发布部署时，通过域名访问就能统计了。</p></blockquote><p>为了让移动端显示更友好，我修改了 <code>themes/next/layout/_macro/post.swig</code>文件，加了一个span标签进行修饰，让小眼睛和访问数值始终在同一行。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">          &#123;# LeanCould PageView #&#125;</span><br><span class="line">          &#123;% if theme.leancloud_visitors.enable %&#125;</span><br><span class="line">             &lt;span id="&#123;&#123; url_for(post.path) &#125;&#125;" class="leancloud_visitors" data-flag-title="&#123;&#123; post.title &#125;&#125;"&gt;</span><br><span class="line">              &lt;span class="post-meta-divider"&gt;|&lt;/span&gt;</span><br><span class="line"><span class="addition">+             &lt;span class="lv-inline-block" style="display: inline-block;"&gt;</span></span><br><span class="line">                &lt;span class="post-meta-item-icon"&gt;</span><br><span class="line">                  &lt;i class="fa fa-eye"&gt;&lt;/i&gt;</span><br><span class="line">                &lt;/span&gt;</span><br><span class="line">                &#123;% if theme.post_meta.item_text %&#125;</span><br><span class="line">                  &lt;span class="post-meta-item-text"&gt;&#123;&#123;__('post.visitors')&#125;&#125;:&lt;/span&gt;</span><br><span class="line">                &#123;% endif %&#125;</span><br><span class="line">                  &lt;span class="leancloud-visitors-count"&gt;&lt;/span&gt;</span><br><span class="line"><span class="addition">+             &lt;/span&gt;</span></span><br><span class="line">             &lt;/span&gt;</span><br><span class="line">          &#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h3 id="3-额外补充"><a class="header-anchor" href="#3-额外补充">¶</a>3) 额外补充</h3><p>由于不蒜子统计和leancloud统计都存在着一些缺失的问题，但是它们之间又冥冥中有着互补的关系，所以我通过一波考虑后，选择了折中的方案，那就是使用不蒜子统计的“本站访客数”、“本站总访问量”，而使用leancloud统计的“本文总阅读量”统计。配置如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show PV/UV of the website/page with busuanzi.</span></span><br><span class="line"><span class="comment"># Get more information on http://ibruce.info/2015/04/04/busuanzi/</span></span><br><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="comment"># count values only if the other configs are false</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># custom uv span for the whole site</span></span><br><span class="line">  <span class="comment"># 效果：本站访客数12345人次</span></span><br><span class="line">  <span class="attr">site_uv:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">site_uv_header:</span> <span class="string">本站访客数</span></span><br><span class="line">  <span class="attr">site_uv_footer:</span> <span class="string">人次</span></span><br><span class="line">  <span class="comment"># custom pv span for the whole site</span></span><br><span class="line">  <span class="comment"># 效果：本站总访问量12345次</span></span><br><span class="line">  <span class="attr">site_pv:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">site_pv_header:</span> <span class="string">本站总访问量</span></span><br><span class="line">  <span class="attr">site_pv_footer:</span> <span class="string">次</span></span><br><span class="line">  <span class="comment"># custom pv span for one page only</span></span><br><span class="line">  <span class="comment"># 效果：本文总阅读量12345次</span></span><br><span class="line">  <span class="attr">page_pv:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">page_pv_header:</span> <span class="string">本文总阅读量</span></span><br><span class="line">  <span class="attr">page_pv_footer:</span> <span class="string">次</span></span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show number of visitors to each article.</span></span><br><span class="line"><span class="comment"># You can visit https://leancloud.cn / https://leancloud.app get AppID and AppKey.</span></span><br><span class="line"><span class="attr">leancloud_visitors:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">app_id:</span> <span class="string">6LNbUERxbG0OAnWfmJSbmXiW-MdYXbMMI</span></span><br><span class="line">  <span class="attr">app_key:</span> <span class="string">d2FLy9fmXOTiM8TrokuIuDWx</span></span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂如果你对这访问统计这一块很感兴趣并且懂点编程知识的话，你完全可以通过leancloud的sdk来开发出完整的统计功能。这样的话就可以不用不蒜子统计了。要是你还有一台可以长期使用的vps的话，你甚至可以不用leancloud的服务，而是自己实现一个访问计数的后端服务。这里我就不深入了。</p></blockquote><h2 id="3-加入评论面板"><a class="header-anchor" href="#3-加入评论面板">¶</a>3. 加入评论面板</h2><h3 id="1-gitalk"><a class="header-anchor" href="#1-gitalk">¶</a>1) Gitalk</h3><p>上网找过很多与hexo相关的评论面板，但发现很多第三方的评论面板提供的评论面板都有一个致命的弱点，那就是在不可预料的一天突然在国内被和谐了，或者出现各种各样的问题，这很让人头疼。后来在网上发现有人通过调用github提供的Issues api做成了比较美观的评论面板，这其中我发现了两种，第一种是<a href="https://github.com/imsun/gitment" target="_blank" rel="noopener">gitment</a>，第二种就是这里要讲的<a href="https://github.com/gitalk/gitalk" target="_blank" rel="noopener">gitalk</a>。之前也尝试过加入gitment，但是发现装好后出现了各种问题。最严重的问题就是无法通过登陆评论面板进行初始化文章的评论功能，所以也就放弃了这种途径。后来在<a href="https://t.me/theme_next" target="_blank" rel="noopener">next的Telegram群</a>里发现了gitalk这个干货，于是开始上网找各种教程尝试搭建，但在这过程中也还是发现了一些问题。所以在这里我将尽可能详细解释清楚，避免误导大家。</p><p>（1）首先你得先到github上申请一个 Github Application，由于需要调用 Github API ,首先<a href="https://github.com/settings/applications/new" target="_blank" rel="noopener">点击注册</a>一个 Github Application 。</p><p>申请页如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/4198945318.png" alt="1537368382709.png"></p><p>参数说明：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Application name：          #应用名称，随意填</span><br><span class="line">Homepage URL：              #应用地址，填你的博客地址，如https://youname.github.io </span><br><span class="line">Application description     #描述，随意填</span><br><span class="line">Authorization callback URL：#回调地址，填你的博客地址，如https://youname.github.io</span><br></pre></td></tr></table></figure><p>如果没有用自购的域名，<code>Homepage URL</code>和 <code>Authorization callback URL</code>统一填https://youname.github.io (youname是你的github用户名)。</p><p>填写完成后，点击register application。</p><p>创建成功后，会看到 <code>clientID: XXX</code>和 <code>clientSecret: XXX</code> 这两个参数，如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1150547369.png" alt="1537370272870.png"></p><p>（2）创建一个仓库用来存放issue数据，命名可以随意，但为了和我统一，最好也命名为 <code>gitalk</code>。</p><p>（3）添加gitalk.swig配置文件</p><p>在目录 <code>myblog/themes/next/layout/_third-party/comments</code>下创建一个 <code>gitalk.swig</code>文件。</p><p>将以下代码全部复制到 <code>gitalk.swig</code>中。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.gitalk.enable %&#125;</span><br><span class="line">  &#123;% if page.comments %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">const</span> gitalk = <span class="keyword">new</span> Gitalk(&#123;</span></span><br><span class="line"><span class="actionscript">        clientID: <span class="string">'&#123;&#123;theme.gitalk.clientID&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">        clientSecret: <span class="string">'&#123;&#123;theme.gitalk.clientSecret&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">        repo: <span class="string">'&#123;&#123;theme.gitalk.repo&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">        owner: <span class="string">'&#123;&#123;theme.gitalk.owner&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">        admin: <span class="string">'&#123;&#123;theme.gitalk.admin&#125;&#125;'</span>.split(<span class="string">','</span>),</span></span><br><span class="line">        id: location.pathname,</span><br><span class="line"><span class="actionscript">        <span class="comment">// facebook-like distraction free mode</span></span></span><br><span class="line"><span class="actionscript">        distractionFreeMode: <span class="string">'&#123;&#123; theme.gitalk.distractionFreeMode &#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">        createIssueManually: <span class="string">'&#123;&#123; theme.gitalk.createIssueManually &#125;&#125;'</span></span></span><br><span class="line">      &#125;)</span><br><span class="line"><span class="actionscript">      gitalk.render(<span class="string">'gitalk-container'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>（4）修改index.swig配置文件</p><p>在 <code>myblog/themes/next/layout/_third-party/comments</code>目录下的 <code>index.swig</code>文件最后加入以下代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include <span class="string">'gitalk.swig'</span> %&#125;</span><br></pre></td></tr></table></figure><p>（5）修改comments.swig配置文件</p><p>打开 <code>myblog/themes/next/layout/_partials</code> 目录下的 <code>comments.swig</code>文件，搜索关键字 <code>valine</code>找到以下代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elseif theme.valine.appid and theme.valine.appkey %&#125;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"comments"</span> id=<span class="string">"comments"</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&#123;% endif %&#125;</span></span><br></pre></td></tr></table></figure><p>将以上代码改成以下代码:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elseif theme.valine.appid and theme.valine.appkey %&#125;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"comments"</span> id=<span class="string">"comments"</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &#123;% elseif theme.gitalk.enable %&#125;</span></span><br><span class="line"><span class="regexp">    &lt;div class="comments" id="comments"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div id="gitalk-container"&gt;&lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&#123;% endif %&#125;</span></span><br></pre></td></tr></table></figure><p>（6）修改主题配置文件</p><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，根据自己的情况添加如下代码:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Gitalk</span></span><br><span class="line"><span class="comment"># more info please open https://github.com/gitalk/gitalk</span></span><br><span class="line"><span class="attr">gitalk:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">clientID:</span> <span class="string">d933e443cdfe503ce05a</span>  <span class="comment">#创建Github Application时生成的clientID</span></span><br><span class="line">  <span class="attr">clientSecret:</span> <span class="string">149d163f4b10cedf7a68993289da9c0f0836bd34</span>   <span class="comment">#创建Github Application时生成的clientSecret</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">mygitalk</span>    <span class="comment">#填之前创建好的存放issue的仓库名</span></span><br><span class="line">  <span class="attr">owner:</span> <span class="string">qcmoke</span>   <span class="comment">#填Github 用户名</span></span><br><span class="line">  <span class="attr">admin:</span> <span class="string">qcmoke</span>   <span class="comment">#填Github 用户名</span></span><br><span class="line">  <span class="attr">distractionFreeMode:</span> <span class="literal">true</span>   <span class="comment">#类似Facebook评论框的全屏遮罩效果.</span></span><br><span class="line">  <span class="attr">createIssueManually:</span> <span class="literal">true</span>  <span class="comment">#如果当前页面没有相应的 isssue ，且登录的用户属于 admin，则会自动创建 issue。如果设置为 true，则显示一个初始化页面，创建 issue 需要点击 init 按钮。</span></span><br></pre></td></tr></table></figure><p>为了不出错同时也方便管理，你可将这些代码放在gitment（如果之前有配置的话）板块后。如我的：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1181121489.png" alt="1537366863938.png"></p><p>（7）部署到github</p><p>最后通过 hexo 部署你的博客，即可看到gitalk评论面板的效果。</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/3837116534.png" alt="1537367186506.png"></p><p>（8）初始化每篇文章的Issue</p><p>你可能会发现还不能评论，很简单，你只需要点击 <code>初始化Issue</code>,之后就要以github账号登录。登录成功后便自动完成初始化。（注意，只能通过自己的github账号来初始化）。初始化需要刷新一下，结果如下图，github用户就能通过登录github账号进行评论了。</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/627571429.png" alt="1537367817100.png"></p><p>同时存放评论数据的仓库，<code>Issues</code>下也生成了Issue数据</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/2491529604.png" alt="1537367920673.png"></p><p>至此，加入Gitalk评论面板完结。</p><h3 id="2-vssue"><a class="header-anchor" href="#2-vssue">¶</a>2) Vssue</h3><p>目前发现Gitalk是很好的，但是目前它只支持github代码托管平台，但碍于github服务器在国外，评论面板有时候会由于网络的原因导致无法请求api，所以这才认识到了Vssue，Vssue和Gitalk的功能差不多，它支持多个代码托管平台（GitHub、GitLab、Bitbucket、Gitee、Gitea），如果使用Gitee作为评论api的话，网络延时的问题就会得到比较好的解决。接下来就奉上教程。</p><p>（1）在目录 <code>myblog/themes/next/layout/_third-party/comments</code>下创建一个 <code>vssue.swig</code>文件。内容如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.vssue.enable %&#125;</span><br><span class="line">  &#123;% if page.comments %&#125;</span><br><span class="line">  <span class="comment">&lt;!-- Vssue 的样式文件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; theme.vssue.vssueCss &#125;&#125;"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Vue 运行时版 (runtime only)  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; theme.vssue.vueRuntimeJs &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 在 Vue 之后引入 Vssue --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; theme.vssue.vssueTypeJs &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 将 Vssue 作为 Vue 组件使用,对于 Vue 运行时版，使用渲染函数（render function） --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#vssue'</span>,</span></span><br><span class="line"><span class="javascript">      render: <span class="function"><span class="params">h</span> =&gt;</span> h(<span class="string">'Vssue'</span>, &#123;</span></span><br><span class="line">        props: &#123;</span><br><span class="line"><span class="actionscript">          <span class="comment">// 在这里设置当前页面对应的 Issue 标题</span></span></span><br><span class="line"><span class="actionscript">          title: <span class="string">'&#123;&#123;theme.vssue.title&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// 在这里设置你使用的平台的 OAuth App 配置</span></span></span><br><span class="line">          options: &#123;</span><br><span class="line"><span class="actionscript">            owner: <span class="string">'&#123;&#123;theme.vssue.owner&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">            repo: <span class="string">'&#123;&#123;theme.vssue.repo&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">            clientId: <span class="string">'&#123;&#123;theme.vssue.clientId&#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">            clientSecret: <span class="string">'&#123;&#123;theme.vssue.clientSecret&#125;&#125;'</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--自定义样式--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.vssue</span> &#123;</span></span><br><span class="line">      width: 96%;</span><br><span class="line"><span class="css">      <span class="selector-tag">color</span>: <span class="selector-id">#60676d</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.vssue</span> <span class="selector-class">.vssue-button</span> &#123;</span></span><br><span class="line">      padding: unset;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.vssue</span> <span class="selector-class">.vssue-button</span><span class="selector-pseudo">:not(</span><span class="selector-pseudo">:disabled).vssue-button-primary</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">color</span>: <span class="selector-id">#60676d</span>;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">border-color</span>: <span class="selector-id">#60676d</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.vssue</span> <span class="selector-pseudo">:not(.vssue-comment-content)</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">color</span>: <span class="selector-id">#333</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>（2）在 <code>myblog/themes/next/layout/_third-party/comments</code>目录下的 <code>index.swig</code>文件最后加入以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include 'vssue.swig' %&#125;</span><br></pre></td></tr></table></figure><p>（3）打开 <code>myblog/themes/next/layout/_partials</code> 目录下的 <code>comments.swig</code>文件，添加如下 <code>+</code>的内容：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">   &#123;% elseif theme.valine.appid and theme.valine.appkey %&#125;</span><br><span class="line">    &lt;div class="comments" id="comments"&gt;&lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">   &#123;% elseif theme.gitalk.enable %&#125;</span><br><span class="line">    &lt;div class="comments" id="comments"&gt;</span><br><span class="line">      &lt;div id="gitalk-container"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="addition">+   &#123;% elseif theme.vssue.enable %&#125;</span></span><br><span class="line"><span class="addition">+    &lt;div class="comments" id="comments"&gt;</span></span><br><span class="line"><span class="addition">+      &lt;div id="vssue"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="addition">+    &lt;/div&gt;</span></span><br><span class="line">  </span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>（4）修改主题配置文件</p><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件，根据自己的情况添加如下代码:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Vssue</span></span><br><span class="line"><span class="comment"># more info please open https://vssue.js.org</span></span><br><span class="line"><span class="attr">vssue:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment">#是否开启vssue评论面板</span></span><br><span class="line">  <span class="attr">owner:</span> <span class="string">qcmoke</span> <span class="comment">#git管理用户</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">myvssue</span> <span class="comment">#git仓库名称</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Vssue</span> <span class="string">Dev</span> <span class="comment">#对应的Issue标题</span></span><br><span class="line">  <span class="attr">clientId:</span> <span class="string">b0634**********1012aa</span> <span class="comment">#OAuth App clientId</span></span><br><span class="line">  <span class="attr">clientSecret:</span> <span class="string">7a3********620313</span> <span class="comment">#OAuth App clientSecret</span></span><br><span class="line">  <span class="comment">#Vssue js文件（支持多个代码托管平台，切换平台时要切换相应的js文件）</span></span><br><span class="line">  <span class="comment">#GitHub：https://unpkg.com/vssue/dist/vssue.github.min.js</span></span><br><span class="line">  <span class="comment">#GitLab：https://unpkg.com/vssue/dist/vssue.gitlab.min.js</span></span><br><span class="line">  <span class="comment">#Bitbucket：https://unpkg.com/vssue/dist/vssue.bitbucket.min.js</span></span><br><span class="line">  <span class="comment">#Gitee：https://unpkg.com/vssue/dist/vssue.gitee.min.js</span></span><br><span class="line">  <span class="comment">#Gitea：https://unpkg.com/vssue/dist/vssue.gitea.min.js</span></span><br><span class="line">  <span class="attr">vssueTypeJs:</span> <span class="string">https://unpkg.com/vssue/dist/vssue.gitee.min.js</span></span><br><span class="line">  <span class="attr">vssueCss:</span> <span class="string">https://unpkg.com/vssue/dist/vssue.min.css</span> <span class="comment">#Vssue 的样式文件</span></span><br><span class="line">  <span class="attr">vueRuntimeJs:</span> <span class="string">https://unpkg.com/vue/dist/vue.runtime.min.js</span> <span class="comment">#Vue 运行时版 (runtime only)</span></span><br></pre></td></tr></table></figure><p>至此，加入Vssue评论面板完结。</p><blockquote><p>💁‍♂ 提示：</p><p>clientId和clientSecret和Gitalk的申请差不多，可以自行去相应的git代码托管平台进行申请。当然我推荐你去参考非常详细的官方指南：<a href="https://vssue.js.org/zh/guide" target="_blank" rel="noopener">https://vssue.js.org/zh/guide</a></p></blockquote><h3 id="3-valine"><a class="header-anchor" href="#3-valine">¶</a>3) Valine</h3><p>valine是一个优秀的评论系统软件，后台的评论数据依赖于leancloud的云存储，所以还需要去leancloud官网设置数据存储功能。</p><p>（1）首先就是去leancloud获取 <code>appid</code>和 <code>appkey</code>，怎么获取可以参考上文中的&quot;网站访问统计=&gt;leandcloud统计”。</p><blockquote><p>💁‍♂提示： 其中 <code>appid</code>和 <code>appkey</code>与leandcloud统计一样就行。</p></blockquote><p>（2）另外，还需要在leancloud后台创建一个Comment的Class，用于数据存储。</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200306115321197.png" alt="image-20200306115321197"></p><blockquote><p>虽然网上有人说valine会自动创建这个Class，但是我在用国际版测试的时候发现一直无权限或者提示没这个Class，那倒不如直接创建就好。</p></blockquote><p>（3）修改主题配置文件，配置 <code>valine</code>。修改 <code>enable</code>为 <code>true</code>，并且添加 <code>appid</code>和 <code>appkey</code>即可。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Valine.</span></span><br><span class="line"><span class="comment"># You can get your appid and appkey from https://leancloud.cn</span></span><br><span class="line"><span class="comment"># more info please open https://valine.js.org</span></span><br><span class="line"><span class="attr">valine:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">appid:</span>  <span class="string">75OSy9**********zoHsz</span> <span class="comment"># your leancloud application appid</span></span><br><span class="line">  <span class="attr">appkey:</span>  <span class="string">LKk**************GeB</span> <span class="comment"># your leancloud application appkey</span></span><br><span class="line">  <span class="attr">notify:</span> <span class="literal">false</span> <span class="comment"># mail notifier , https://github.com/xCss/Valine/wiki</span></span><br><span class="line">  <span class="attr">verify:</span> <span class="literal">false</span> <span class="comment"># Verification code</span></span><br><span class="line">  <span class="attr">placeholder:</span> <span class="string">Just</span> <span class="string">go</span> <span class="string">go</span> <span class="comment"># comment box placeholder</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">mm</span> <span class="comment"># gravatar style</span></span><br><span class="line">  <span class="attr">guest_info:</span> <span class="string">nick,mail,link</span> <span class="comment"># custom comment header</span></span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span> <span class="comment"># pagination size</span></span><br><span class="line">  <span class="attr">server_api:</span> <span class="string">https://leancloud.qcmoke.cn</span></span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂说明：</p><p>avatar 是设置默认头像，可以去https://valine.js.org/avatar 选择默认头像</p><p>更多详细内容请查阅valine的官方文档：<a href="https://valine.js.org" target="_blank" rel="noopener">https://valine.js.org</a></p></blockquote><p>下载av-min.js和av-min.js.map放到themes/next/source/js/src`下：</p><blockquote><p><a href="https://code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js" target="_blank" rel="noopener">https://code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js</a></p><p><a href="https://code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js.map" target="_blank" rel="noopener">https://code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js.map</a></p></blockquote><p>（2）然后修改 <code>themes/next/layout/_third-party/comments/valine.swig</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.valine.enable %&#125;</span><br><span class="line">  &#123;% if page.comments %&#125;</span><br><span class="line">    <span class="comment">&lt;!--Leancloud 操作库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/src/av-min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Valine 的核心代码库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">'//unpkg.com/valine/dist/Valine.min.js'</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> emoticonList=[]</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">164</span>; i++)&#123;</span></span><br><span class="line"><span class="actionscript">        emoticonList.push(<span class="string">"aru ("</span>+i+<span class="string">").png"</span>)</span></span><br><span class="line">      &#125;</span><br><span class="line"><span class="actionscript">      <span class="keyword">new</span> Valine(&#123;</span></span><br><span class="line"><span class="actionscript">          lang: <span class="string">'zh-cn'</span>,</span></span><br><span class="line"><span class="actionscript">          admin_email: <span class="string">'qcmoke@gmail.com'</span>,</span></span><br><span class="line"><span class="actionscript">          el: <span class="string">'#comments-valine'</span> ,</span></span><br><span class="line"><span class="actionscript">          appId: <span class="string">'&#123;&#123; theme.valine.appid &#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">          appKey: <span class="string">'&#123;&#123; theme.valine.appkey &#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">          placeholder: <span class="string">'&#123;&#123; theme.valine.placeholder &#125;&#125;'</span>,</span></span><br><span class="line"><span class="actionscript">          serverURLs: <span class="string">'&#123;&#123; theme.valine.server_api &#125;&#125;'</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">//点击邮件中的链接跳转至相应评论</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span>(<span class="built_in">window</span>.location.hash)&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> checkExist = setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> ($(<span class="built_in">window</span>.location.hash).length) &#123;</span></span><br><span class="line"><span class="javascript">                $(<span class="string">'html, body'</span>).animate(&#123;<span class="attr">scrollTop</span>: $(<span class="built_in">window</span>.location.hash).offset().top<span class="number">-90</span>&#125;, <span class="number">1000</span>);</span></span><br><span class="line">                clearInterval(checkExist);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, 100);</span><br><span class="line">      &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>（1）关于自定义环境变量</p><p>直接参考我下面的可以尽量避免出错。下面附上我的leancloud管理后台自定义环境变量：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200307175642685.png" alt="image-20200307175642685"></p><p>💁‍♂补充说明：</p><p>（1）我配置的smtp账号和密码是Gmail的，当然还可以使用其他的，比如QQ，Outlook等，具体可参考这篇文章：<a href="http://help.cy-email.com/yxtj-cyyx" target="_blank" rel="noopener">http://help.cy-email.com/yxtj-cyyx</a></p><p>（2）如果机器正在启动然后就修改这些环境变量的话是需要到“部署”那里重启的。</p><p>（3）有几个邮件模板环境变量图片中显示不全，下面是完整的。</p><p>MAIL_SUBJECT</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PARENT_NICK&#125;，您在『$&#123;SITE_NAME&#125;』上的评论收到了回复</span><br></pre></td></tr></table></figure><p>MAIL_TEMPLATE</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"border-radius: 10px 10px 10px 10px;font-size:13px;color: #555555;width: 666px;font-family:'Century Gothic','Trebuchet MS','Hiragino Sans GB',微软雅黑,'Microsoft Yahei',Tahoma,Helvetica,Arial,'SimSun',sans-serif;margin:50px auto;border:1px solid #eee;max-width:100%;background: #ffffff repeating-linear-gradient(-45deg,#fff,#fff 1.125rem,transparent 1.125rem,transparent 2.25rem);box-shadow: 0 1px 5px rgba(0, 0, 0, 0.15);"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width:100%;background:#49BDAD;color:#ffffff;border-radius: 10px 10px 0 0;background-image: -moz-linear-gradient(0deg, rgb(67, 198, 184), rgb(255, 209, 244));background-image: -webkit-linear-gradient(0deg, rgb(67, 198, 184), rgb(255, 209, 244));height: 66px;"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"font-size:15px;word-break:break-all;padding: 23px 32px;margin:0;background-color: hsla(0,0%,100%,.4);border-radius: 10px 10px 0 0;"</span>&gt;</span>您在<span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">"text-decoration:none;color: #ffffff;"</span> <span class="attr">href</span>=<span class="string">"$&#123;SITE_URL&#125;"</span>&gt;</span>『$&#123;SITE_NAME&#125;』<span class="tag">&lt;/<span class="name">a</span>&gt;</span>上的留言有新回复啦！！！<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin:40px auto;width:90%"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>"<span class="tag">&lt;<span class="name">strong</span>&gt;</span>$&#123;PARENT_NICK&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>" 同学，您曾发表评论：<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"background: #fafafa repeating-linear-gradient(-45deg,#fff,#fff 1.125rem,transparent 1.125rem,transparent 2.25rem);box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);margin:20px 0px;padding:15px;border-radius:5px;font-size:14px;color:#555555;"</span>&gt;</span>$&#123;PARENT_COMMENT&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>"<span class="tag">&lt;<span class="name">strong</span>&gt;</span>$&#123;NICK&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>" 给您的回复如下：<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"background: #fafafa repeating-linear-gradient(-45deg,#fff,#fff 1.125rem,transparent 1.125rem,transparent 2.25rem);box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);margin:20px 0px;padding:15px;border-radius:5px;font-size:14px;color:#555555;"</span>&gt;</span>$&#123;COMMENT&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>您可以点击：<span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">"text-decoration:none; color:#12addb"</span> <span class="attr">href</span>=<span class="string">"$&#123;POST_URL&#125;"</span>&gt;</span>[回复的完整内容] <span class="tag">&lt;/<span class="name">a</span>&gt;</span>进行查看。欢迎再次光临<span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">"text-decoration:none; color:#12addb"</span> <span class="attr">href</span>=<span class="string">"$&#123;SITE_URL&#125;"</span>&gt;</span> 『$&#123;SITE_NAME&#125;』<span class="tag">&lt;/<span class="name">a</span>&gt;</span>！！！<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span>&#123;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>&#123;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:active</span>&#123;<span class="attribute">text-decoration</span>:none&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>MAIL_SUBJECT_ADMIN</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">叮咚！『$&#123;SITE_NAME&#125;』上有了新评论！</span><br></pre></td></tr></table></figure><p>MAIL_TEMPLATE_ADMIN</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"border-radius: 10px 10px 10px 10px;font-size:13px; color: #555555;width: 666px;font-family:'Century Gothic','Trebuchet MS','Hiragino Sans GB',微软雅黑,'Microsoft Yahei',Tahoma,Helvetica,Arial,'SimSun',sans-serif;margin:50px auto;border:1px solid #eee;max-width:100%;background: #ffffff repeating-linear-gradient(-45deg,#fff,#fff 1.125rem,transparent 1.125rem,transparent 2.25rem);box-shadow: 0 1px 5px rgba(0, 0, 0, 0.15);"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width:100%;background:#49BDAD;color:#ffffff;border-radius: 10px 10px 0 0;background-image: -moz-linear-gradient(0deg, rgb(67, 198, 184), rgb(255, 209, 244));background-image: -webkit-linear-gradient(0deg, rgb(67, 198, 184), rgb(255, 209, 244));height: 66px;"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"font-size:15px;word-break:break-all;padding: 23px 32px;margin:0;background-color: hsla(0,0%,100%,.4);border-radius: 10px 10px 0 0;"</span>&gt;</span>您的<span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">"text-decoration:none;color: #ffffff;"</span> <span class="attr">href</span>=<span class="string">"$&#123;SITE_URL&#125;"</span>&gt;</span> 『$&#123;SITE_NAME&#125;』 <span class="tag">&lt;/<span class="name">a</span>&gt;</span>上有了新的评论 <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin:40px auto;width:90%"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>"$&#123;NICK&#125;"<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> 发表评论：<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"background: #fafafa repeating-linear-gradient(-45deg,#fff,#fff 1.125rem,transparent 1.125rem,transparent 2.25rem);box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);margin:20px 0px;padding:15px;border-radius:5px;font-size:14px;color:#555555;"</span>&gt;</span>$&#123;COMMENT&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">"text-decoration:none; color:#12addb"</span> <span class="attr">href</span>=<span class="string">"$&#123;POST_URL&#125;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>[查看详情]<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span>&#123;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>&#123;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:active</span>&#123;<span class="attribute">text-decoration</span>:none&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果使用国际版leancloud，那么leancloud的定时任务要做一些调整。主要就是将官方的介绍时间调整成北京时区的时间。</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200306133741358.png" alt="image-20200306133741358"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 北京时间每天早8点检查过去24小时内漏发的通知邮件一并补发</span></span><br><span class="line">0 0 0 * * ?</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每天早0点到晚23点每隔30分钟访问云引擎</span></span><br><span class="line">0 0/30 0-23 * * ?</span><br></pre></td></tr></table></figure><h3 id="4-整合多个评论面板"><a class="header-anchor" href="#4-整合多个评论面板">¶</a>4) 整合多个评论面板</h3><p>编辑 <code>/themes/next/layout/_third-party/comments/valine.swig</code>，修改如下：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	new Valine(&#123;</span><br><span class="line"><span class="deletion">-        el: '#comments' ,      </span></span><br><span class="line"><span class="addition">+        el: '#comments-valine' ,</span></span><br></pre></td></tr></table></figure><p>编辑 <code>themes/next/layout/_partials/comments.swig</code>，修改如下：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">  &#123;% elseif theme.gitment.enable %&#125;</span><br><span class="line">    &lt;div class="comments" id="comments"&gt;</span><br><span class="line">      &#123;% if theme.gitment.lazy %&#125;</span><br><span class="line">        &lt;div onclick="showGitment()" id="gitment-display-button"&gt;&#123;&#123; __('gitmentbutton') &#125;&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div id="gitment-container" style="display:none"&gt;&lt;/div&gt;</span><br><span class="line">      &#123;% else %&#125;</span><br><span class="line">        &lt;div id="gitment-container"&gt;&lt;/div&gt;</span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="addition">+  &#123;% elseif theme.gitalk.enable and theme.valine.enable %&#125;</span></span><br><span class="line"><span class="addition">+    &lt;div class="comments" id="comments"&gt;</span></span><br><span class="line"><span class="addition">+      &lt;div class="tablink-li"&gt;</span></span><br><span class="line"><span class="addition">+          &lt;button class="tablink" onclick="openPage('tabs-gitalk',this)" id="defaultOpen"&gt;Gitalk&lt;/button&gt;</span></span><br><span class="line"><span class="addition">+          &lt;button class="tablink" onclick="openPage('tabs-valine',this)"&gt;Valine&lt;/button&gt;</span></span><br><span class="line"><span class="addition">+      &lt;/div&gt;</span></span><br><span class="line"><span class="addition">+      &lt;div class="tabcontent-li"&gt;</span></span><br><span class="line"><span class="addition">+          &lt;div id="tabs-gitalk" class="tabcontent"&gt;</span></span><br><span class="line"><span class="addition">+              &lt;div id="gitalk-container"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="addition">+          &lt;/div&gt;</span></span><br><span class="line"><span class="addition">+          &lt;div id="tabs-valine" class="tabcontent"&gt;</span></span><br><span class="line"><span class="addition">+              &lt;div id="comments-valine"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="addition">+          &lt;/div&gt;</span></span><br><span class="line"><span class="addition">+      &lt;/div&gt;</span></span><br><span class="line"><span class="addition">+    &lt;/div&gt;</span></span><br><span class="line"><span class="addition">+    &lt;script&gt;</span></span><br><span class="line"><span class="addition">+      function openPage(pageName, elmnt) &#123;</span></span><br><span class="line"><span class="addition">+        var i, tabcontent;</span></span><br><span class="line"><span class="addition">+        tabcontent = document.getElementsByClassName("tabcontent");</span></span><br><span class="line"><span class="addition">+        for (i = 0; i &lt; tabcontent.length; i++) &#123;</span></span><br><span class="line"><span class="addition">+          tabcontent[i].style.display = "none";</span></span><br><span class="line"><span class="addition">+        &#125;</span></span><br><span class="line"><span class="addition">+        tablinks = document.getElementsByClassName("tablink");</span></span><br><span class="line"><span class="addition">+        for (i = 0; i &lt; tablinks.length; i++) &#123;</span></span><br><span class="line"><span class="addition">+          tablinks[i].classList.remove("currentTabcontent");</span></span><br><span class="line"><span class="addition">+        &#125;</span></span><br><span class="line"><span class="addition">+        document.getElementById(pageName).style.display = "block";</span></span><br><span class="line"><span class="addition">+        elmnt.classList.add("currentTabcontent");</span></span><br><span class="line"><span class="addition">+      &#125;</span></span><br><span class="line"><span class="addition">+      document.getElementById("defaultOpen").click();;</span></span><br><span class="line"><span class="addition">+    &lt;/script&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="deletion">- &#123;% elseif theme.valine.appid and theme.valine.appkey %&#125;</span></span><br><span class="line"><span class="deletion">-   &lt;div class="comments" id="comments"&gt;&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+  &#123;% elseif theme.valine.enable %&#125;</span></span><br><span class="line"><span class="addition">+    &lt;div class="comments" id="comments"&gt;</span></span><br><span class="line"><span class="addition">+      &lt;div id="comments-valine"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="addition">+    &lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line">  &#123;% elseif theme.gitalk.enable %&#125;</span><br><span class="line">    &lt;div class="comments" id="comments"&gt;</span><br><span class="line">      &lt;div id="gitalk-container"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &#123;% elseif theme.vssue.enable %&#125;</span><br><span class="line">    &lt;div class="comments" id="comments"&gt;</span><br><span class="line">      &lt;div id="vssue"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>创建 <code>themes/next/source/css/_custom/comments.styl</code>文件，内容如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 评论区样式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.main-inner</span> <span class="selector-class">.comments</span> &#123;</span><br><span class="line">  <span class="comment">// margin: 60px 0 20px 0;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 去掉链接下的下划线</span></span><br><span class="line">  <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.highlight</span> pre &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#24292e</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 防止代码区边缘黑线</span></span><br><span class="line">  <span class="selector-class">.highlight</span>,</span><br><span class="line">  pre &#123;</span><br><span class="line">    <span class="attribute">background</span>: unset;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.highlight</span> ::selection &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#2593a6</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#24292e</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.tablink-li</span> &#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">30px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tabcontent-li</span> &#123;</span><br><span class="line">    <span class="attribute">border-top</span>: solid <span class="number">1px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tablink</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ddd</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#60676d</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tablink</span>:hover &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#222</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tabcontent</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.currentTabcontent</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#222</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-id">#tabs-valine</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">25px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.valine</span> &#123;</span><br><span class="line">    <span class="selector-class">.vwrap</span> &#123;</span><br><span class="line">      <span class="selector-class">.textarea-wrapper</span> <span class="selector-class">.comment_trigger</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.textarea-wrapper</span> <span class="selector-tag">textarea</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.auth-section</span> <span class="selector-class">.input-wrapper</span> <span class="selector-tag">input</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.auth-section</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.auth-section</span> <span class="selector-class">.post-action</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#333</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>✉️ 由于整合vssue的过程中发现单独使用没问题，但是和其他评论面板在一起发生回调地址不正确的问题，于是这里暂且只整合了Gitalk和Valine，如果有小伙伴找到了解决方案，欢迎联系本人，鲜花奉上！🌹</p></blockquote><h2 id="4-添加热门文章页面"><a class="header-anchor" href="#4-添加热门文章页面">¶</a>4. 添加热门文章页面</h2><blockquote><p>💁‍♂说明：</p><p>这里添加热门文章页面的原理是通过leancloud访问统计生成的数据实现的，故需要编辑 <code>themes/next/_config.yml</code>主题配置文件开启 <code>leancloud_visitors</code>的功能。具体操作请参考上文的“leancloud统计”。</p></blockquote><p>创建 <code>themes/next/layout/top.swig</code>文件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&#123;% block content %&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line">  &#123;### LINKS BLOCK ###&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"top"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--下载av-min.js放到themes/next/source/js/src下：https://code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/src/av-min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> appId = <span class="string">'&#123;&#123; theme.leancloud_visitors.app_id &#125;&#125;'</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> appKey = <span class="string">'&#123;&#123; theme.leancloud_visitors.app_key &#125;&#125;'</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> serverApi = <span class="string">'&#123;&#123; theme.leancloud_visitors.server_api &#125;&#125;'</span></span></span><br><span class="line">    if(serverApi)&#123;</span><br><span class="line">      AV.init(&#123;appId, appKey,serverURLs: serverApi&#125;);</span><br><span class="line"><span class="actionscript">    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line">      AV.initialize(appId, appKey)</span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> time = <span class="number">0</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> title = <span class="string">""</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> url = <span class="string">""</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> query = <span class="keyword">new</span> AV.Query(<span class="string">'Counter'</span>);</span></span><br><span class="line"><span class="actionscript">    query.notEqualTo(<span class="string">'id'</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="actionscript">    query.descending(<span class="string">'time'</span>);</span></span><br><span class="line">    query.limit(1000);</span><br><span class="line"><span class="actionscript">    query.find().then(<span class="function"><span class="keyword">function</span> <span class="params">(dataArray)</span> </span>&#123;</span></span><br><span class="line">      if(!dataArray)&#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span></span></span><br><span class="line">      &#125;</span><br><span class="line"><span class="actionscript">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dataArray.length; i++) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> item = dataArray[i]</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> result = item.attributes;</span></span><br><span class="line">        time = result.time;</span><br><span class="line">        title = result.title;</span><br><span class="line">        url = result.url;</span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> content = <span class="string">"&lt;p&gt;"</span> + <span class="string">"&lt;font color='#1C1C1C'&gt;"</span> + <span class="string">"【文章热度:"</span> + time + <span class="string">"℃】"</span> + <span class="string">"&lt;/font&gt;"</span> + <span class="string">"&lt;a href='"</span> + url + <span class="string">"'&gt;"</span> + title + <span class="string">"&lt;/a&gt;"</span> + <span class="string">"&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"top"</span>).innerHTML+=content</span></span><br><span class="line">      &#125;</span><br><span class="line"><span class="actionscript">    &#125;, <span class="function"><span class="keyword">function</span> <span class="params">(error)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"error"</span>,error);</span></span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.post-description</span> &#123;</span></span><br><span class="line">      display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">  &#123;### END LINKS BLOCK ###&#125;</span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂ 提醒：</p><p>如果你的博客使用了 Valine 评论系统，那么可能会有代码冲突问题。需要修改 <code>themes/next/layout/_third-party/comments/valine.swig</code> 加入 <code>{% if page.comments %}</code>这个判断条件，默认旧版的next没有这个条件。可参考上文“增强版valine”相关代码。</p></blockquote><p>编辑 <code>themes/next/layout/page.swig</code>,修改两处代码</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">  &#123;% block title %&#125;&#123;#</span><br><span class="line">  #&#125;&#123;% set page_title_suffix = ' | ' + config.title %&#125;&#123;#</span><br><span class="line"></span><br><span class="line">  #&#125;&#123;% if page.type <span class="comment">=== "categories" and not page.title %&#125;&#123;#</span></span><br><span class="line">    #&#125;&#123;&#123; __('title.category') + page_title_suffix &#125;&#125;&#123;#</span><br><span class="line">  #&#125;&#123;% elif page.type <span class="comment">=== "tags" and not page.title %&#125;&#123;#</span></span><br><span class="line">    #&#125;&#123;&#123; __('title.tag') + page_title_suffix &#125;&#125;&#123;#</span><br><span class="line">  &lt;!-- 友情链接--&gt;</span><br><span class="line">  #&#125;&#123;% elif page.type <span class="comment">=== 'links' and not page.title %&#125;&#123;#</span></span><br><span class="line">    #&#125;&#123;&#123; __('title.links') + page_title_suffix &#125;&#125;&#123;#</span><br><span class="line"><span class="addition">+ &lt;!-- top页面--&gt;</span></span><br><span class="line"><span class="addition">+ #&#125;&#123;% elif page.type === 'top' and not page.title %&#125;&#123;#</span></span><br><span class="line"><span class="addition">+   #&#125;&#123;&#123; __('title.top') + page_title_suffix &#125;&#125;&#123;#</span></span><br><span class="line">  #&#125;&#123;% else %&#125;&#123;#</span><br><span class="line">    #&#125;&#123;&#123; page.title + page_title_suffix &#125;&#125;&#123;#</span><br><span class="line">  #&#125;&#123;% endif %&#125;&#123;#</span><br><span class="line">#&#125;&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">  &#123;% elif page.type <span class="comment">=== 'categories' %&#125;</span></span><br><span class="line">          &lt;div class="category-all-page"&gt;</span><br><span class="line">            &lt;div class="category-all-title"&gt;</span><br><span class="line">                &#123;&#123; _p('counter.categories', site.categories.length) &#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class="category-all"&gt;</span><br><span class="line">              &#123;&#123; list_categories() &#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;!-- 友情链接--&gt;</span><br><span class="line">        &#123;% elif page.type <span class="comment">=== 'links' %&#125;</span></span><br><span class="line">          &#123;% include 'links.swig' %&#125;</span><br><span class="line"><span class="addition">+       &lt;!-- top页面--&gt;</span></span><br><span class="line"><span class="addition">+       &#123;% elif page.type === 'top' %&#125;</span></span><br><span class="line"><span class="addition">+         &#123;% include 'top.swig' %&#125;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">          &#123;&#123; page.content &#125;&#125;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">      &lt;/div&gt;</span><br></pre></td></tr></table></figure><p>创建 <code>myblog/source/top/index.md</code>文件</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章阅读量排行榜</span><br><span class="line">type: top</span><br><span class="line">comments: false</span><br><span class="line">keywords: top,文章阅读量排行榜,热文,文章热度,热门文章</span><br><span class="line">description: 博客文章阅读量排行榜</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>然后编辑 <code>themes/next/_config.yml</code>，添加菜单项</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="attr">links:</span> <span class="string">/links/</span> <span class="string">||</span> <span class="string">link</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span></span><br><span class="line">  <span class="string">热文:</span> <span class="string">/top/</span> <span class="string">||</span> <span class="string">fire</span></span><br></pre></td></tr></table></figure><h2 id="5-添加在线联系功能"><a class="header-anchor" href="#5-添加在线联系功能">¶</a>5. 添加在线联系功能</h2><p>在这使用的是DaoVoice做在线联系功能。<br>首先到<a href="https://dashboard.daovoice.io/" target="_blank" rel="noopener">DaoVoice</a>上注册一个账号,注册完成后会得到一个app_id，获取appid的步骤如下图所示:</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538456184961.png" alt="1538456184961"></p><p>打开myblog/themes/next/layout/_partials/head.swig文件找到如下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include &#39;head&#x2F;custom-head.swig&#39; %&#125;</span><br></pre></td></tr></table></figure><p>另起一行添加如下代码（实际我就是添加到最后）：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.daovoice %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  (<span class="function"><span class="keyword">function</span>(<span class="params">i,s,o,g,r,a,m</span>)</span>&#123;i[<span class="string">"DaoVoiceObject"</span>]=r;i[r]=i[r]||<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;(i[r].q=i[r].q||[]).push(<span class="built_in">arguments</span>)&#125;,i[r].l=<span class="number">1</span>*<span class="keyword">new</span> <span class="built_in">Date</span>();a=s.createElement(o),m=s.getElementsByTagName(o)[<span class="number">0</span>];a.async=<span class="number">1</span>;a.src=g;a.charset=<span class="string">"utf-8"</span>;m.parentNode.insertBefore(a,m)&#125;)(<span class="built_in">window</span>,<span class="built_in">document</span>,<span class="string">"script"</span>,(<span class="string">'https:'</span> == <span class="built_in">document</span>.location.protocol ? <span class="string">'https:'</span> : <span class="string">'http:'</span>) + <span class="string">"//widget.daovoice.io/widget/0f81ff2f.js"</span>,<span class="string">"daovoice"</span>)</span></span><br><span class="line"><span class="actionscript">  daovoice(<span class="string">'init'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">      app_id: <span class="string">"&#123;&#123;theme.daovoice_app_id&#125;&#125;"</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="actionscript">  daovoice(<span class="string">'update'</span>);</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>打开 <code>myblog/themes/next/_config.yml</code>主题配置文件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Online contact </span></span><br><span class="line"><span class="attr">daovoice:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">daovoice_app_id:</span> <span class="number">33</span><span class="string">***da4</span>  <span class="comment">#这里输入前面获取的app_id</span></span><br></pre></td></tr></table></figure><p>最后执行 <code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code>,打开博客就能看到效果了。如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538456671856.png" alt="1538456671856"></p><p>当然为了调整图标的位置，你可以登陆daovoice后台进行修改，如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538456771783.png" alt="1538456771783"></p><p>最后到右上角选择管理员，微信绑定,可以绑定你的微信号，关注公众号后打开小程序，在微信中登陆daovoice，就可以实时收发消息，有新的消息也会通过微信的小程序通知，设置页面如下:</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538456906088.png" alt="1538456906088"></p><h1 id="高级定制篇"><a class="header-anchor" href="#高级定制篇">¶</a>高级定制篇</h1><h2 id="1-自定义首页摘要图片和摘要描述"><a class="header-anchor" href="#1-自定义首页摘要图片和摘要描述">¶</a>1. 自定义首页摘要图片和摘要描述</h2><h3 id="1-概述"><a class="header-anchor" href="#1-概述">¶</a>1) 概述</h3><p>文章封面的意思就是：在博客首页的时候会显示文章的封面图片和摘要描述，进入这篇文章的详细页面后，将不显示这张图片和摘要描述。</p><p>如果想添加文章封面的话，需要添加字段属性：<code>summary_img</code>，<code>summary_img</code>的值是图片的路径。</p><p>如果想要添加摘要描述的话，可以添加字段属性：<code>summary_description</code> ，<code>summary_description</code> 的值是描述的内容。</p><p>例如：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: CSS 各种Hack手段</span><br><span class="line">date: 2017-06-25 03:25:24</span><br><span class="line">categories: 前端</span><br><span class="line">tags: [CSS]</span><br><span class="line">comments: false</span><br><span class="line">summary_img: /images/css-hack-1.png</span><br><span class="line">summary_description: 封面摘要描述，了解一下！</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h3 id="2-具体实现"><a class="header-anchor" href="#2-具体实现">¶</a>2) 具体实现</h3><p>修改 <code>myblog/themes/next/layout/_macro/post.swig</code> 文件。<br>将代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 自定义摘要图片开始 --&gt;</span></span><br><span class="line"> &#123;% if post.summary_img  %&#125;</span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"out-img-topic"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;&#123;</span> <span class="attr">post.summary_img</span> &#125;&#125; <span class="attr">class</span>=<span class="string">"img-topic"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> &#123;% endif %&#125;</span><br><span class="line"> <span class="comment">&lt;!-- 自定义摘要图片结束 --&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- 自定义摘要描述开始 --&gt;</span></span><br><span class="line"> &#123;% if post.summary_description  %&#125;</span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; post.summary_description &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> &#123;% endif %&#125;</span><br><span class="line"> <span class="comment">&lt;!-- 自定义摘要描述结束 --&gt;</span></span><br></pre></td></tr></table></figure><p>添加到以下所示的位置</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">  &#123;% if is_index %&#125;</span><br><span class="line">    <span class="comment">&lt;!-- 自定义摘要图片开始 --&gt;</span></span><br><span class="line">    &#123;% if post.summary_img  %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"out-img-topic"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;&#123;</span> <span class="attr">post.summary_img</span> &#125;&#125; <span class="attr">class</span>=<span class="string">"img-topic"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    <span class="comment">&lt;!-- 自定义摘要图片结束 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 自定义摘要描述开始 --&gt;</span></span><br><span class="line">    &#123;% if post.summary_description  %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; post.summary_description &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    <span class="comment">&lt;!-- 自定义摘要描述结束 --&gt;</span></span><br><span class="line">    &#123;% if post.description and theme.excerpt_description %&#125;</span><br><span class="line">      &#123;&#123; post.description &#125;&#125;</span><br><span class="line">      <span class="comment">&lt;!--noindex--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;"</span>&gt;</span></span><br><span class="line">          &#123;&#123; __('post.read_more') &#125;&#125; »</span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--/noindex--&gt;</span></span><br><span class="line">    &#123;% elif post.excerpt  %&#125;</span><br><span class="line">      &#123;&#123; post.excerpt &#125;&#125;</span><br><span class="line">      <span class="comment">&lt;!--noindex--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;&#123;% if theme.scroll_to_more %&#125;#&#123;&#123; __('post.more') &#125;&#125;&#123;% endif %&#125;"</span> <span class="attr">rel</span>=<span class="string">"contents"</span>&gt;</span></span><br><span class="line">          &#123;&#123; __('post.read_more') &#125;&#125; »</span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--/noindex--&gt;</span></span><br><span class="line">    &#123;% elif theme.auto_excerpt.enable %&#125;</span><br><span class="line">      &#123;% set content = post.content | striptags %&#125;</span><br><span class="line">      &#123;&#123; content.substring(0, theme.auto_excerpt.length) &#125;&#125;</span><br><span class="line">      &#123;% if content.length &gt; theme.auto_excerpt.length %&#125;...&#123;% endif %&#125;</span><br><span class="line">      <span class="comment">&lt;!--noindex--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;&#123;% if theme.scroll_to_more %&#125;#&#123;&#123; __('post.more') &#125;&#125;&#123;% endif %&#125;"</span> <span class="attr">rel</span>=<span class="string">"contents"</span>&gt;</span></span><br><span class="line">          &#123;&#123; __('post.read_more') &#125;&#125; »</span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--/noindex--&gt;</span></span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">      &#123;% if post.type === 'picture' %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;"</span>&gt;</span>&#123;&#123; post.content &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      &#123;% else %&#125;</span><br><span class="line">        &#123;&#123; post.content &#125;&#125;</span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% else %&#125;</span><br><span class="line">    &#123;&#123; post.content &#125;&#125;</span><br><span class="line">  &#123;% endif  %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;#####################&#125;</span><br><span class="line">&#123;### END POST BODY ###&#125;</span><br><span class="line">&#123;#####################&#125;</span><br></pre></td></tr></table></figure><p>这样的话，就可以使用 <code>summary_img: imageurl</code> 和 <code>summary_description: description demo</code>来设置文章封面和摘要描述了。</p><blockquote><p>💡建议：</p><p>开启了文章封面和摘要描述的文章，我建议将 <code>&lt;!-- more --&gt;</code> 放在文章正文内容的开头。</p><p>为了适应不同大小的图片，摘要图片的样式需要做一下调整。在 <code>myblog/themes/next/source/css/_custom/custom.styl</code>中添加以下样式代码：</p></blockquote><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//缩略图指定宽度值显示。</span></span><br><span class="line"><span class="selector-tag">img</span><span class="selector-class">.img-topic</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">75%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果希望hexo默认description也和summary_description居中显示，同样修改 <code>myblog/themes/next/layout/_macro/post.swig</code> 文件。找到以下代码。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if post.description and theme.excerpt_description %&#125;</span><br><span class="line">  &#123;&#123; post.description &#125;&#125;</span><br><span class="line">  <span class="comment">&lt;!--noindex--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;"</span>&gt;</span></span><br><span class="line">      &#123;&#123; __('post.read_more') &#125;&#125; »</span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--/noindex--&gt;</span></span><br><span class="line">&#123;% elif post.excerpt  %&#125;</span><br></pre></td></tr></table></figure><p>将以上代码改成：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if post.description and theme.excerpt_description %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; post.description &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--noindex--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-button text-center"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;"</span>&gt;</span></span><br><span class="line">      &#123;&#123; __('post.read_more') &#125;&#125; »</span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--/noindex--&gt;</span></span><br><span class="line">&#123;% elif post.excerpt  %&#125;</span><br></pre></td></tr></table></figure><h3 id="3-优化首页摘要样式"><a class="header-anchor" href="#3-优化首页摘要样式">¶</a>3) 优化首页摘要样式</h3><p>为了减小首页摘要文字的大小，使得能够更美观，可通过下面步骤修改：</p><p>编辑 <code>themes/next/layout/_macro/post.swig</code>。加入如下div。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if is_index %&#125;</span><br><span class="line"><span class="addition">+        &lt;div class="index-content"&gt;</span></span><br><span class="line">          &lt;!-- 自定义摘要图片开始 --&gt;</span><br><span class="line">          &#123;% if post.summary_img  %&#125;</span><br><span class="line">            &lt;div class="out-img-topic"&gt;</span><br><span class="line">              &lt;img src=&#123;&#123; post.summary_img &#125;&#125; class="img-topic"&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &#123;% endif %&#125;</span><br><span class="line">          &lt;!-- 自定义摘要图片结束 --&gt;</span><br><span class="line">            其他内容</span><br><span class="line">            其他内容</span><br><span class="line">            ......</span><br><span class="line">            &#123;% if post.type <span class="comment">=== 'picture' %&#125;</span></span><br><span class="line">              &lt;a href="&#123;&#123; url_for(post.path) &#125;&#125;"&gt;&#123;&#123; post.content &#125;&#125;&lt;/a&gt;</span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">              &#123;&#123; post.content &#125;&#125;</span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">          &#123;% endif %&#125;</span><br><span class="line"><span class="addition">+        &lt;/div&gt;</span></span><br><span class="line">      &#123;% else %&#125;</span><br><span class="line">        &#123;&#123; post.content &#125;&#125;</span><br><span class="line">      &#123;% endif  %&#125;</span><br></pre></td></tr></table></figure><p>然后编辑 <code>themes/next/source/css/_custom/custom.styl</code>并加入如下样式：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 摘要文字</span></span><br><span class="line"><span class="selector-class">.index-content</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-优化标签云页面"><a class="header-anchor" href="#2-优化标签云页面">¶</a>2. 优化标签云页面</h2><p>新建 <code>themes/next/layout/tag-color.swig</code>文件，拷贝如下内容：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">    &#123;########彩色标签云##########&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> alltags = <span class="built_in">document</span>.getElementsByClassName(<span class="string">'tag-cloud-tags'</span>);</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> tags = alltags[<span class="number">0</span>].getElementsByTagName(<span class="string">'a'</span>);</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; tags.length; i++) &#123;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">//console.log(tags[i]);</span></span></span><br><span class="line"><span class="actionscript">      <span class="comment">//默认next会根据文章的数量确定a标签字的大小，这里把字体修改成统一大小</span></span></span><br><span class="line"><span class="actionscript">      tags[i].style.background = <span class="string">"rgb(67, 67, 67)"</span>;</span></span><br><span class="line"><span class="actionscript">      tags[i].style.fontSize = <span class="string">"13px"</span>;</span></span><br><span class="line"><span class="actionscript">      tags[i].style.color = <span class="string">"#ddd"</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.tag-cloud-tags</span>&#123;</span></span><br><span class="line">    text-align: center;</span><br><span class="line">    counter-reset: tags;</span><br><span class="line">    margin-bottom: 20px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span>&#123;</span></span><br><span class="line">    border-radius: 6px;</span><br><span class="line">    padding-right: 5px;</span><br><span class="line">    padding-left: 5px;</span><br><span class="line">    margin: 8px 5px 0px 0px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span>&#123;</span></span><br><span class="line">    content: "🔖";</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="css">     <span class="selector-tag">box-shadow</span>: 0<span class="selector-tag">px</span> 5<span class="selector-tag">px</span> 15<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0,0,0,<span class="selector-class">.4</span>);</span></span><br><span class="line"><span class="css">     <span class="selector-tag">transform</span>: <span class="selector-tag">scale</span>(1<span class="selector-class">.1</span>);</span></span><br><span class="line"><span class="css">     <span class="selector-tag">transition-duration</span>: 0<span class="selector-class">.15s</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在 <code>themes/next/layout/page.swig</code>里引入 <code>tag-color.swig</code>。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">        &#123;# tagcloud page support #&#125;</span><br><span class="line">        &#123;% if page.type <span class="comment">=== "tags" %&#125;</span></span><br><span class="line">          &lt;div class="tag-cloud"&gt;</span><br><span class="line">            &lt;div class="tag-cloud-title"&gt;</span><br><span class="line">                &#123;&#123; _p('counter.tag_cloud', site.tags.length) &#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class="tag-cloud-tags"&gt;</span><br><span class="line">              &#123;&#123; tagcloud(&#123;min_font: 12, max_font: 30, amount: 300, color: true, start_color: '#ccc', end_color: '#111'&#125;) &#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="addition">+        &#123;########彩色标签云##########&#125;</span></span><br><span class="line"><span class="addition">+        &#123;% include 'tag-color.swig' %&#125;</span></span><br><span class="line"></span><br><span class="line">        &#123;% elif page.type <span class="comment">=== 'categories' %&#125;</span></span><br><span class="line">          &lt;div class="category-all-page"&gt;</span><br></pre></td></tr></table></figure><h2 id="3-添加404页面"><a class="header-anchor" href="#3-添加404页面">¶</a>3. 添加404页面</h2><p>新建文件：<code>themes/next/source/404.html</code>，内容如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 浏览器标签图标，此处需要在themes/next/source/images中加入favicon.jpg图片 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"shortcut icon"</span> <span class="attr">href</span>=<span class="string">"/images/favicon.jpg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>404哟<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line">      body &#123;</span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#ececec</span>;</span></span><br><span class="line">        font-family: "Open Sans", sans-serif;</span><br><span class="line">        font-size: 14px;</span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>: <span class="selector-id">#3c3c3c</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">      <span class="selector-class">.demo</span> <span class="selector-tag">p</span><span class="selector-pseudo">:first-child</span> &#123;</span></span><br><span class="line">        text-align: center;</span><br><span class="line">        font-family: cursive;</span><br><span class="line">        font-size: 150px;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">        line-height: 100px;</span><br><span class="line">        letter-spacing: 5px;</span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">      <span class="selector-class">.demo</span> <span class="selector-tag">p</span><span class="selector-pseudo">:first-child</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line">        cursor: pointer;</span><br><span class="line"><span class="css">        <span class="selector-tag">text-shadow</span>: 0<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> 2<span class="selector-tag">px</span> <span class="selector-id">#686868</span>, 0<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#ddd</span>, 0<span class="selector-tag">px</span> 2<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#d6d6d6</span>,</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 3<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#ccc</span>, 0<span class="selector-tag">px</span> 4<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#c5c5c5</span>, 0<span class="selector-tag">px</span> 5<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#c1c1c1</span>,</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 6<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#bbb</span>, 0<span class="selector-tag">px</span> 7<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#777</span>,</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 8<span class="selector-tag">px</span> 3<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(100, 100, 100, 0<span class="selector-class">.4</span>),</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 9<span class="selector-tag">px</span> 5<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(100, 100, 100, 0<span class="selector-class">.1</span>),</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> 7<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(100, 100, 100, 0<span class="selector-class">.15</span>),</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 11<span class="selector-tag">px</span> 9<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(100, 100, 100, 0<span class="selector-class">.2</span>),</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 12<span class="selector-tag">px</span> 11<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(100, 100, 100, 0<span class="selector-class">.25</span>),</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 13<span class="selector-tag">px</span> 15<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(100, 100, 100, 0<span class="selector-class">.3</span>);</span></span><br><span class="line"><span class="css">        <span class="selector-tag">-webkit-transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.1s</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.1s</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">      <span class="selector-class">.demo</span> <span class="selector-tag">p</span><span class="selector-pseudo">:first-child</span> <span class="selector-tag">span</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">text-shadow</span>: 0<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> 2<span class="selector-tag">px</span> <span class="selector-id">#686868</span>, 0<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#fff</span>, 0<span class="selector-tag">px</span> 2<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#fff</span>,</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 3<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#fff</span>, 0<span class="selector-tag">px</span> 4<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#fff</span>, 0<span class="selector-tag">px</span> 5<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#fff</span>, 0<span class="selector-tag">px</span> 6<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#fff</span>,</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 7<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-id">#777</span>, 0<span class="selector-tag">px</span> 8<span class="selector-tag">px</span> 3<span class="selector-tag">px</span> <span class="selector-id">#fff</span>, 0<span class="selector-tag">px</span> 9<span class="selector-tag">px</span> 5<span class="selector-tag">px</span> <span class="selector-id">#fff</span>,</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> 7<span class="selector-tag">px</span> <span class="selector-id">#fff</span>, 0<span class="selector-tag">px</span> 11<span class="selector-tag">px</span> 9<span class="selector-tag">px</span> <span class="selector-id">#fff</span>, 0<span class="selector-tag">px</span> 12<span class="selector-tag">px</span> 11<span class="selector-tag">px</span> <span class="selector-id">#fff</span>,</span></span><br><span class="line"><span class="css">          0<span class="selector-tag">px</span> 13<span class="selector-tag">px</span> 15<span class="selector-tag">px</span> <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">-webkit-transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.1s</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.1s</span> <span class="selector-tag">linear</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">      <span class="selector-class">.demo</span> <span class="selector-tag">p</span><span class="selector-pseudo">:not(</span><span class="selector-pseudo">:first-child)</span> &#123;</span></span><br><span class="line">        text-align: center;</span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>: <span class="selector-id">#666</span>;</span></span><br><span class="line">        font-family: cursive;</span><br><span class="line">        font-size: 20px;</span><br><span class="line"><span class="css">        <span class="selector-tag">text-shadow</span>: 0 1<span class="selector-tag">px</span> 0 <span class="selector-id">#fff</span>;</span></span><br><span class="line">        letter-spacing: 1px;</span><br><span class="line">        line-height: 2em;</span><br><span class="line">        margin-top: -50px;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>4<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>4<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>该页面不存在(´･ω･`)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>部署服务器后，访问不存在的资源时即可打开 404 页面。</p><p>注意：不能通过本地 localhost 访问，要部署后通过自己域名来访问。</p></blockquote><h2 id="4-添加最近文章栏目"><a class="header-anchor" href="#4-添加最近文章栏目">¶</a>4. 添加最近文章栏目</h2><p>编辑 <code>myblog/themes/next/layout/_macro/sidebar.swig</code> 。找到 <code>theme.social</code>板块代码，在该板块最后的 <code>endif</code>后隔一行添加如下代码。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;# recent posts #&#125;</span><br><span class="line">&#123;% if theme.recent_posts %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"links-of-blogroll motion-element &#123;&#123; "</span><span class="attr">links-of-blogroll-</span>" + <span class="attr">theme.recent_posts_layout</span>  &#125;&#125;"&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"links-of-blogroll-title"</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- modify icon to fire by szw --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-history fa-&#123;&#123; theme.recent_posts_icon | lower &#125;&#125;"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      &#123;&#123; theme.recent_posts_title &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"links-of-blogroll-list"</span>&gt;</span></span><br><span class="line">      &#123;% set posts = site.posts.sort('-date') %&#125;</span><br><span class="line">      &#123;% for post in posts.slice('0', '5') %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"recent_posts_li"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;"</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; post.title &#125;&#125;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>&#123;&#123; post.title &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>再编辑 <code>myblog/themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl</code></p><p>在文件最后添加如下样式代码</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">li</span><span class="selector-class">.recent_posts_li</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: left;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">word-break</span>: keep-all;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编辑主题配置文件 <code>myblog/themes/next/_config.yml</code>,添加如下代码：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">recent_posts_title:</span> <span class="string">近期文章</span></span><br><span class="line"><span class="attr">recent_posts_layout:</span> <span class="string">block</span></span><br><span class="line"><span class="attr">recent_posts:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="5-自定义友情链接页面"><a class="header-anchor" href="#5-自定义友情链接页面">¶</a>5. 自定义友情链接页面</h2><h3 id="方案1-纯静态文件"><a class="header-anchor" href="#方案1-纯静态文件">¶</a>方案1 纯静态文件</h3><p>创建 <code>myblog/source/links-falls/index.md</code></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 友情链接</span><br><span class="line">date: 2020-02-18 22:32:49</span><br><span class="line">no_toc: true</span><br><span class="line">comments: true</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- more --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="code">    &lt;meta charset="UTF-8"&gt;</span></span><br><span class="line"><span class="code">    &lt;link rel="stylesheet" href="/static/links-falls/link.css"&gt;</span></span><br><span class="line"><span class="code">    &lt;script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="code">    &lt;script src="/static/links-falls/link.js" type="text/javascript"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="code">    &lt;div&gt;</span></span><br><span class="line"><span class="code">        &lt;div class="links-content"&gt;</span></span><br><span class="line"><span class="code">            &lt;div class="link-navigation"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">        &lt;/div&gt;</span></span><br><span class="line"><span class="code">    &lt;/div&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align:center;"</span>&gt;</span></span></span><br><span class="line"><span class="code">	&lt;span class="with-love" id="animate1"&gt;&lt;i class="fa fa-heart"&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="code">	留言互换友链鸭</span></span><br><span class="line"><span class="code">	&lt;span class="with-love" id="animate2"&gt;&lt;i class="fa fa-heart"&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">&#123;% note success %&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">## 友链格式</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>昵称：example</span><br><span class="line"><span class="bullet">- </span>网站地址：https://example.com</span><br><span class="line"><span class="bullet">- </span>网站Logo：https://example.com/logo.jpg</span><br><span class="line"></span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>在 <code>myblog/source/static/</code>目录分别创建文件</p><p><code>linklist.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"nickname"</span>: <span class="string">"example1"</span>,</span><br><span class="line">    <span class="attr">"avatar"</span>: <span class="string">"https://example.com/logo.jpg"</span>,</span><br><span class="line">    <span class="attr">"site"</span>: <span class="string">"https://example.com"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"nickname"</span>: <span class="string">"example2"</span>,</span><br><span class="line">    <span class="attr">"avatar"</span>: <span class="string">"https://example.com/logo.jpg"</span>,</span><br><span class="line">    <span class="attr">"site"</span>: <span class="string">"https://example.com"</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><blockquote><p>添加友链的话，只要在这个json文件里添加数据即可。</p></blockquote><p><code>link.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  link = &#123;</span><br><span class="line">    init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> that = <span class="keyword">this</span>;</span><br><span class="line">      <span class="comment">/*加载 linklist.json 文件路径*/</span></span><br><span class="line">      $.getJSON(<span class="string">"/static/links-falls/linklist.json"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        that.render(data);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> html,</span><br><span class="line">        nickname,</span><br><span class="line">        avatar,</span><br><span class="line">        site,</span><br><span class="line">        li = <span class="string">""</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">        nickname = data[i].nickname;</span><br><span class="line">        avatar = data[i].avatar;</span><br><span class="line">        site = data[i].site;</span><br><span class="line">        <span class="comment">// 将数据拼接成html</span></span><br><span class="line">        li +=</span><br><span class="line">          <span class="string">'&lt;div class="card"&gt;'</span> </span><br><span class="line">              +<span class="string">'&lt;a href="'</span> +site +<span class="string">'" target="_blank"&gt;'</span> +<span class="string">'&lt;div class="thumb" style="background: url( '</span> + avatar +<span class="string">');"&gt;'</span> +<span class="string">"&lt;/div&gt;"</span> + <span class="string">"&lt;/a&gt;"</span> </span><br><span class="line">              +<span class="string">'&lt;div class="card-header"&gt;'</span> +<span class="string">'&lt;span class="card-site-nickname"&gt;&lt;a href="'</span> +site +<span class="string">'" target="_blank"&gt;'</span> +nickname +<span class="string">"&lt;/a&gt;&lt;/span&gt;"</span> +<span class="string">"&lt;/div&gt;"</span> +</span><br><span class="line">          <span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      $(<span class="string">".link-navigation"</span>).append(li);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  link.init();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>link.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.links-content</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.link-navigation</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">" "</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">transition-duration</span>: <span class="number">0.15s</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">6px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.12</span>);</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">6px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.12</span>), <span class="number">0</span> <span class="number">0</span> <span class="number">6px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.04</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.thumb</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.posts-expand</span> <span class="selector-class">.post-body</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.card-header</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1rem</span> <span class="number">0.25rem</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">white-space</span>: normal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.card-header</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">font-style</span>: normal;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#2bbc8a</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.card-header</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#d480aa</span>;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card-site-nickname</span> &#123;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap; <span class="comment">/*强制span不换行*/</span></span><br><span class="line">  <span class="attribute">display</span>: inline-block; <span class="comment">/*将span当做块级元素对待*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/*限制宽度*/</span></span><br><span class="line">  <span class="attribute">overflow</span>: hidden; <span class="comment">/*超出宽度部分隐藏*/</span></span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis; <span class="comment">/*超出部分以点号代替*/</span></span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">0.9</span>; <span class="comment">/*数字与之前的文字对齐*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card-site-nickname</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: visible; <span class="comment">/* 内容显示在元素框外面 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要在 <code>myblog/_config.yml</code>中添加如下配置，表示不进行渲染的目录或者文件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">skip_render:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">static/**</span></span><br></pre></td></tr></table></figure><p>最后修改主题配置文件 <code>themes/next/_config.xml</code>文件，把链接加入到菜单栏</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || home</span><br><span class="line">  categories: /categories/ || th</span><br><span class="line">  tags: /tags/ || tags</span><br><span class="line">  archives: /archives/ || archive</span><br><span class="line"><span class="addition">+ links: /links-falls/ || link</span></span><br><span class="line">  about: /about/ || user</span><br></pre></td></tr></table></figure><p>效果：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200220155325572.png" alt="image-20200220155325572"></p><h3 id="方案2-模板引擎swig"><a class="header-anchor" href="#方案2-模板引擎swig">¶</a>方案2 模板引擎swig</h3><p>新建 <code>themes/next/layout/links.swig</code>文件，并复制粘贴以下内容</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><span class="line">&#123;% block content %&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line">  &#123;### LINKS BLOCK ###&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"links"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">div</span><span class="selector-id">#links</span> &#123;</span></span><br><span class="line">                margin-top: 20px;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.card</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="comment">/* 两列 */</span></span></span><br><span class="line">                /* width: 35%;</span><br><span class="line">                padding: 10px 20px; */</span><br><span class="line"></span><br><span class="line"><span class="css">                <span class="comment">/* 三列 */</span></span></span><br><span class="line">                width: 30%;</span><br><span class="line">                padding: 10px 11px;</span><br><span class="line">                margin: auto 6px;</span><br><span class="line"></span><br><span class="line"><span class="css">                <span class="comment">/* 四列 */</span></span></span><br><span class="line">                /* width: 20%;</span><br><span class="line">                padding: 10px 20px; */</span><br><span class="line"></span><br><span class="line">                font-size: 1rem;</span><br><span class="line">                border-radius: 4px;</span><br><span class="line"><span class="css">                <span class="selector-tag">transition-duration</span>: 0<span class="selector-class">.15s</span>;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">box-shadow</span>: 0<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> 3<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.12</span>);</span></span><br><span class="line">                margin-bottom: 1rem;</span><br><span class="line"><span class="css">                <span class="selector-tag">background</span>: <span class="selector-id">#f5f5f5</span>;</span></span><br><span class="line">                display: flex;</span><br><span class="line">                float: left;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">            <span class="comment">/* pc 缩放100% */</span></span></span><br><span class="line"><span class="css">            <span class="keyword">@media</span> (<span class="attribute">min-width:</span> <span class="number">1600px</span>) &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.card</span>&#123;</span></span><br><span class="line">                    width: 29%;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">            <span class="comment">/* pc 缩放125%*/</span></span></span><br><span class="line"><span class="css">            <span class="keyword">@media</span> (<span class="attribute">min-width:</span> <span class="number">1024px</span>) &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.main-inner</span> &#123;</span></span><br><span class="line">                    width: 1024px;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="css">                <span class="selector-class">.links-content</span> &#123;</span></span><br><span class="line">                    margin-top: 1rem;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="css">                <span class="selector-class">.link-navigation</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line">                    content: " ";</span><br><span class="line">                    display: block;</span><br><span class="line">                    clear: both;</span><br><span class="line">                &#125;</span><br><span class="line">                /* .card:nth-child(odd) &#123;</span><br><span class="line">                    float: left;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="css">                <span class="selector-class">.card</span><span class="selector-pseudo">:nth-child(even)</span> &#123;</span></span><br><span class="line">                    float: right;</span><br><span class="line">                &#125; */</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">            <span class="comment">/* ipad pro */</span></span></span><br><span class="line"><span class="css">            <span class="keyword">@media</span> (<span class="attribute">max-width:</span> <span class="number">1024px</span>) &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.card</span> &#123;</span></span><br><span class="line">                    width: 30%;</span><br><span class="line">                    padding: 10px 11px;</span><br><span class="line">                    margin: 0 6px 1rem 6px;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="keyword">@media</span> (<span class="attribute">max-width:</span> <span class="number">1023px</span>) &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.main-inner</span> &#123;</span></span><br><span class="line">                    width: unset;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="css">                <span class="selector-class">.card</span> &#123;</span></span><br><span class="line">                    margin-left: 5rem;</span><br><span class="line">                    width: 85%;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="css">                <span class="selector-class">.links-content</span> &#123;</span></span><br><span class="line">                    width: unset;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="css">                <span class="selector-class">.card</span><span class="selector-pseudo">:nth-child(odd)</span> &#123;</span></span><br><span class="line">                    float: none;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="css">                <span class="selector-class">.card</span><span class="selector-pseudo">:nth-child(even)</span> &#123;</span></span><br><span class="line">                    float: none;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">            <span class="comment">/* ipad */</span></span></span><br><span class="line"><span class="css">            <span class="keyword">@media</span> (<span class="attribute">max-width:</span> <span class="number">768px</span>) &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.card</span> &#123;</span></span><br><span class="line">                    margin-left: 4rem;</span><br><span class="line">                    width: 80%;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">            <span class="comment">/* iphone7/7 plus */</span></span></span><br><span class="line"><span class="css">            <span class="keyword">@media</span> (<span class="attribute">max-width:</span> <span class="number">767px</span>) &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.card</span> &#123;</span></span><br><span class="line">                    margin-left: 2rem;</span><br><span class="line">                    width: 76%;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">            <span class="comment">/* iphone 5/se */</span></span></span><br><span class="line"><span class="css">            <span class="keyword">@media</span> (<span class="attribute">max-width:</span> <span class="number">320px</span>) &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.card</span> &#123;</span></span><br><span class="line">                    margin-left: 1rem;</span><br><span class="line">                    width: 82%;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">            <span class="selector-class">.card</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="comment">/* transform: scale(1.1); */</span></span></span><br><span class="line"><span class="css">                <span class="selector-tag">box-shadow</span>: 0 2<span class="selector-tag">px</span> 6<span class="selector-tag">px</span> 0 <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.12</span>), 0 0 6<span class="selector-tag">px</span> 0 <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.04</span>);</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.card</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">                border: none;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.card</span> <span class="selector-class">.ava</span> &#123;</span></span><br><span class="line">                width: 3rem !important;</span><br><span class="line">                height: 3rem !important;</span><br><span class="line">                margin: 0 !important;</span><br><span class="line">                margin-right: 1em !important;</span><br><span class="line">                border-radius: 50%;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.card</span> <span class="selector-class">.card-header</span> &#123;</span></span><br><span class="line">                font-style: italic;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                width: 100%;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.card</span> <span class="selector-class">.card-header</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line">                font-style: normal;</span><br><span class="line">                font-weight: bold;</span><br><span class="line">                text-decoration: none;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.card</span> <span class="selector-class">.card-header</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">color</span>: <span class="selector-id">#222</span>;</span></span><br><span class="line">                text-decoration: none;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.card</span> <span class="selector-class">.card-header</span> <span class="selector-class">.info</span> &#123;</span></span><br><span class="line">                font-style: normal;</span><br><span class="line"><span class="css">                <span class="selector-tag">color</span>: <span class="selector-id">#a3a3a3</span>;</span></span><br><span class="line">                font-size: 12px;</span><br><span class="line">                min-width: 0;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                white-space: nowrap;</span><br><span class="line">                text-overflow: ellipsis;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-tag">span</span><span class="selector-class">.focus-links</span> &#123;</span></span><br><span class="line">                font-style: normal;</span><br><span class="line">                margin-left: 10px;</span><br><span class="line">                position: unset;</span><br><span class="line">                left: 0;</span><br><span class="line">                padding: 0 7px 0 5px;</span><br><span class="line">                font-size: 11px;</span><br><span class="line">                border-radius: 40px;</span><br><span class="line">                line-height: 24px;</span><br><span class="line">                height: 22px;</span><br><span class="line"><span class="css">                <span class="selector-tag">color</span>: <span class="selector-id">#fff</span> !<span class="selector-tag">important</span>;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">background-color</span>: <span class="selector-id">#555</span>;</span></span><br><span class="line">                display: inline-block;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-tag">span</span><span class="selector-class">.focus-links</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">background-color</span>: <span class="selector-id">#222</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.friends-btn</span> &#123;</span></span><br><span class="line">                text-align: center;</span><br><span class="line"><span class="css">                <span class="selector-tag">color</span>: <span class="selector-id">#555</span> !<span class="selector-tag">important</span>;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">                border-radius: 3px;</span><br><span class="line">                font-size: 15px;</span><br><span class="line"><span class="css">                <span class="selector-tag">box-shadow</span>: <span class="selector-tag">inset</span> 0 0 10<span class="selector-tag">px</span> 0 <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.35</span>);</span></span><br><span class="line">                border: none !important;</span><br><span class="line">                transition-property: unset;</span><br><span class="line">                padding: 0 15px;</span><br><span class="line">                margin: inherit;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.friends-btn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line">                color: rgb(255, 255, 255) !important;</span><br><span class="line">                border-radius: 3px;</span><br><span class="line">                font-size: 15px;</span><br><span class="line"><span class="css">                <span class="selector-tag">box-shadow</span>: <span class="selector-tag">inset</span> 0<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> 0<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.35</span>);</span></span><br><span class="line">                background-image: linear-gradient(</span><br><span class="line">                    90deg,</span><br><span class="line"><span class="css">                    <span class="selector-id">#a166ab</span> 0%,</span></span><br><span class="line"><span class="css">                    <span class="selector-id">#ef4e7b</span> 25%,</span></span><br><span class="line"><span class="css">                    <span class="selector-id">#f37055</span> 50%,</span></span><br><span class="line"><span class="css">                    <span class="selector-id">#ef4e7b</span> 75%,</span></span><br><span class="line"><span class="css">                    <span class="selector-id">#a166ab</span> 100%</span></span><br><span class="line">                );</span><br><span class="line">                margin: inherit;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"links-content"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"link-navigation"</span>&gt;</span></span><br><span class="line">                &#123;% for link in theme.mylinks %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ava"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; link.avatar &#125;&#125;"</span> <span class="attr">style</span>=<span class="string">"border: none"</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; link.site &#125;&#125;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span> &#123;&#123; link.nickname &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; link.site &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"focus-links"</span>&gt;</span>关注<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info"</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; link.info &#125;&#125;"</span>&gt;</span>&#123;&#123; link.info &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                &#123;% endfor %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            &#123;&#123; page.content &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">  &#123;### END LINKS BLOCK ###&#125;</span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>然后修改 <code>themems/next/layout/page.swig</code>文件，根据上下文找到相关位置然后添加如下两处 <code>+</code>号相关的内容。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  &#123;% block title %&#125;&#123;#</span><br><span class="line">  #&#125;&#123;% set page_title_suffix = ' | ' + config.title %&#125;&#123;#</span><br><span class="line"></span><br><span class="line">  #&#125;&#123;% if page.type <span class="comment">=== "categories" and not page.title %&#125;&#123;#</span></span><br><span class="line">    #&#125;&#123;&#123; __('title.category') + page_title_suffix &#125;&#125;&#123;#</span><br><span class="line">  #&#125;&#123;% elif page.type <span class="comment">=== "tags" and not page.title %&#125;&#123;#</span></span><br><span class="line">    #&#125;&#123;&#123; __('title.tag') + page_title_suffix &#125;&#125;&#123;#</span><br><span class="line"><span class="addition">+ &lt;!-- 友情链接--&gt;</span></span><br><span class="line"><span class="addition">+ #&#125;&#123;% elif page.type === 'links' and not page.title %&#125;&#123;#</span></span><br><span class="line"><span class="addition">+   #&#125;&#123;&#123; __('title.links') + page_title_suffix &#125;&#125;&#123;#</span></span><br><span class="line">  #&#125;&#123;% else %&#125;&#123;#</span><br><span class="line">    #&#125;&#123;&#123; page.title + page_title_suffix &#125;&#125;&#123;#</span><br><span class="line">  #&#125;&#123;% endif %&#125;&#123;#</span><br><span class="line">#&#125;&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">    &#123;% elif page.type <span class="comment">=== 'categories' %&#125;</span></span><br><span class="line">      &lt;div class="category-all-page"&gt;</span><br><span class="line">        &lt;div class="category-all-title"&gt;</span><br><span class="line">            &#123;&#123; _p('counter.categories', site.categories.length) &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="category-all"&gt;</span><br><span class="line">          &#123;&#123; list_categories() &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"><span class="addition">+	&lt;!-- 友情链接--&gt;</span></span><br><span class="line"><span class="addition">+   &#123;% elif page.type === 'links' %&#125;</span></span><br><span class="line"><span class="addition">+   	&#123;% include 'links.swig' %&#125;</span></span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">      &#123;&#123; page.content &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &lt;/div&gt;</span><br></pre></td></tr></table></figure><p>新建 <code>hexo/source/links/index.md</code>友链文件，在标题头中写入 <code>type = &quot;links&quot;</code> 这个属性头，如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 友情链接</span><br><span class="line">date: 2018-10-05 22:39:06</span><br><span class="line">no_toc: true</span><br><span class="line">comments: true</span><br><span class="line">type: "links"</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align:center;"</span>&gt;</span></span></span><br><span class="line"><span class="code">	&lt;span class="with-love" id="animate1"&gt;&lt;i class="fa fa-heart"&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="code">	留言互换友链鸭</span></span><br><span class="line"><span class="code">	&lt;span class="with-love" id="animate2"&gt;&lt;i class="fa fa-heart"&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">&#123;% note default %&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">### 友链格式</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>昵称：example</span><br><span class="line"><span class="bullet">- </span>链接：https://example.com</span><br><span class="line"><span class="bullet">- </span>头像：https://example.com/logo.jpg</span><br><span class="line"><span class="bullet">- </span>描述：Peace &amp; Love ! Learning to think independently !</span><br><span class="line"></span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>修改主题配置文件 <code>themes/next/_config.xml</code>文件，把链接加入到菜单栏</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || home</span><br><span class="line">  categories: /categories/ || th</span><br><span class="line">  tags: /tags/ || tags</span><br><span class="line">  archives: /archives/ || archive</span><br><span class="line"><span class="addition">+ links: /links/ || link</span></span><br><span class="line">  about: /about/ || user</span><br></pre></td></tr></table></figure><p>最后，添加友链的话，只要在主题配置文件 <code>themes/next/_config.xml</code>文件末尾添加相关友情信息即可：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 友情链接</span></span><br><span class="line"><span class="attr">mylinks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">nickname:</span> <span class="string">example1</span>     <span class="comment"># 昵称</span></span><br><span class="line">    <span class="attr">avatar:</span> <span class="string">https://example.com/logo.jpg</span>    <span class="comment"># 头像地址</span></span><br><span class="line">    <span class="attr">site:</span> <span class="string">https://example.com</span>  <span class="comment">#友链地址</span></span><br><span class="line">    <span class="attr">info:</span> <span class="string">Peace</span> <span class="string">&amp;</span> <span class="string">Love</span> <span class="string">!</span> <span class="string">Learning</span> <span class="string">to</span> <span class="string">think</span> <span class="string">independently</span> <span class="string">!</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">nickname:</span> <span class="string">example2</span></span><br><span class="line">    <span class="attr">avatar:</span> <span class="string">https://example.com/logo.jpg</span></span><br><span class="line">    <span class="attr">site:</span> <span class="string">https://example.com</span></span><br><span class="line">    <span class="attr">info:</span> <span class="string">Peace</span> <span class="string">&amp;</span> <span class="string">Love</span> <span class="string">!</span> <span class="string">Learning</span> <span class="string">to</span> <span class="string">think</span> <span class="string">independently</span> <span class="string">!</span></span><br></pre></td></tr></table></figure><p>效果：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200220162053521.png" alt="image-20200220162053521"></p><h2 id="6-优化和美化代码块"><a class="header-anchor" href="#6-优化和美化代码块">¶</a>6. 优化和美化代码块</h2><h3 id="6-1-添加代码块全选复制功能"><a class="header-anchor" href="#6-1-添加代码块全选复制功能">¶</a>6.1 添加代码块全选复制功能</h3><p>下载第三方插件：<a href="https://github.com/zenorocha/clipboard.js" target="_blank" rel="noopener">clipboard.js</a>, 或者<a href="https://raw.githubusercontent.com/zenorocha/clipboard.js/master/dist/clipboard.min.js" target="_blank" rel="noopener">直接下载</a> (右键另存为)。保存 <code>clipboard.min.js</code>文件到 <code>theme/next/source/js/src</code> 下。然后在 <code>theme/next/source/js/src</code> 目录下，创建 <code>clipboard-use.js</code>，添加内容如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*页面载入完成后，创建复制按钮*/</span></span><br><span class="line">!(<span class="function"><span class="keyword">function</span>(<span class="params">e, t, a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> initCopyCode = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> copyHtml =<span class="string">'&lt;button class="btn-copy" data-clipboard-snippet=""&gt;&lt;i class="fa fa-clipboard"&gt;&lt;/i&gt;&lt;/button&gt;'</span>;</span><br><span class="line">    $(<span class="string">".highlight .code pre"</span>).before(copyHtml);</span><br><span class="line">    <span class="keyword">var</span> clipboard = <span class="keyword">new</span> ClipboardJS(<span class="string">".btn-copy"</span>, &#123;</span><br><span class="line">      target: <span class="function"><span class="keyword">function</span>(<span class="params">trigger</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> trigger.nextElementSibling;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    clipboard.on(<span class="string">"success"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> button = e.trigger;</span><br><span class="line">      <span class="keyword">var</span> iElement = button.querySelector(<span class="string">"i"</span>);</span><br><span class="line">      iElement.className = <span class="string">"fa fa-check"</span>;</span><br><span class="line">      button.onmouseleave = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">        e.clearSelection();</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          iElement.className = <span class="string">"fa fa-clipboard"</span>;</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  initCopyCode();</span><br><span class="line">&#125;)(<span class="built_in">window</span>, <span class="built_in">document</span>);</span><br></pre></td></tr></table></figure><p>在 <code>theme/next/source/css/_custom/custom.styl</code> 样式中添加如下代码：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代码块复制按钮</span></span><br><span class="line">.highlight&#123;</span><br><span class="line">  <span class="comment">//方便copy代码按钮（btn-copy）的定位</span></span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: linear-gradient(<span class="number">#fcfcfc</span>,<span class="number">#eee</span>);</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#d5d5d5</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    -webkit-user-select: <span class="attribute">none</span>;</span><br><span class="line">    -moz-user-select: <span class="attribute">none</span>;</span><br><span class="line">    -ms-user-select: <span class="attribute">none</span>;</span><br><span class="line">    user-select: <span class="attribute">none</span>;</span><br><span class="line">    -webkit-appearance: <span class="attribute">none</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    -webkit-transition: opacity .3s ease-in-out;</span><br><span class="line">    -o-transition: opacity .3s ease-in-out;</span><br><span class="line">    transition: opacity .3s ease-in-out;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span>;</span><br><span class="line">    <span class="comment">//固定在代码块的右上角,父relative+子fixed==&gt;父relative+子absolute,这里可以根据自己的情况做调整fixed或者absolute</span></span><br><span class="line">    <span class="comment">//父relative+子fixed</span></span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="comment">//父relative+子absolute</span></span><br><span class="line">    <span class="comment">//position: absolute;</span></span><br><span class="line">    <span class="comment">//top: 5px;</span></span><br><span class="line">    <span class="attribute">right</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn-copy</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.highlight</span>:hover .btn-copy&#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 <code>themes/next/layout/_layout.swig</code> 文件中引用（<code>&lt;/body&gt;</code>）之前添加：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加代码块全选复制功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/js/src/clipboard.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/js/src/clipboard-use.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="6-2-添加mac代码面板"><a class="header-anchor" href="#6-2-添加mac代码面板">¶</a>6.2 添加mac代码面板</h3><p>创建 <code>themes/next/scripts/codeblock.js</code>文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> attributes = [</span><br><span class="line">  <span class="string">'autocomplete="off"'</span>,</span><br><span class="line">  <span class="string">'autocorrect="off"'</span>,</span><br><span class="line">  <span class="string">'autocapitalize="off"'</span>,</span><br><span class="line">  <span class="string">'spellcheck="false"'</span>,</span><br><span class="line">  <span class="string">'contenteditable="true"'</span></span><br><span class="line">]</span><br><span class="line"><span class="keyword">var</span> attributesStr = attributes.join(<span class="string">' '</span>)</span><br><span class="line">hexo.extend.filter.register(<span class="string">'after_post_render'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> patt = <span class="regexp">/&lt;figure class="highlight(\s?)([a-zA-Z]*)"&gt;.*?&lt;\/figure&gt;/</span>;</span><br><span class="line">  <span class="keyword">while</span> (patt.test(data.content)) &#123;</span><br><span class="line">    data.content = data.content.replace(patt, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> language = <span class="built_in">RegExp</span>.$<span class="number">2</span> || <span class="string">'plain'</span></span><br><span class="line">      <span class="keyword">var</span> lastMatch = <span class="built_in">RegExp</span>.lastMatch</span><br><span class="line">      lastMatch = lastMatch.replace(<span class="string">'&lt;figure class="highlight'</span>, <span class="string">'&lt;figure class="iseeu highlight'</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="string">'&lt;div class="highlight-wrap"'</span> + attributesStr + <span class="string">'data-rel="'</span> + language.toUpperCase() + <span class="string">'"&gt;'</span> + lastMatch + <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>创建 <code>themes/next/source/css/_custom/macPanel.styl</code>文件</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mac Panel效果代码块相关</span></span><br><span class="line"><span class="selector-class">.highlight-wrap</span>[data-rel] &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">30px</span> <span class="number">0px</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.4</span>);</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">35px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">25px</span>;</span><br><span class="line"></span><br><span class="line">  &amp;::before &#123;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">content</span>: attr(data-rel);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">38px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">38px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#21252b</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="comment">//font-family: 'Source Sans Pro', sans-serif;</span></span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">80px</span>;</span><br><span class="line">    <span class="attribute">text-indent</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;::after &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">' '</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    -webkit-<span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fc625d</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">13px</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: <span class="number">20px</span> <span class="number">0px</span> <span class="number">#fdbc40</span>, <span class="number">40px</span> <span class="number">0px</span> <span class="number">#35cd4b</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">20px</span> <span class="number">0px</span> <span class="number">#fdbc40</span>, <span class="number">40px</span> <span class="number">0px</span> <span class="number">#35cd4b</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.highlight</span>, pre &#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: unset;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">35px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改 <code>themes/next/source/css/_custom/custom.styl</code>，在最后追加如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@require <span class="string">"macPanel"</span></span><br></pre></td></tr></table></figure><h3 id="6-3-mac代码面板整合全选复制按钮"><a class="header-anchor" href="#6-3-mac代码面板整合全选复制按钮">¶</a>6.3 mac代码面板整合全选复制按钮</h3><p>为了实现这个整合，我可真是花了不少时间，问了很多其他博主，但都无果，后来发现最新版的next其实已经实现了这个整合的功能，但是很遗憾的是我博客的next还是比较旧的版本，没办法直接配置实现。索性我直接去下载了最新版的next进行研究，通过一番较劲后，我终于做出来了，下面奉上教程：</p><h4 id="调整说明"><a class="header-anchor" href="#调整说明">¶</a>调整说明</h4><p>如果是按照上文步骤一步一步实现下来的，那么为了实现整合，还得做以下调整。如果没有经过以上步骤，可以直接跳到第2点。</p><p>由于mac面板直接整合了代码全选复制按钮，所以可以把下面这些文件删除掉</p><blockquote><p>themes/next/source/js/src/clipboard-use.js</p><p>themes/next/source/css/_custom/macPanel.styl</p><p>themes/next/scripts/codeblock.js</p></blockquote><p>此外还要做一些修改，删除掉以下文件的相关代码：</p><p>文件1：<code>themes/next/layout/_layout.swig</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加代码块全选复制功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/js/src/clipboard.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/js/src/clipboard-use.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>文件2：<code>themes/next/source/css/_custom/custom.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代码块复制按钮</span></span><br><span class="line">.highlight&#123;</span><br><span class="line">  <span class="comment">//方便copy代码按钮（btn-copy）的定位</span></span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: linear-gradient(<span class="number">#fcfcfc</span>,<span class="number">#eee</span>);</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#d5d5d5</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    -webkit-user-select: <span class="attribute">none</span>;</span><br><span class="line">    -moz-user-select: <span class="attribute">none</span>;</span><br><span class="line">    -ms-user-select: <span class="attribute">none</span>;</span><br><span class="line">    user-select: <span class="attribute">none</span>;</span><br><span class="line">    -webkit-appearance: <span class="attribute">none</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    -webkit-transition: opacity .3s ease-in-out;</span><br><span class="line">    -o-transition: opacity .3s ease-in-out;</span><br><span class="line">    transition: opacity .3s ease-in-out;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span>;</span><br><span class="line">    <span class="comment">//固定在代码块的右上角,父relative+子fixed==&gt;父relative+子absolute,这里可以根据自己的情况做调整fixed或者absolute</span></span><br><span class="line">    <span class="comment">//父relative+子fixed</span></span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="comment">//父relative+子absolute</span></span><br><span class="line">    <span class="comment">//position: absolute;</span></span><br><span class="line">    <span class="comment">//top: 5px;</span></span><br><span class="line">    <span class="attribute">right</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn-copy</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.highlight</span>:hover .btn-copy&#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@require <span class="string">"macPanel"</span></span><br></pre></td></tr></table></figure><h4 id="整合步骤"><a class="header-anchor" href="#整合步骤">¶</a>整合步骤</h4><p>新增整合的js逻辑代码：<code>themes/next/source/js/src/highlight-wrap.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author <span class="variable">qcmoke</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>"mac面板"和"代码全选复制"</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Dependencies </span>https://github.com/zenorocha/clipboard.js</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version </span>2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initMacPanel</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> highlights = $(<span class="string">".highlight"</span>).not(<span class="string">".gist .highlight"</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; highlights.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> figure = $(highlights[i]);</span><br><span class="line">    <span class="keyword">var</span> css = figure.attr(<span class="string">"class"</span>);</span><br><span class="line">    <span class="keyword">var</span> patt = <span class="regexp">/highlight(\s?)([a-zA-Z]*)/</span>;</span><br><span class="line">    patt.test(css);</span><br><span class="line">    <span class="comment">//得到第二个小括号的内容，如果为空，则设置为plain</span></span><br><span class="line">    <span class="keyword">var</span> language = <span class="built_in">RegExp</span>.$<span class="number">2</span> || <span class="string">"plain"</span>;</span><br><span class="line">    <span class="keyword">var</span> newDiv = $(<span class="string">"&lt;div&gt;"</span>)</span><br><span class="line">      .attr(<span class="string">"data-rel"</span>, language.toUpperCase())</span><br><span class="line">      .addClass(<span class="string">"highlight-wrap"</span>);</span><br><span class="line">    <span class="keyword">var</span> wrap = figure.wrap(newDiv);</span><br><span class="line">    wrap.before(</span><br><span class="line">      <span class="string">'&lt;button class="copy-btn" data-clipboard-snippet=""&gt;&lt;i class="fa fa-clipboard"&gt;&lt;/i&gt;&lt;/button&gt;'</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initClipboard</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> clipboard = <span class="keyword">new</span> ClipboardJS(<span class="string">".copy-btn"</span>, &#123;</span><br><span class="line">    target: <span class="function"><span class="keyword">function</span>(<span class="params">trigger</span>) </span>&#123;</span><br><span class="line">      <span class="comment">//return trigger.nextElementSibling;//返回复制按钮下一个列表选项的 HTML 内容</span></span><br><span class="line">      <span class="comment">///返回复制按钮所在dom下含有class为code的第一个dom对象(可以防止复制figcaption的内容)</span></span><br><span class="line">      <span class="keyword">var</span> wrap = trigger.parentElement;</span><br><span class="line">      <span class="keyword">var</span> code = wrap.querySelector(<span class="string">".code"</span>);</span><br><span class="line">      <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  clipboard.on(<span class="string">"success"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> button = e.trigger;</span><br><span class="line">    <span class="keyword">var</span> iElement = button.querySelector(<span class="string">"i"</span>);</span><br><span class="line">    iElement.className = <span class="string">"fa fa-check"</span>;</span><br><span class="line">    button.onmouseleave = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">      e.clearSelection();</span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        iElement.className = <span class="string">"fa fa-clipboard"</span>;</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  initMacPanel();</span><br><span class="line">  initClipboard();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>修改页面模板引擎文件：<code>themes/next/layout/_scripts/pages/post-details.swig</code>，在最后追加如下代码以引入第三方插件依赖 <code>clipboard.min.js</code>和以上的 <code>highlight-wrap.js</code>。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 代码块包裹面板=mac面板+代码块全选复制按钮 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for(theme.js) &#125;&#125;/src/clipboard.min.js?v=&#123;&#123; theme.version &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for(theme.js) &#125;&#125;/src/highlight-wrap.js?v=&#123;&#123; theme.version &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>第三方插件：<a href="https://github.com/zenorocha/clipboard.js" target="_blank" rel="noopener">clipboard.js</a>, 或者<a href="https://raw.githubusercontent.com/zenorocha/clipboard.js/master/dist/clipboard.min.js" target="_blank" rel="noopener">直接下载</a> (右键另存为)。如果之前没有下载clipboard.min.js，那么需要下载并保存 <code>clipboard.min.js</code>文件到 <code>theme/next/source/js/src</code> 下</p></blockquote><p>新增整合的自定义样式文件：<code>themes/next/source/css/_custom/highlight-wrap.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @author qcmoke</span></span><br><span class="line"><span class="comment"> * @description "mac面板"和"代码全选复制"样式</span></span><br><span class="line"><span class="comment"> * @version 2.0</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * tips: 修改hexo next主题配置文件，设置代码高亮highlight_theme为night eighties</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.highlight-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.highlight-wrap</span>:hover <span class="selector-class">.copy-btn</span>, <span class="selector-class">.highlight-wrap</span> <span class="selector-class">.copy-btn</span>:focus &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.copy-btn</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  <span class="attribute">background</span>: inherit;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#dfe2e5</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  transition: opacity .3s ease-in-out;</span><br><span class="line">  user-select: <span class="attribute">none</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.highlight-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1.6em</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#21252b</span>;</span><br><span class="line">  box-shadow: 0 10px 30px 0 rgba(0, 0, 0, .4);</span><br><span class="line"></span><br><span class="line">  &amp;::before &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">80px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">content</span>: attr(data-rel);</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.highlight</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> !important;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="number">5px</span>;</span><br><span class="line"></span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">margin-top</span>: -<span class="number">20px</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#fc625d</span>;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">20px</span> <span class="number">0</span> <span class="number">#fdbc40</span>, <span class="number">40px</span> <span class="number">0</span> <span class="number">#35cd4b</span>;</span><br><span class="line">      <span class="attribute">content</span>: <span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 代码选中时的样式</span></span><br><span class="line">    ::selection &#123;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#2593a6</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 代码块标题栏</span></span><br><span class="line">    <span class="selector-tag">figcaption</span> &#123;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">      padding: 0 .5em .35em;</span><br><span class="line">      <span class="attribute">padding-right</span>: <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="number">27px</span>;</span><br><span class="line">      <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#111</span>;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#21252b</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">      <span class="attribute">font-style</span>: italic;</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">1em</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">a</span> &#123;</span><br><span class="line">        <span class="attribute">float</span>: right;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#2770c3</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">a</span>:hover &#123;</span><br><span class="line">        <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#d9534f</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#d9534f</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 防止调试代码块内边框出现白线的问题</span></span><br><span class="line">    table&gt;tbody&gt;<span class="selector-tag">tr</span>:nth-of-type(odd) &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: unset;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.code</span> &#123;</span><br><span class="line">      +mobile() &#123;</span><br><span class="line">        <span class="comment">//background: #2593a6;</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 操作系统设置缩放比例比较大的时候适当调整代码字体变大</span></span><br><span class="line">    @media (<span class="attribute">min-width</span>: <span class="number">1600px</span>) &#123;</span><br><span class="line">      pre &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改主题自定义样式文件：<code>themes/next/source/css/_custom/custom.styl</code>，在最后追加如下代码以引入整合的样式：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@require <span class="string">"highlight-wrap"</span></span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂温馨提示：</p><p>custom.styl中最好不要出现其他与高亮有关的样式，如果存在的话可能会与上面的样式冲突。如果发现最终效果不理想，可以尝试在custom.styl中注释掉冲突的css代码。</p><p>建议修改hexo next主题配置文件，设置代码高亮 <code>highlight_theme</code>为 <code>night eighties</code>，这样效果会更好。</p></blockquote><p>效果：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200223011734366.png" alt="image-20200223011734366"></p><h2 id="7-添加暗黑模式支持"><a class="header-anchor" href="#7-添加暗黑模式支持">¶</a>7. 添加暗黑模式支持</h2><p>编辑 <code>themes/next/layout/_scripts/vendors.swig</code>文件，在最文件底部加入如下代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 暗黑模式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">id</span>=<span class="string">"darkmode"</span> <span class="attr">class</span>=<span class="string">"fa fa-lightbulb-o"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="comment">// 依次判断 系统暗黑模式  缓存 dark</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> body = $(<span class="string">"body"</span>)</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> darkmode = $(<span class="string">"#darkmode"</span>)</span></span><br><span class="line"><span class="actionscript"><span class="keyword">if</span> (matchMedia(<span class="string">"(prefers-color-scheme: dark)"</span>).matches ||localStorage.getItem(<span class="string">"darkmode"</span>) === <span class="string">"1"</span>) &#123;</span></span><br><span class="line"><span class="actionscript">	<span class="keyword">if</span> (!(localStorage.getItem(<span class="string">"noDark"</span>) === <span class="string">"1"</span>)) &#123;</span></span><br><span class="line"><span class="actionscript">		body.addClass(<span class="string">"dark"</span>)</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="actionscript">body.hasClass(<span class="string">"dark"</span>)?darkmode.removeClass(<span class="string">"fa-moon-o"</span>).addClass(<span class="string">"fa-lightbulb-o"</span>):darkmode.removeClass(<span class="string">"fa-lightbulb-o"</span>).addClass(<span class="string">"fa-moon-o"</span>)</span></span><br><span class="line"><span class="actionscript">darkmode.click(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">	<span class="keyword">if</span> (body.hasClass(<span class="string">"dark"</span>)) &#123;</span></span><br><span class="line"><span class="actionscript">	darkmode.removeClass(<span class="string">"fa-lightbulb-o"</span>).addClass(<span class="string">"fa-moon-o"</span>)</span></span><br><span class="line"><span class="actionscript">	body.removeClass(<span class="string">"dark"</span>)</span></span><br><span class="line"><span class="actionscript">	localStorage.setItem(<span class="string">"darkmode"</span>, <span class="string">"0"</span>)</span></span><br><span class="line"><span class="actionscript">		localStorage.setItem(<span class="string">"noDark"</span>, <span class="string">"1"</span>)</span></span><br><span class="line"><span class="actionscript">	&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">		darkmode.removeClass(<span class="string">"fa-moon-o"</span>).addClass(<span class="string">"fa-lightbulb-o"</span>)</span></span><br><span class="line"><span class="actionscript">		body.addClass(<span class="string">"dark"</span>)</span></span><br><span class="line"><span class="actionscript">		localStorage.setItem(<span class="string">"darkmode"</span>, <span class="string">"1"</span>)</span></span><br><span class="line"><span class="actionscript">		localStorage.setItem(<span class="string">"noDark"</span>, <span class="string">"0"</span>)</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>创建 <code>themes/next/source/css/_custom/dark.styl</code>，内容如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 黑暗切换模式按钮 */</span></span><br><span class="line"><span class="selector-id">#darkmode</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1050</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">33px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">91px</span>;</span><br><span class="line">  <span class="attribute">left</span>: unset;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1rem</span>;</span><br><span class="line"></span><br><span class="line">  @media (<span class="attribute">max-width</span>: <span class="number">960px</span>) &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">110px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 平滑改变背景色 */</span></span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">transition</span>: background-color <span class="number">1000ms</span>; <span class="comment">// transition: color 500ms, background-color 1000ms;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 下面是暗黑模式下的个性化定制样式 */</span></span><br><span class="line">:root &#123;</span><br><span class="line">  --dark-<span class="attribute">background-color</span>: <span class="number">#222</span>;</span><br><span class="line">  --dark-post-<span class="attribute">background-color</span>: <span class="number">#292a2d</span>;</span><br><span class="line">  --dark-<span class="attribute">color</span>: <span class="number">#a9a9b3</span>;</span><br><span class="line">  --dark-a-hover-<span class="attribute">color</span>: <span class="number">#6190e8</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.dark</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: var(--dark-background-color);</span><br><span class="line">  <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line"></span><br><span class="line">  ::selection &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f4e1c0</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#101012</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 在深色模式下把图片亮度调到 70% */</span></span><br><span class="line">  <span class="selector-tag">img</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">filter</span>: brightness(<span class="number">0.7</span>) !important;</span><br><span class="line">    <span class="attribute">filter</span>: brightness(<span class="number">0.7</span>) !important;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line"></span><br><span class="line">    :hover &#123;</span><br><span class="line">      <span class="attribute">color</span>: var(--dark-a-hover-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="selector-class">.menu</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#565555</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.menu-item</span> &#123;</span><br><span class="line">        <span class="selector-tag">a</span> &#123;</span><br><span class="line">          <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line"></span><br><span class="line">          :hover &#123;</span><br><span class="line">            <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: var(--dark-background-color);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.main-inner</span> <span class="selector-class">.post</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span> <span class="number">#555</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.archive</span> &#123;</span><br><span class="line">      <span class="attribute">box-shadow</span>: unset;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 代码行 */</span></span><br><span class="line">    <span class="selector-tag">code</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#eee</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#555</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.posts-expand</span> &#123;</span><br><span class="line">    <span class="selector-class">.post-title-link</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    table&gt;tbody&gt;<span class="selector-tag">tr</span>:nth-of-type(odd) &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#202225</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.highlight-wrap</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#1d1d1d</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.copy-btn</span> &#123;</span><br><span class="line">      <span class="attribute">border</span>: unset;</span><br><span class="line">      <span class="attribute">background-color</span>: unset;</span><br><span class="line">      <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    table&gt;tbody&gt;<span class="selector-tag">tr</span>:nth-of-type(odd) &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: unset;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">blockquote</span> &#123;</span><br><span class="line">    <span class="attribute">border-left-color</span>: <span class="number">#666</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#929191</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.posts-expand</span> <span class="selector-class">.post-body</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: unset;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* mac代码面板 */</span></span><br><span class="line">  <span class="selector-class">.highlight-wrap</span> &#123;</span><br><span class="line">    <span class="selector-class">.highlight</span> <span class="selector-class">.gutter</span> pre &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: unset;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.highlight</span> <span class="selector-class">.code</span> pre &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: unset;</span><br><span class="line">      <span class="attribute">border-left-color</span>: <span class="number">#333</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.highlight</span>,</span><br><span class="line">    pre &#123;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#202225</span>;</span><br><span class="line">      <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.highlight-wrap</span>::before &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 分页 */</span></span><br><span class="line">  <span class="selector-class">.pagination</span> &#123;</span><br><span class="line">    <span class="selector-class">.page-number</span><span class="selector-class">.current</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#ccc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.pagination</span> <span class="selector-class">.next</span>,</span><br><span class="line">  <span class="selector-class">.pagination</span> <span class="selector-class">.page-number</span>,</span><br><span class="line">  <span class="selector-class">.pagination</span> <span class="selector-class">.prev</span> &#123;</span><br><span class="line">    <span class="attribute">border-top-color</span>: <span class="number">#333</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 文章底部 */</span></span><br><span class="line">  <span class="selector-class">.post-footer</span> &#123;</span><br><span class="line">    <span class="selector-class">.post-widgets</span> &#123;</span><br><span class="line">      <span class="attribute">border-top-color</span>: <span class="number">#666</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-id">#needsharebutton-postbottom</span> <span class="selector-class">.btn</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: var(--dark-color);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-id">#needsharebutton-postbottom</span> <span class="selector-class">.btn</span>:hover &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post-nav</span> &#123;</span><br><span class="line">      <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#666</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.post-nav-item</span> <span class="selector-tag">a</span>:hover &#123;</span><br><span class="line">        <span class="attribute">color</span>: var(--dark-a-hover-color);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 评论面板 */</span></span><br><span class="line">  <span class="selector-class">.comments</span> &#123;</span><br><span class="line">    <span class="selector-class">.tablink</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#222</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.tablink</span>:hover &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#ddd</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.currentTabcontent</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#ddd</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.tabcontent-li</span> &#123;</span><br><span class="line">      <span class="attribute">border-color</span>: <span class="number">#757474</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/* gitalk */</span></span><br><span class="line">      <span class="selector-class">.gt-container</span> &#123;</span><br><span class="line">        <span class="selector-class">.gt-comment-body</span> &#123;</span><br><span class="line">          <span class="attribute">color</span>: var(--dark-color) !important;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.gt-meta</span> &#123;</span><br><span class="line">          <span class="attribute">border-bottom</span>: <span class="number">#333</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.gt-header-textarea</span> &#123;</span><br><span class="line">          <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.gt-comment-content</span> &#123;</span><br><span class="line">          <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.gt-comment-content</span>:hover &#123;</span><br><span class="line">          -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0.625em</span> <span class="number">3.75em</span> <span class="number">0</span> <span class="number">#f4f4f4</span>;</span><br><span class="line">          <span class="attribute">box-shadow</span>: <span class="number">1px</span> <span class="number">1px</span> <span class="number">1em</span> <span class="number">0</span> <span class="number">#222</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.gt-user</span> <span class="selector-class">.gt-ico</span> svg &#123;</span><br><span class="line">          fill: #ccc;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.gt-header-preview</span> &#123;</span><br><span class="line">          <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">          <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.valine</span> &#123;</span><br><span class="line">        * &#123;</span><br><span class="line">          <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">border-bottom</span>: <span class="number">#333</span>;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.vwrap</span> &#123;</span><br><span class="line">          <span class="attribute">border</span>: var(--dark-post-background-color);</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.textarea-wrapper</span> &#123;</span><br><span class="line">            <span class="attribute">background</span>: unset;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.textarea-wrapper</span> <span class="selector-class">.comment_trigger</span> &#123;</span><br><span class="line">            <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.textarea-wrapper</span> <span class="selector-tag">textarea</span> &#123;</span><br><span class="line">            <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">            <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.auth-section</span> <span class="selector-class">.input-wrapper</span> <span class="selector-tag">input</span> &#123;</span><br><span class="line">            <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">            <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.auth-section</span> &#123;</span><br><span class="line">            <span class="attribute">background-color</span>: var(--dark-post-background-color);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.auth-section</span> <span class="selector-class">.post-action</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">            <span class="attribute">border</span>: var(--dark-post-background-color);</span><br><span class="line">            <span class="attribute">background-color</span>: <span class="number">#202124</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.vlist</span> <span class="selector-class">.vcard</span> <span class="selector-class">.text-wrapper</span> <span class="selector-class">.vhead</span> <span class="selector-class">.vname</span> &#123;</span><br><span class="line">          <span class="attribute">color</span>: var(--dark-a-hover-color);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-toc</span> &#123;</span><br><span class="line">    <span class="selector-tag">a</span> &#123;</span><br><span class="line">      :hover &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.nav</span> .active-current&gt;<span class="selector-tag">a</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#87daff</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 本地搜索面板 */</span></span><br><span class="line">  <span class="selector-class">.local-search-popup</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#333</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 归档页 */</span></span><br><span class="line">  <span class="selector-class">.archive</span> &#123;</span><br><span class="line">    <span class="selector-class">.posts-collapse</span> <span class="selector-class">.post-title</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.posts-collapse</span>::after &#123;</span><br><span class="line">      <span class="attribute">background</span>: var(--dark-post-background-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*阅读排行榜*/</span></span><br><span class="line">  <span class="selector-id">#top</span> <span class="attribute">font</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: var(--dark-color);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 友情链接 */</span></span><br><span class="line">  <span class="selector-id">#links</span> &#123;</span><br><span class="line">    <span class="selector-class">.card</span> &#123;</span><br><span class="line">      <span class="selector-class">.card-header</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.card-header</span> <span class="selector-class">.info</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#60676d</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编辑 <code>themes/next/source/css/_custom/custom.styl</code>，在此文件中的最后引入 <code>dark.styl</code>样式文件</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@require 'dark';</span><br></pre></td></tr></table></figure><h2 id="8-魔改next主题"><a class="header-anchor" href="#8-魔改next主题">¶</a>8. 魔改next主题</h2><p>由于个人喜好，和为适配移动端，本博客从这里开始将修改next主题的布局为Muse。并在Muse的基础上做了比较大的样式调整，形成了目前博客现状的基本布局和样式。其中包括整体骨架布局、菜单栏、首页文章缩略卡片、文章页宽、移动端适配、字体大小等等诸多样式的调整。</p><p>先看魔改主题效果：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20200303022203833.png" alt="image-20200303022203833"></p><p>修改 <code>themes/next/_config.yml</code>启用 <code>Muset</code>:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="comment">#scheme: Gemini</span></span><br></pre></td></tr></table></figure><p>然后编辑 <code>themes/next/source/css/_custom/custom.styl</code>添加自定义样式：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 去掉链接下的下划线</span></span><br><span class="line">* a &#123;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: unset;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面顶部样式</span></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="comment">// 顶部背景</span></span><br><span class="line">    <span class="attribute">background-image</span>: linear-gradient(<span class="number">90deg</span>, <span class="number">#222325</span>, <span class="number">#3b3c3f</span>, <span class="number">#222325</span>);</span><br><span class="line"></span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">        <span class="attribute">background</span>: black;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 顶部宽度和距离</span></span><br><span class="line">    <span class="selector-class">.header-inner</span> &#123;</span><br><span class="line">        <span class="attribute">padding-top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">padding-bottom</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 博客title</span></span><br><span class="line">    <span class="selector-class">.custom-logo-site-title</span> <span class="selector-class">.brand</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: none;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.site-title</span> &#123;</span><br><span class="line">            <span class="attribute">letter-spacing</span>: <span class="number">0</span>;</span><br><span class="line">            <span class="attribute">font-weight</span>: bold;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">29px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 博客subtitle描述</span></span><br><span class="line">    <span class="selector-class">.site-subtitle</span> &#123;</span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="number">7px</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">        <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">        @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">            <span class="attribute">display</span>: block;</span><br><span class="line">            <span class="attribute">margin-top</span>: <span class="number">11px</span>;</span><br><span class="line">            <span class="attribute">padding-bottom</span>: <span class="number">2px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 顶部菜单栏</span></span><br><span class="line">    <span class="selector-class">.menu</span> &#123;</span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">1px</span>;</span><br><span class="line">        background-color: rgba(255, 255, 255, .75);</span><br><span class="line">        box-shadow: 0 10px 10px 0 rgba(0, 0, 0, .15);</span><br><span class="line">        <span class="attribute">text-align</span>: center;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 菜单超链接</span></span><br><span class="line">        <span class="selector-class">.menu-item</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">            <span class="attribute">padding-right</span>: <span class="number">20px</span>;</span><br><span class="line">            <span class="attribute">padding-left</span>: <span class="number">20px</span>;</span><br><span class="line">            <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">            <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line"></span><br><span class="line">            @media (<span class="attribute">min-width</span>: <span class="number">1600px</span>) &#123;</span><br><span class="line">                <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            :hover &#123;</span><br><span class="line">                <span class="attribute">color</span>: black;</span><br><span class="line">                <span class="attribute">font-weight</span>: bold;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 移动端下拉抽屉按钮横杠背景色</span></span><br><span class="line">    <span class="selector-class">.site-nav-toggle</span> <span class="selector-class">.btn-bar</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#f9f9f9</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 移动端下拉抽屉面板上边距</span></span><br><span class="line">    <span class="selector-class">.site-nav</span> &#123;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">62px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首页主体部分</span></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">    <span class="comment">// 首页文章缩略卡片宽度</span></span><br><span class="line">    section<span class="selector-id">#posts</span> &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">78%</span>;</span><br><span class="line"></span><br><span class="line">        @media (<span class="attribute">min-width</span>: <span class="number">1600px</span>) &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">83%</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">85%</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @media (<span class="attribute">max-width</span>: <span class="number">960px</span>) &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">85%</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 缩略图边缘样式</span></span><br><span class="line">        <span class="selector-class">.post-body</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">            <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">            <span class="attribute">border</span>: none;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 缩略图指定宽度值显示。</span></span><br><span class="line">    <span class="selector-tag">img</span><span class="selector-class">.img-topic</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">55%</span>;</span><br><span class="line"></span><br><span class="line">        @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 去除缩略卡片之间的分割线</span></span><br><span class="line">    <span class="selector-class">.posts-expand</span> <span class="selector-class">.post-eof</span> &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 页码</span></span><br><span class="line">    <span class="selector-class">.pagination</span> &#123;</span><br><span class="line">        <span class="comment">// 减小页码外边距</span></span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">50px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// 去除页面底部页码上面的横线</span></span><br><span class="line">        <span class="attribute">border</span>: none;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主体文章</span></span><br><span class="line"><span class="selector-class">.main-inner</span> &#123;</span><br><span class="line">    <span class="comment">// 文章宽度</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">960px</span>;</span><br><span class="line"></span><br><span class="line">    @media (<span class="attribute">min-width</span>: <span class="number">1600px</span>) &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">1080px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">960px</span>) &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">        <span class="attribute">width</span>: inherit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">        <span class="attribute">width</span>: inherit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post</span> &#123;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">45px</span> <span class="number">28px</span> <span class="number">36px</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: rgb(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">        box-shadow: 0 0 10px 0 rgba(0, 0, 0, .5);</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.code</span> &#123;</span><br><span class="line">            <span class="comment">//修复选择代码时光标跨越多行的问题</span></span><br><span class="line">            <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">            <span class="attribute">padding</span>: <span class="number">45px</span> <span class="number">12px</span> <span class="number">36px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.posts-expand</span> &#123;</span><br><span class="line">        <span class="comment">// 文章标题字体</span></span><br><span class="line">        <span class="selector-class">.post-title</span> &#123;</span><br><span class="line">            <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 文章元数据（meta）留白更改</span></span><br><span class="line">        <span class="selector-class">.post-meta</span> &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 文章的描述description</span></span><br><span class="line">        <span class="selector-class">.post-meta</span> <span class="selector-class">.post-description</span> &#123;</span><br><span class="line">            <span class="attribute">margin-top</span>: <span class="number">30px</span>;</span><br><span class="line">            <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">            <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">            <span class="attribute">font-style</span>: italic;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">            <span class="attribute">padding-top</span>: <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @media (<span class="attribute">max-width</span>: <span class="number">960px</span>) &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 摘要文字</span></span><br><span class="line">    <span class="selector-class">.index-content</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 文章内链接文本样式</span></span><br><span class="line">    <span class="selector-class">.post-body</span> <span class="selector-tag">p</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">        <span class="attribute">border-bottom</span>: none;</span><br><span class="line">        <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#0593d3</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line"></span><br><span class="line">        &amp;:hover &#123;</span><br><span class="line">            <span class="attribute">border-bottom</span>: none;</span><br><span class="line">            <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span><br><span class="line">            <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 文章底部</span></span><br><span class="line">    <span class="selector-class">.post-footer</span> &#123;</span><br><span class="line">        <span class="selector-class">.post-widgets</span> &#123;</span><br><span class="line">            <span class="attribute">padding-top</span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 当rating和needmoreshare2都开启时让它们居中竖着排</span></span><br><span class="line">            <span class="keyword">if</span> (hexo-config(<span class="string">'rating.enable'</span>) &amp;&amp; hexo-config(<span class="string">'needmoreshare2.enable'</span>)) &#123;</span><br><span class="line">                <span class="selector-id">#needsharebutton-postbottom</span> &#123;</span><br><span class="line">                    <span class="comment">// bottom: 25px;</span></span><br><span class="line">                    <span class="comment">// margin: auto 50%;</span></span><br><span class="line">                    <span class="comment">//修复分享按钮在火狐浏览器显示换行的问题</span></span><br><span class="line">                    <span class="attribute">bottom</span>: -<span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="selector-class">.wp_rating</span> &#123;</span><br><span class="line">                    <span class="attribute">position</span>: relative;</span><br><span class="line">                    <span class="attribute">top</span>: <span class="number">35px</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.post-nav</span> &#123;</span><br><span class="line">            <span class="attribute">margin-top</span>: <span class="number">30px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 侧栏抽屉</span></span><br><span class="line"><span class="selector-id">#sidebar</span> &#123;</span><br><span class="line">    <span class="comment">// 近期文章</span></span><br><span class="line">    <span class="selector-class">.sidebar-inner</span> <span class="selector-tag">li</span><span class="selector-class">.recent_posts_li</span> &#123;</span><br><span class="line">        <span class="attribute">text-align</span>: center;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">        <span class="selector-class">.site-overview</span> &#123;</span><br><span class="line">            <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line">            <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 侧方浮动抽屉按钮</span></span><br><span class="line"><span class="selector-class">.sidebar-toggle</span> &#123;</span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">58px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">opacity</span>: unset;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.sidebar-toggle-line</span> &#123;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">3px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回到顶部按钮</span></span><br><span class="line"><span class="selector-class">.back-to-top</span> &#123;</span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">960px</span>) &#123;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 博客页面最底部</span></span><br><span class="line"><span class="selector-class">.footer-inner</span> &#123;</span><br><span class="line">    <span class="comment">// 移动端footer字体变小，防止换行</span></span><br><span class="line">    @media (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">11px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分类页</span></span><br><span class="line"><span class="selector-class">.category-all-page</span> &#123;</span><br><span class="line">    <span class="selector-class">.category-list</span> &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">margin-left</span>: <span class="number">44%</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">list-style</span>: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span> &#123;</span><br><span class="line">        <span class="attribute">font-weight</span>: bold;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 归档页位置调整</span></span><br><span class="line"><span class="selector-class">.posts-collapse</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post-header</span>::before &#123;</span><br><span class="line">        <span class="attribute">left</span>: -<span class="number">4px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.collection-title</span> &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">50px</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post</span> &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">margin-left</span>: <span class="number">2px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">2px</span>;</span><br><span class="line">        <span class="attribute">box-shadow</span>: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post-header</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: relative;</span><br><span class="line">        <span class="attribute">border-bottom</span>: <span class="number">1px</span> dashed <span class="number">#ccc</span>;</span><br><span class="line">        <span class="attribute">transition-delay</span>: <span class="number">0s</span>;</span><br><span class="line">        <span class="attribute">transition-timing-function</span>: ease-in-out;</span><br><span class="line">        transition-duration: .2s;</span><br><span class="line">        <span class="attribute">transition-property</span>: border;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 热文页</span></span><br><span class="line"><span class="selector-id">#top</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入其他文件的样式</span></span><br><span class="line">@require 'scrollbar';</span><br><span class="line">@require 'comments';</span><br><span class="line">@require 'highlight-wrap';</span><br><span class="line">@require 'dark';</span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂下面的文件是 <code>custom.styl</code>依赖的样式文件：</p><p>（1）<code>scrollbar.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="comment">/**</span></span><br><span class="line"><span class="comment">&gt;* @author qcmoke</span></span><br><span class="line"><span class="comment">&gt;* 美化博客中浏览器的滚动条(只适用于webkit内核浏览器)</span></span><br><span class="line"><span class="comment">&gt;*/</span></span><br><span class="line">&gt;@media (<span class="attribute">min-width</span>: <span class="number">567px</span>) &#123;</span><br><span class="line">  <span class="comment">/* 定义滚动条高宽及背景高宽分别对应横竖滚动条的尺寸 */</span></span><br><span class="line">  ::-webkit-scrollbar &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">10px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#F5F5F5</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 定义滚动条轨道内阴影+圆角 */</span></span><br><span class="line">  ::-webkit-scrollbar-track &#123;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#F5F5F5</span>;</span><br><span class="line">      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, .3);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 定义滑块内阴影+圆角 */</span></span><br><span class="line">  ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#555</span>;</span><br><span class="line">      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, .3);</span><br><span class="line">  &#125;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure><p>（2）<code>comments.styl</code>的内容参考上文“整合多个评论面板”</p><p>（3）<code>highlight-wrap.styl</code> 的内容参考上文“优化和美化代码块”</p><p>（4）<code>dark.styl</code> 的内容参考上文“添加暗黑模式支持”</p></blockquote><h2 id="9-hexo支持本地markdown文件链接引用"><a class="header-anchor" href="#9-hexo支持本地markdown文件链接引用">¶</a>9. hexo支持本地Markdown文件链接引用</h2><blockquote><p>hexo 默认支持标准 markdown 语法引用链接格式（如：<code>[xxx](xxx.html)</code>）和 hexo 标签插件语法引用链接格式（如：<code></code>）。</p><p>引用本地文章可以通过使用以上两种引用链接格式语法来满足基本要求，但通常在编写 Markdown 文章时，Markdown 文件对应的 html 页面还没有编译出来，此时的引用链接是无效的，故而无法使用 Markdown 编辑器直接打开链接页面，但通过<code>[xxx](xxx.md)</code>的 Markdown 文件链接方式来直接引用 Markdown 文件时 Markdown 编辑器是可以打开链接页面的，然而使用<code>[xxx](xxx.md)</code>这种写法会导致 hexo 编译时无法渲染为 html 链接，为了解决这个问题，可以给 hexo 添加编译过滤器，让 hexo 编译时将<code>[xxx](xxx.md)</code> 修改为<code>[xxx](xxx.html)</code>。具体实现方式如下：</p></blockquote><p>创建并编辑：<code>themes/next/scripts/filters/hexo-md-link.js</code> 文件。内容如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> log = <span class="built_in">require</span>(<span class="string">"hexo-log"</span>)(&#123; <span class="attr">debug</span>: <span class="literal">false</span>, <span class="attr">slient</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"hexo-fs"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">const</span> base_dir = path.join(hexo.source_dir, <span class="string">"_posts"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fileList = fs</span><br><span class="line">  .listDirSync(base_dir, &#123;</span><br><span class="line">    ignorePattern: <span class="regexp">/node_modules/</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .filter(<span class="function">(<span class="params">each</span>) =&gt;</span> each &amp;&amp; <span class="regexp">/\.md$/</span>.test(each))</span><br><span class="line">  .map(<span class="function">(<span class="params">each</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> array = (each + <span class="string">""</span>).split(path.sep);</span><br><span class="line">    <span class="comment">// For Windows</span></span><br><span class="line">    <span class="keyword">if</span> (path.sep === <span class="string">"\\"</span>) &#123;</span><br><span class="line">      each = each.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"\\"</span> + path.sep, <span class="string">"g"</span>), <span class="string">"/"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      fileNameExt: array.length === <span class="number">0</span> ? <span class="string">""</span> : array[array.length - <span class="number">1</span>],</span><br><span class="line">      filePath: each,</span><br><span class="line">      articleName: each.replace(<span class="regexp">/\.md$/</span>, <span class="string">""</span>),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fixLink</span>(<span class="params">data, regEx, func</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; content &#125; = data;</span><br><span class="line">  <span class="keyword">let</span> result = content.match(regEx);</span><br><span class="line">  <span class="keyword">if</span> (result &amp;&amp; result.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// console.log("result");</span></span><br><span class="line">    result.forEach(<span class="function">(<span class="params">linkString</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> [filepath, showName] = func(linkString);</span><br><span class="line">      <span class="comment">//   console.log(&#123; linkString, filepath, showName &#125;);</span></span><br><span class="line">      <span class="keyword">let</span> anchor = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">if</span> (!filepath || filepath.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      filepath = filepath.trim();</span><br><span class="line">      <span class="keyword">let</span> htmlFilepath = filepath.replace(<span class="string">".md"</span>, <span class="string">".html"</span>);</span><br><span class="line">      fileName = filepath.split(<span class="string">"/"</span>).pop();</span><br><span class="line">      [fileName, anchor] = fileName.split(<span class="string">"#"</span>);</span><br><span class="line">      <span class="keyword">const</span> extName = <span class="string">".md"</span>;</span><br><span class="line">      <span class="keyword">let</span> realNameExt = fileName;</span><br><span class="line">      <span class="keyword">if</span> (!fileName.endsWith(extName)) &#123;</span><br><span class="line">        realNameExt = fileName + extName;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//console.log(&#123; realNameExt, filepath, showName &#125;);</span></span><br><span class="line">      <span class="keyword">let</span> file = fileList.find(<span class="function">(<span class="params">file</span>) =&gt;</span> file.fileNameExt === realNameExt);</span><br><span class="line">      <span class="keyword">if</span> (file) &#123;</span><br><span class="line">        <span class="comment">// console.log("file", file);</span></span><br><span class="line">        content = replaceAndIgnoreCode(</span><br><span class="line">          content,</span><br><span class="line">          linkString,</span><br><span class="line">          <span class="string">`&lt;a href="<span class="subst">$&#123;htmlFilepath&#125;</span>" name="<span class="subst">$&#123;filepath&#125;</span>" id="hexo-md-link"&gt;<span class="subst">$&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">            showName || filepath</span></span></span><br><span class="line"><span class="string"><span class="subst">          &#125;</span>&lt;/a&gt;`</span></span><br><span class="line">          <span class="comment">//   `&#123;% post_link $&#123;file.articleName&#125; '$&#123;showName || filepath&#125;' %&#125;`</span></span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  data.content = content;</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取字符串的 哈希值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHashCode</span>(<span class="params">str, caseSensitive</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!caseSensitive) &#123;</span><br><span class="line">    str = str.toLowerCase();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> hash = <span class="number">1315423911</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = str.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">let</span> ch = str.charCodeAt(i);</span><br><span class="line">    hash ^= (hash &lt;&lt; <span class="number">5</span>) + ch + (hash &gt;&gt; <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> hash &amp; <span class="number">0x7fffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 替换引用链接（排除代码块）</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">replaceAndIgnoreCode</span>(<span class="params">markdown, oldString, newString</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 匹配所有代码：`code`和代码块：```code</span></span><br></pre></td></tr></table></figure><p>let codeBlocksRegex = /<code>{1,3}[\s\S]*?</code>{1,3}/g;<br>let originalCodeStrArr = markdown.match(codeBlocksRegex);</p><p>// 在每个匹配项之间，使用占位符填充原始文本中的内容<br>const PLACEHOLDER_CODE =<br>“<strong>CODE_BLOCK_PLACEHOLDER</strong>” +<br>getHashCode(oldString) +<br>&quot;@&quot; +<br>new Date().getTime();<br>let placeholders = Array(originalCodeStrArr.length).fill(PLACEHOLDER_CODE);</p><p>//使用占位符替换所有代码块（先获取所有的代码块，然后使用占位符替换每个代码块）<br>let reconstructedMarkdown = markdown<br>.split(codeBlocksRegex)<br>.reduce((acc, cur, i) =&gt; acc.concat(cur, placeholders[i] || “”), [])<br>.join(&quot;&quot;);</p><p>// 替换字符串（排除代码块内的内容）<br>let newMarkdown = reconstructedMarkdown.replace(oldString, newString);</p><p>// 将占位符替换回代码块<br>let finalMarkdown = newMarkdown<br>.split(PLACEHOLDER_CODE)<br>.reduce(<br>(accumulator, currentValue, i) =&gt;<br>accumulator.concat(currentValue, originalCodeStrArr[i] || “”),<br>[]<br>) //将数组的所有元素按顺序依次执行指定的函数，并返回一个累积的结果<br>.join(&quot;&quot;)<br>.trim();</p><p>return finalMarkdown;<br>}</p><p>hexo.extend.filter.register(<br>“before_post_render”,<br>(data) =&gt; {<br>// 适配 <a href="xxx/xxxx.md">xxx</a> 格式markdown链接<br>fixLink(data, /[.<em>?](.</em>?.md.<em>?)/g, (linkString) =&gt; {<br>let filepath = “”;<br>let showName = “”;<br>let filepathMatches = linkString.match(/((.</em>?))/);<br>if (filepathMatches &amp;&amp; filepathMatches.length &gt; 1) {<br>filepath = filepathMatches[1];<br>}<br>let showNameMatches = linkString.match(/[(.<em>?)]/);<br>if (showNameMatches &amp;&amp; showNameMatches.length &gt; 1) {<br>showName = showNameMatches[1];<br>}<br>return [filepath, showName];<br>});<br>// 适配 [[xxx/xxxx.md#xxx|xxx]] 格式wiki链接<br>fixLink(data, /[[.</em>?]]/g, (linkString) =&gt; {<br>let [filepath, showName] = (linkString + “”)<br>.replace(&quot;[[&quot;, “”)<br>.replace(&quot;]]&quot;, “”)<br>.split(&quot;|&quot;);<br>return [filepath, showName];<br>});<br>},<br>0<br>);</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt;此脚本除了支持&#96;[xxx](xxx&#x2F;xxxx.md)&#96;格式的 markdown 引用链接还支持&#96;[[xxx&#x2F;xxxx.md#xxx|xxx]]&#96;格式的 wiki 引用链接。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">添加以上文件后，然后重新进行 hexo 编译即可支持 markdown 引用链接。</span><br><span class="line"></span><br><span class="line"># 运维部署篇</span><br><span class="line"></span><br><span class="line">## 1. 添加备案号</span><br><span class="line"></span><br><span class="line">修改 &#96;themes&#x2F;next&#x2F;layout&#x2F;_layout.swig&#96;，在footer标签里添加a链接标签，如下：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;html</span><br><span class="line">&lt;footer id&#x3D;&quot;footer&quot; class&#x3D;&quot;footer&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;footer-inner&quot;&gt;</span><br><span class="line">        &#123;% include &#39;_partials&#x2F;footer.swig&#39; %&#125;</span><br><span class="line">        &#123;% include &#39;_third-party&#x2F;analytics&#x2F;analytics-with-widget.swig&#39; %&#125;</span><br><span class="line">        &#123;% if theme.beian.enable %&#125;</span><br><span class="line">        &lt;a href&#x3D;&quot;&#123;&#123;url_for(theme.beian.url)&#125;&#125;&quot; target&#x3D;&quot;_blank&quot;&gt;&#123;&#123;theme.beian.beianNum&#125;&#125;&lt;&#x2F;a&gt;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">        &#123;% block footer %&#125;&#123;% endblock %&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;footer&gt;</span><br></pre></td></tr></table></figure><p>然后修改主题配置文件 <code>themes/next/_config.yml</code>l添加如下配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">beian:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://beian.miit.gov.cn/</span></span><br><span class="line">  <span class="attr">beianNum:</span> <span class="string">黔ICP备20002951号</span></span><br></pre></td></tr></table></figure><h2 id="2-搜索引擎优化-seo"><a class="header-anchor" href="#2-搜索引擎优化-seo">¶</a>2. 搜索引擎优化（SEO）</h2><h3 id="1-生成网站地图文件"><a class="header-anchor" href="#1-生成网站地图文件">¶</a>1) 生成网站地图文件</h3><p>针对百度和谷歌，分别有两个 hexo 插件，<code>hexo-generator-sitemap</code> 是是生成谷歌 sitemap 的插件；<code>hexo-generator-baidu-sitemap</code>则是生成百度 sitemap 的插件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save-dev</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save-dev</span><br></pre></td></tr></table></figure><p>安装完成后，重启hexo，执行<code>hexo g</code>后，在public目录下生成对应的xml文件。本地可以通过<code>http://127.0.0.4000/sitemap.xml</code>和 <code>http://127.0.0.4000/baidusitemap.xml</code>访问到 sitemap 文件。发布后可以通过 <a href="https://yourdoname/sitemap.xml" target="_blank" rel="noopener">https://yourdoname/sitemap.xml</a> 和 <a href="https://yourdoname/baidusitemap.xml" target="_blank" rel="noopener">https://yourdoname/baidusitemap.xml</a> 访问。</p><h3 id="2-添加爬虫规则文件"><a class="header-anchor" href="#2-添加爬虫规则文件">¶</a>2) 添加爬虫规则文件</h3><p>新建爬虫规则文件：<code>themes/next/source/robots.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># hexo robots.txt</span><br><span class="line">User-agent: * Allow: &#x2F;</span><br><span class="line">Allow: &#x2F;archives&#x2F;</span><br><span class="line">Disallow: &#x2F;vendors&#x2F;</span><br><span class="line">Disallow: &#x2F;js&#x2F;</span><br><span class="line">Disallow: &#x2F;css&#x2F;</span><br><span class="line">Disallow: &#x2F;fonts&#x2F;</span><br><span class="line">Disallow: &#x2F;vendors&#x2F;</span><br><span class="line">Disallow: &#x2F;fancybox&#x2F;</span><br></pre></td></tr></table></figure><h3 id="3-提交文件"><a class="header-anchor" href="#3-提交文件">¶</a>3) 提交文件</h3><ul><li>注册 <a href="https://www.google.com/webmasters/" target="_blank" rel="noopener">google网站站长</a> 平台。将 <a href="https://yourdoname/sitemap.xml" target="_blank" rel="noopener">https://yourdoname/sitemap.xml</a> 提交给google网站站长</li><li>注册 <a href="https://ziyuan.baidu.com/site/index" target="_blank" rel="noopener">百度站长</a> 平台，将 <a href="https://yourdoname/baidusitemap.xml" target="_blank" rel="noopener">https://yourdoname/baidusitemap.xml</a> 提交给百度站长</li><li>百度站长和Google网站站长都要提交 <a href="https://yourdoname/robots.txt" target="_blank" rel="noopener">https://yourdoname/robots.txt</a></li></ul><h2 id="3-静态资源压缩优化"><a class="header-anchor" href="#3-静态资源压缩优化">¶</a>3. 静态资源压缩优化</h2><p>用hexo生成静态文件时，默认生成的静态文件存在大量空白，而且css、js都未经压缩，这在一定程度上会影响页面的加载，所以在网上所搜有没有办法来优化这些问题？</p><p>答案肯定是有，当然大部分博客都提到了使用gulp来精简代码，而我今天所要跟大家介绍的是<a href="https://github.com/rozbo/hexo-neat" target="_blank" rel="noopener">hexo-neat插件</a> 。我为啥不选择gulp而使用hexo-neat呢？因为用gulp需要在每次生成静态文件后，即 <code>hexo g</code>后，都要另外执行 <code>gulp</code>命令才能压缩静态文件；而使用hexo-neat则无须另外执行其他命令即可自动完成压缩功能，即方便了使用习惯。</p><p>在站点的根目录下执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-neat --save</span><br></pre></td></tr></table></figure><p>打开 <code>myblog/_config.yml</code>全局配置文件添加如下配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#静态资源压缩优化</span></span><br><span class="line"><span class="comment"># hexo-neat</span></span><br><span class="line"><span class="attr">neat_enable:</span> <span class="literal">true</span> <span class="comment"># 启用neat</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对html优化</span></span><br><span class="line"><span class="attr">neat_html:</span>        </span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 对css优化</span></span><br><span class="line"><span class="attr">neat_css:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">'*.min.css'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对js优化</span></span><br><span class="line"><span class="attr">neat_js:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mangle:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">output:</span></span><br><span class="line">  <span class="attr">compress:</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">'*.min.js'</span></span><br></pre></td></tr></table></figure><p>做好以上几步之后，重新生成博客的时候就会自动压缩所有的 html、css、js。访问博客时能感到明显加快了。</p><h2 id="4-部署hexo到git服务器"><a class="header-anchor" href="#4-部署hexo到git服务器">¶</a>4. 部署hexo到git服务器</h2><p>下面以 GitHub 服务器为例讲解：</p><p>（1）首先要登录github创建一个 <code>user.github.io</code>仓库，仓库名比较特殊，如：<code>qcmoke.github.io</code>，此处的 <code>qcmoke</code>为你的github用户名,github正是通过这个仓库免费生成与该仓库名相同的域名，注意github只为每一位用户提供一个这样带有免费域名的 <code>github page</code>。</p><blockquote><p>💁‍♂说明:</p><p>除了 <code>user.github.io</code>这样特殊名称的仓库外，当然其他任意名称的仓库也可以设置pages服务，只是不提供域名罢了，但也能通过 <code>user.github.io/仓库名称</code>或者设置自定义域名的方式访问pages页面。</p></blockquote><p>（2）安装git文件上传插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>打开全局配置文件 <code>myblog/_config.yml</code>，找到 <code>deploy</code>并进行如下修改：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git@github.com:qcmoke/qcmoke.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><blockquote><p>其中 <code>repository</code> 的值是你 git 远程仓库的地址。</p></blockquote><p>（3）提交部署</p><p>如果你上面都配置好了，发布上传很容易，只要一句命令就能搞定。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这条命令会将public目录的文件提交上传到git远程仓库</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><blockquote><p>💁‍♂ 注意：</p><p>本地安装好后ssh key一定要配置好。 因为上传文件到github的过程中需要。</p></blockquote><p>（4）访问 <code>https://qcmoke.github.io</code>进行测试</p><blockquote><p>💁‍♂注意：</p><p>这个请求地址用你自己的，即 <code>https://user.github.io</code></p></blockquote><h2 id="5-github和coding双线路部署hexo"><a class="header-anchor" href="#5-github和coding双线路部署hexo">¶</a>5. github和coding双线路部署hexo</h2><h3 id="1-配置"><a class="header-anchor" href="#1-配置">¶</a>1) 配置</h3><p>这里讲的是hexo一次部署能够实现github和coding两个远程仓库自动同步，你只要打开全局配置文件 <code>myblog/_config.yml</code>，搜索关键字 <code>deploy</code>，根据自己远程仓库地址做以下修改：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> </span><br><span class="line">    <span class="attr">github:</span> <span class="string">git@github.com:qcmoke/qcmoke.github.io.git</span> </span><br><span class="line">    <span class="attr">coding:</span> <span class="string">git@git.coding.net:qcmoke/qcmoke.coding.me.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><h3 id="2-部署"><a class="header-anchor" href="#2-部署">¶</a>2) 部署</h3><p>和原来的单部署执行的命令一样：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>🙆‍♂ 双线路部署hexo完成。</p><h3 id="3-额外补充-v2"><a class="header-anchor" href="#3-额外补充-v2">¶</a>3) 额外补充</h3><p>其实完成以上步骤就能实现简单版的双线路部署 hexo 了，但有两个问题：</p><blockquote><ul><li>（1）不同平台上的hexo博客需要不同的域名访问</li><li>（2）双线部署的的情况下，gittalk 由于是通过域名来调用 github OAuth Apps 的 api 的，但是 github 和 coding 免费提供的是两个不同的域名，所以会导致api调用错乱而报错的问题。</li></ul></blockquote><p>我们希望用同一个域名就能同时访问 github pages 和 coding pages，即所谓的负载均衡思想，而且还要解决 gitalk api 调用错乱的问题。</p><p>解决以上问题的前提是有一个自己的域名。至于怎么获取域名，我就不废话了 啊，百度吧朋友 😅 ~！这里就假设你已经有了自己的域名，然后按照下面的步骤一步一步完成即可。</p><h4 id="1-解析域名cname记录"><a class="header-anchor" href="#1-解析域名cname记录">¶</a>(1) 解析域名CNAME记录</h4><p>将域名 CNAME 记录分别解析到你 <code>yourname.github.io</code> 和 <code>yourname.coding.me</code> 上。如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538252205493.png" alt="1538252205493"></p><p>如果你的dns解析托管服务商解析线路有“国内”线路，最好将 <code>yourname.coding.me</code>解析到国内线路。而 <code>yourname.github.io</code>解析到国外线路即可。如果没有的话，和我一样全选默认线路即可。</p><h4 id="2-设置自定义域名"><a class="header-anchor" href="#2-设置自定义域名">¶</a>(2) 设置自定义域名</h4><p>分别登录到 github 和 coding 后台，将你的域名填入并启用 https 即可。</p><p><strong>（2.1）Github</strong></p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538252756980.png" alt="1538252756980"></p><blockquote><p>💁‍♂提示：</p><p>github 目前启用自定义域名的 https 服务大概需要等 24 小时才能生效。如果到时间了还未生效，并且 “Enforce HTTPS” 是灰色的不能选择或者没有这个选项，你可以清除设置中的 custom domain 域名，再次填写保存即可解决，然后 “Enforce HTTPS” 选择打钩，一般就能启用 https 了。</p><p>💡 可选：你可以选择在仓库根目录中加入一个名为 <code>CNAME</code>的文件（或者博客源码的<code>themes/next/source</code>目录里），里面填入你的域名，这和设置中填入自定义域名的效果是一样的）</p></blockquote><p><strong>（2.2）Coding</strong></p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538252857797.png" alt="1538252857797"></p><blockquote><p>💁‍♂ 说明：</p><p>coding 需要银牌以上会员才有权限加入自定义的域名。不过银牌会员是免费的，登录 coding 后找到会员设置后点击申请并完善个人信息后就能升级到银牌会员。</p><p>🙉 目前 coding 被腾讯大哥收购后，界面改了很多，请自行解决。</p></blockquote><p>🌸 完成后你只要通过自定义的域名访问你的 git page 服务即可。</p><h4 id="3-额外补充-v3"><a class="header-anchor" href="#3-额外补充-v3">¶</a>(3) 额外补充</h4><blockquote><p>💁‍♂如果你没有使用gitalk，可以直接跳过下面的内容。</p></blockquote><p>上文中“加入评论面板”已经介绍如何创建 “github OAuth Apps”，这里额外补充说明一下，和无自定义域名的情况不同 ，有自定义域名的情况只需要一个 github OAuth Apps ，所以 Homepage URL 和 Authorization callback URL 都指向同一个地址路径，所以不同仓库下的 gitalk 实际调用的是同一个github OAuth Apps的api 。如果你之前已经为 github 博客和 coding 博客分别创建了两个 github OAuth Apps，那么我建议你可以删除掉那些无用的 github OAuth Apps 了。然后重新创建一个 github OAuth Apps，</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538254113055.png" alt="1538254113055"></p><blockquote><p>注意：github OAuth Apps 上的 Homepage URL 和 Authorization callback URL 为你博客的新地址（自定义域名地址）</p></blockquote><p>修改 <code>myblog/themes/next/_config.yml</code>主题配置文件中的 gitalk 配置，配置完成如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538284914651.png" alt="1538284914651"></p><h3 id="4-关于coding广告"><a class="header-anchor" href="#4-关于coding广告">¶</a>4) 关于coding广告</h3><p>目前使用自定义域名，coding会强制在你打开博客时放入几秒钟的广告，在此吐槽一下💢。去除这个广告页面也不是没有办法，coding提供了一些办法，其中一种就是在你的博客首页加入他们家的链接。也就是“Hosted by <a href="https://pages.coding.me/" target="_blank" rel="noopener">Coding Pages</a>”这几个字，虽然还是很讨厌，但是没办法，忍忍吧，毕竟要了人家的服务器啦。既然coding要求帮他们打广告，而我又用的是双线部署hexo博客到github和coding上的方案，故将计就计，那也顺便帮github打广告啦。具体做法如下:</p><p>在 <code>myblog/themes/next/layout/_partials/footer.swig</code>中找到如下代码块:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  &#123;% if theme.post_wordcount.totalcount %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-meta-divider"</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-meta-item-icon"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-area-chart"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    &#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-meta-item-text"</span>&gt;</span>&#123;&#123; __('post.totalcount') &#125;&#125;:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; __('post.totalcount') &#125;&#125;"</span>&gt;</span>&#123;#</span><br><span class="line">    #&#125;&#123;&#123; totalcount(site, '0,0.0a') &#125;&#125;&#123;#</span><br><span class="line">  #&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>另起一行，添加如下代码:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Github Pages and coding pages ad --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Hosted by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://pages.github.com"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold"</span>&gt;</span>Github Pages<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  and  </span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Hosted by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://pages.coding.me"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold"</span>&gt;</span>Coding Pages<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>以上完成后还没结束，还要登录到coding后台设置选择“已放置 Hosted by Coding Pages”打钩。但你可能找不到这个设置页面，你需要切换coding主页回旧版再找pages服务设置，就能找到这个设置了，如下：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538276541146.png" alt="1538276541146"></p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/1538276615247.png" alt="1538276615247"></p><p>Hosted by Coding Pages 提交后需要审核，会在两个工作日内为你处理。处理成功后就不会有打开博客主页前的几秒钟广告推送了。</p><h1 id="滚动改版篇"><a class="header-anchor" href="#滚动改版篇">¶</a>滚动改版篇</h1><h2 id="1-hexo升级至4-2-1"><a class="header-anchor" href="#1-hexo升级至4-2-1">¶</a>1. hexo升级至4.2.1</h2><blockquote><p>原来版本：<code>hexo@3.7.1</code> + <code>hexo-theme-next@5.1.4</code></p><p>升级版本：<code>hexo@4.2.1</code> + <code>hexo-theme-next@5.1.4</code></p></blockquote><p>原本使用的<code>hexo@3.7.1</code>版本，一直有个问题，那就是引用里如果使用代码块，那么代码块的每行开头都会多出字符<code>&gt;</code>。如下图：</p><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/Snipaste_2023-04-17_04-02-20.png" alt="Snipaste_2023-04-17_04-02-20"></p><p>为了解决以上问题我把hexo版本升级到了<code>4.2.1</code>。其实只要升级到<code>4.0.0</code>以上的版本都可以，但<code>5.0.0</code>的改动太大了所以就没改升，故而选择了<code>hexo@4.x.x</code>的最后一个版本<code>hexo@4.2.1</code>。</p><p>但是升级到<code>hexo@4.2.1</code>后又发现出现了一些其他的问题，需要手动适配。主要适配内容为以下：</p><blockquote><ol><li>点击博客菜单按钮时无法打开页面，原本的url会多出<code>%20</code>等编码字符串，如：<code>http://localhost:4000/categories/%20/</code>，其主要原因是使用了<code>encodeURI</code>编码了链接，但是原本菜单的配置多出了空格，如：<code>categories: /categories/ || th</code>。</li></ol><p>解决办法有两个</p><p>（1）只要把<code>||</code>前面的空格去掉就可以了。如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line"><span class="comment">#about: /about/ || user</span></span><br><span class="line"><span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line"><span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line"></span><br><span class="line"><span class="string">上面修改为如下（删除path中多余空格）：</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="attr">home:</span> <span class="string">/||</span> <span class="string">home</span></span><br><span class="line"><span class="comment">#about: /about/ || user</span></span><br><span class="line"><span class="attr">tags:</span> <span class="string">/tags/||</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">/categories/||</span> <span class="string">th</span></span><br><span class="line"><span class="attr">archives:</span> <span class="string">/archives/||</span> <span class="string">archive</span></span><br></pre></td></tr></table></figure><p>（2）还有一种办法就是在跳转前的代码中把空格去除掉（我使用的是这种）。</p><p>修改<code>themes/next/layout/_macro/sidebar.swig</code>文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;&#123;&#123; url_for(theme.menu.archives).split(&#39;||&#39;)[0] | trim &#125;&#125;&quot;&gt;</span><br><span class="line">改成</span><br><span class="line">&lt;a href&#x3D;&quot;&#123;&#123; url_for(theme.menu.archives.split(&#39;||&#39;)[0] | trim )&#125;&#125;&quot;&gt;</span><br></pre></td></tr></table></figure><p>修改<code>themes/next/layout/_partials/header.swig</code>文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;&#123;&#123; url_for(path.split(&#39;||&#39;)[0]) | trim &#125;&#125;&quot; rel&#x3D;&quot;section&quot;&gt;</span><br><span class="line">改成</span><br><span class="line">&lt;a href&#x3D;&quot;&#123;&#123; url_for(path.split(&#39;||&#39;)[0] | trim )&#125;&#125;&quot; rel&#x3D;&quot;section&quot;&gt;</span><br></pre></td></tr></table></figure><blockquote><p>参考：</p><p><a href="https://github.com/iissnan/hexo-theme-next/issues/2233" target="_blank" rel="noopener">https://github.com/iissnan/hexo-theme-next/issues/2233</a></p><p><a href="https://github.com/SevenNorth/AshesBlog/commit/e758caa65ccd3a9da20ebfadb35573257de6b35b" target="_blank" rel="noopener">https://github.com/SevenNorth/AshesBlog/commit/e758caa65ccd3a9da20ebfadb35573257de6b35b</a></p></blockquote><ol start="2"><li>首页底部分页按钮无法识别字体图标而直接展示出<code>html</code>标签代码出来，如下图</li></ol><p><img src="/blog/../images/loading-post.gif" data-original="hexo_next/image-20230417095200752.png" alt="image-20230417095200752"></p><p>为了解决这个问题，需要修改<code>themes/next/layout/_partials/pagination.swig</code>，添加<code>escape: false</code>，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if page.prev or page.next %&#125;</span><br><span class="line">  &lt;nav class&#x3D;&quot;pagination&quot;&gt;</span><br><span class="line">    &#123;&#123;</span><br><span class="line">      paginator(&#123;</span><br><span class="line">        prev_text: &#39;&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;&#39;,</span><br><span class="line">        next_text: &#39;&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;&#39;,</span><br><span class="line">        mid_size: 1,</span><br><span class="line">        escape: false</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  &lt;&#x2F;nav&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>参考：</p><p><a href="https://www.4spaces.org/856.html" target="_blank" rel="noopener">https://www.4spaces.org/856.html</a></p><p><a href="https://github.com/theme-next/hexo-theme-next/blob/master/layout/_partials/pagination.swig" target="_blank" rel="noopener">https://github.com/theme-next/hexo-theme-next/blob/master/layout/_partials/pagination.swig</a></p></blockquote></blockquote><h1 id="参考"><a class="header-anchor" href="#参考">¶</a>参考</h1><p>📚https://easyhexo.com</p><p>📚https://io-oi.me/tech/hexo-next-optimization</p><p>📚https://www.liaofuzhan.com/posts/2114475547.html</p></div><div><div><br><br><div style="text-align:center;color:#ccc;font-size:14px">----------- 本文结束 -----------</div><br><br><br><br></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>如果你觉得我的文章对你有帮助，你可以打赏我哦~</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="../images/loading-post.gif" data-original="/images/wechatpay.png" alt="Qcmoke 微信支付"><p>微信支付</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/github/" rel="tag"><i class="fa fa-tag"></i> github</a> <a href="/tags/hexo/" rel="tag"><i class="fa fa-tag"></i> hexo</a> <a href="/tags/next/" rel="tag"><i class="fa fa-tag"></i> next</a> <a href="/tags/coding/" rel="tag"><i class="fa fa-tag"></i> coding</a></div><div class="post-widgets"><div class="wp_rating"><div id="wpac-rating"></div></div><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/tools/sublime_use.html" rel="prev" title="sublime text3使用指南"><i class="fa fa-chevron-left"></i> sublime text3使用指南</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/blog/typecho_http_https.html" rel="next" title="typecho从http转https">typecho从http转https <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div class="tablink-li"><button class="tablink" onclick='openPage("tabs-gitalk",this)' id="defaultOpen">Gitalk</button> <button class="tablink" onclick='openPage("tabs-valine",this)'>Valine</button></div><div class="tabcontent-li"><div id="tabs-gitalk" class="tabcontent"><div id="gitalk-container"></div></div><div id="tabs-valine" class="tabcontent"><div id="comments-valine"></div></div></div></div><script>function openPage(e,t){for(var n=document.getElementsByClassName("tabcontent"),l=0;l<n.length;l++)n[l].style.display="none";for(tablinks=document.getElementsByClassName("tablink"),l=0;l<tablinks.length;l++)tablinks[l].classList.remove("currentTabcontent");document.getElementById(e).style.display="block",t.classList.add("currentTabcontent")}document.getElementById("defaultOpen").click()</script></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/"><img class="site-author-image" itemprop="image" src="../images/loading-post.gif" data-original="/images/logo.jpg" alt="Qcmoke"></a><p class="site-author-name" itemprop="name">Qcmoke</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">83</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">8</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">91</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:qcmoke@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://github.com/qcmoke" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://weibo.com/u/5469824288" target="_blank" title="weibo"><i class="fa fa-fw fa-weibo"></i>weibo</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li class="recent_posts_li"><a href="/windows/clean_c_drive.html" title="Windows系统C盘清理" target="_blank">Windows系统C盘清理</a></li><li class="recent_posts_li"><a href="/devops/lvs.html" title="lvs学习笔记" target="_blank">lvs学习笔记</a></li><li class="recent_posts_li"><a href="/devops/mysql_ha.html" title="Keepalived+MySQL实现高可用" target="_blank">Keepalived+MySQL实现高可用</a></li><li class="recent_posts_li"><a href="/devops/keepalived.html" title="keepalived学习笔记" target="_blank">keepalived学习笔记</a></li><li class="recent_posts_li"><a href="/tools/pyenv.html" title="python版本管理工具pyenv" target="_blank">python版本管理工具pyenv</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#基础功能篇"><span class="nav-text">基础功能篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-搭建hexo环境"><span class="nav-text">1. 搭建hexo环境</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安装和配置git"><span class="nav-text">1) 安装和配置git</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-安装node-js"><span class="nav-text">2) 安装node.js</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-安装hexo"><span class="nav-text">3) 安装hexo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-使用hexo"><span class="nav-text">4) 使用hexo</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-编写文章"><span class="nav-text">2. 编写文章</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-更换主题"><span class="nav-text">3. 更换主题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-更换主题布局"><span class="nav-text">4. 更换主题布局</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-菜单栏添加菜单选项"><span class="nav-text">5. 菜单栏添加菜单选项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-默认中文简体显示设置"><span class="nav-text">6. 默认中文简体显示设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-更改博客作者名和主页地址"><span class="nav-text">7. 更改博客作者名和主页地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-启用侧边栏社交链接"><span class="nav-text">8. 启用侧边栏社交链接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-侧栏添加外链"><span class="nav-text">9. 侧栏添加外链</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-去除侧栏目录自动生成的序数"><span class="nav-text">10.去除侧栏目录自动生成的序数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-设置头像"><span class="nav-text">11. 设置头像</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-基础设置"><span class="nav-text">1) 基础设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-定制圆形头像"><span class="nav-text">2) 定制圆形头像</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-设置浏览器标签图标"><span class="nav-text">12. 设置浏览器标签图标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-首页文章缩略描述设置"><span class="nav-text">13. 首页文章缩略描述设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-添加3d动画背景"><span class="nav-text">14. 添加3D动画背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-增加本地搜索功能"><span class="nav-text">15. 增加本地搜索功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-置顶按钮显示百分比"><span class="nav-text">16. 置顶按钮显示百分比</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-文章字数和阅读时长统计"><span class="nav-text">17. 文章字数和阅读时长统计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-隐藏底部的-强力驱动-内容"><span class="nav-text">18. 隐藏底部的“强力驱动”内容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#19-图片点击放大功能支持"><span class="nav-text">19. 图片点击放大功能支持</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-文章应用本地图片"><span class="nav-text">20. 文章应用本地图片</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#21-修改文章链接组成形式"><span class="nav-text">21. 修改文章链接组成形式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#21-支持emoji文字表情"><span class="nav-text">21. 支持emoji文字表情</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-更改上下篇的顺序"><span class="nav-text">22. 更改上下篇的顺序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#23-添加页面加载效果"><span class="nav-text">23. 添加页面加载效果</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#24-图片懒加载"><span class="nav-text">24. 图片懒加载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#25-开启打赏功能"><span class="nav-text">25. 开启打赏功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#26-文章分享功能"><span class="nav-text">26. 文章分享功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方案1-jiathis"><span class="nav-text">方案1 jiathis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方案2-needmoreshare2"><span class="nav-text">方案2 needmoreshare2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方案3-baidushare"><span class="nav-text">方案3 baidushare</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#27-优化深色代码高亮背景"><span class="nav-text">27. 优化深色代码高亮背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#28-优化文章底部带标签"><span class="nav-text">28. 优化文章底部带标签</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#29-文章末尾添加-本文结束-标记"><span class="nav-text">29. 文章末尾添加“本文结束”标记</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#30-优化文章内链接文本样式"><span class="nav-text">30. 优化文章内链接文本样式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#31-gemini布局返回顶部按钮适配移动端"><span class="nav-text">31. Gemini布局返回顶部按钮适配移动端</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#32-禁用特定文章侧栏目录"><span class="nav-text">32. 禁用特定文章侧栏目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#33-文章引用音乐和视频"><span class="nav-text">33. 文章引用音乐和视频</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-html原生方式"><span class="nav-text">1) html原生方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-音乐面板"><span class="nav-text">(1) 音乐面板</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-视频面板"><span class="nav-text">(2) 视频面板</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-第三方插件方式"><span class="nav-text">2) 第三方插件方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-音乐面板插件"><span class="nav-text">(1) 音乐面板插件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-视频面板-v2"><span class="nav-text">(2) 视频面板</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-音乐面板综合案例"><span class="nav-text">3) 音乐面板综合案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-视频面板综合案例"><span class="nav-text">4) 视频面板综合案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#34-添加看板娘"><span class="nav-text">34) 添加看板娘</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第三方服务篇"><span class="nav-text">第三方服务篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-添加评分功能"><span class="nav-text">1. 添加评分功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-网站访问统计"><span class="nav-text">2. 网站访问统计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-不蒜子统计"><span class="nav-text">1) 不蒜子统计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-leancloud统计"><span class="nav-text">2) leancloud统计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-额外补充"><span class="nav-text">3) 额外补充</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-加入评论面板"><span class="nav-text">3. 加入评论面板</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-gitalk"><span class="nav-text">1) Gitalk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-vssue"><span class="nav-text">2) Vssue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-valine"><span class="nav-text">3) Valine</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-整合多个评论面板"><span class="nav-text">4) 整合多个评论面板</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-添加热门文章页面"><span class="nav-text">4. 添加热门文章页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-添加在线联系功能"><span class="nav-text">5. 添加在线联系功能</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#高级定制篇"><span class="nav-text">高级定制篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-自定义首页摘要图片和摘要描述"><span class="nav-text">1. 自定义首页摘要图片和摘要描述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-概述"><span class="nav-text">1) 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-具体实现"><span class="nav-text">2) 具体实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-优化首页摘要样式"><span class="nav-text">3) 优化首页摘要样式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-优化标签云页面"><span class="nav-text">2. 优化标签云页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-添加404页面"><span class="nav-text">3. 添加404页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-添加最近文章栏目"><span class="nav-text">4. 添加最近文章栏目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-自定义友情链接页面"><span class="nav-text">5. 自定义友情链接页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方案1-纯静态文件"><span class="nav-text">方案1 纯静态文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方案2-模板引擎swig"><span class="nav-text">方案2 模板引擎swig</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-优化和美化代码块"><span class="nav-text">6. 优化和美化代码块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-添加代码块全选复制功能"><span class="nav-text">6.1 添加代码块全选复制功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-添加mac代码面板"><span class="nav-text">6.2 添加mac代码面板</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-mac代码面板整合全选复制按钮"><span class="nav-text">6.3 mac代码面板整合全选复制按钮</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#调整说明"><span class="nav-text">调整说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#整合步骤"><span class="nav-text">整合步骤</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-添加暗黑模式支持"><span class="nav-text">7. 添加暗黑模式支持</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-魔改next主题"><span class="nav-text">8. 魔改next主题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-hexo支持本地markdown文件链接引用"><span class="nav-text">9. hexo支持本地Markdown文件链接引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-搜索引擎优化-seo"><span class="nav-text">2. 搜索引擎优化（SEO）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-生成网站地图文件"><span class="nav-text">1) 生成网站地图文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-添加爬虫规则文件"><span class="nav-text">2) 添加爬虫规则文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-提交文件"><span class="nav-text">3) 提交文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-静态资源压缩优化"><span class="nav-text">3. 静态资源压缩优化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-部署hexo到git服务器"><span class="nav-text">4. 部署hexo到git服务器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-github和coding双线路部署hexo"><span class="nav-text">5. github和coding双线路部署hexo</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-配置"><span class="nav-text">1) 配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-部署"><span class="nav-text">2) 部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-额外补充-v2"><span class="nav-text">3) 额外补充</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-解析域名cname记录"><span class="nav-text">(1) 解析域名CNAME记录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-设置自定义域名"><span class="nav-text">(2) 设置自定义域名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-额外补充-v3"><span class="nav-text">(3) 额外补充</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-关于coding广告"><span class="nav-text">4) 关于coding广告</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#滚动改版篇"><span class="nav-text">滚动改版篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-hexo升级至4-2-1"><span class="nav-text">1. hexo升级至4.2.1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考"><span class="nav-text">参考</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Qcmoke</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv">本站访客数 <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 人次 </span><span class="site-pv">本站总访问量 <span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次</span></div><a href="https://beian.miit.gov.cn/" target="_blank">黔ICP备20002951号-1</a></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><i id="darkmode" class="fa fa-lightbulb-o" aria-hidden="true"></i><script>var body=$("body"),darkmode=$("#darkmode");!matchMedia("(prefers-color-scheme: dark)").matches&&"1"!==localStorage.getItem("darkmode")||"1"===localStorage.getItem("noDark")||body.addClass("dark"),body.hasClass("dark")?darkmode.removeClass("fa-moon-o").addClass("fa-lightbulb-o"):darkmode.removeClass("fa-lightbulb-o").addClass("fa-moon-o"),darkmode.click(function(){body.hasClass("dark")?(darkmode.removeClass("fa-lightbulb-o").addClass("fa-moon-o"),body.removeClass("dark"),localStorage.setItem("darkmode","0"),localStorage.setItem("noDark","1")):(darkmode.removeClass("fa-moon-o").addClass("fa-lightbulb-o"),body.addClass("dark"),localStorage.setItem("darkmode","1"),localStorage.setItem("noDark","0"))})</script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/clipboard.min.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/highlight-wrap.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script src="/js/src/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">for(var emoticonList=[],i=1;i<=164;i++)emoticonList.push("aru ("+i+").png");new Valine({lang:"zh-cn",admin_email:"qcmoke@gmail.com",el:"#comments-valine",appId:"6LNbUERxbG0OAnWfmJSbmXiW-MdYXbMMI",appKey:"d2FLy9fmXOTiM8TrokuIuDWx",placeholder:"留下你的小爪印吧~",serverURLs:"https://leancloud.qcmoke.cn"})</script><script>var checkExist;window.location.hash&&(checkExist=setInterval(function(){$(window.location.hash).length&&($("html, body").animate({scrollTop:$(window.location.hash).offset().top-90},1e3),clearInterval(checkExist))},100))</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script type="text/javascript">const gitalk=new Gitalk({clientID:"d933e443cdfe503ce05a",clientSecret:"149d163f4b10cedf7a68993289da9c0f0836bd34",repo:"mygitalk",owner:"qcmoke",admin:"qcmoke".split(","),id:location.pathname,distractionFreeMode:"true",createIssueManually:"true"});gitalk.render("gitalk-container")</script><script type="text/javascript">var isfetched=!1,isXml=!0,search_path="search.xml",path=(0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1),"/"+search_path),onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")};function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var searchFunc=function(t,s,a){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");function e(){var e,m=n.value.trim().toLowerCase(),x=m.split(/[\s\-]+/),w=(1<x.length&&x.push(m),[]);0<m.length&&o.forEach(function(t){var e=!1,o=0,h=0,n=t.title.trim(),r=n.toLowerCase(),s=t.content.trim().replace(/<[^>]+>/g,""),a=s.toLowerCase(),i=decodeURIComponent(t.url),c=[],l=[];if(""!=n&&(x.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r,s=0,a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());-1<(r=e.indexOf(t,s));)a.push({position:r,word:t}),s=r+n;return a}c=c.concat(e(t,r,!1)),l=l.concat(e(t,a,!1))}),0<c.length||0<l.length)&&(e=!0,o=c.length+l.length),e){function p(t,e,o,n){for(var r=n[n.length-1],s=r.position,a=r.word,i=[],c=0;s+a.length<=o&&0!=n.length;){a===m&&c++,i.push({position:s,length:a.length});var l=s+a.length;for(n.pop();0!=n.length&&(s=(r=n[n.length-1]).position,a=r.word,s<l);)n.pop()}return h+=c,{hits:i,start:e,end:o,searchTextCount:c}}[c,l].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});for(var t=[],u=(0!=c.length&&t.push(p(0,0,n.length,c)),[]);0!=l.length;){var f=l[l.length-1],d=f.position,f=f.word,g=d-20,v=d+80;g<0&&(g=0),(v=v<d+f.length?d+f.length:v)>s.length&&(v=s.length),u.push(p(0,g,v,l))}u.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});e=parseInt("1");function $(o,t){var n="",r=t.start;return t.hits.forEach(function(t){n+=o.substring(r,t.position);var e=t.position+t.length;n+='<b class="search-keyword">'+o.substring(t.position,e)+"</b>",r=e}),n+=o.substring(r,t.end)}0<=e&&(u=u.slice(0,e));var C="";C+=0!=t.length?"<li><a href='"+i+"' class='search-result-title'>"+$(n,t[0])+"</a>":"<li><a href='"+i+"' class='search-result-title'>"+n+"</a>",u.forEach(function(t){C+="<a href='"+i+'\'><p class="search-result">'+$(s,t)+"...</p></a>"}),C+="</li>",w.push({item:C,searchTextCount:h,hitCount:o,id:w.length})}}),1===x.length&&""===x[0]?r.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>':0===w.length?r.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>':(w.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id}),e='<ul class="search-result-list">',w.forEach(function(t){e+=t.item}),e+="</ul>",r.innerHTML=e)}var o=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,n=document.getElementById(s),r=document.getElementById(a);n.addEventListener("input",e),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script>function addCount(n){var t=$(".leancloud_visitors"),o=t.attr("id").trim(),i=t.attr("data-flag-title").trim();n("get","/classes/Counter",{where:JSON.stringify({url:o})}).done(function({results:t}){var e;0<t.length?(e=t[0],n("put","/classes/Counter/"+e.objectId,JSON.stringify({time:{__op:"Increment",amount:1}})).done(function(){$(document.getElementById(o)).find(".leancloud-visitors-count").text(e.time+1)}).fail(function({responseJSON:t}){console.log("Failed to save Visitor num, with error message: "+t.error)})):n("post","/classes/Counter",JSON.stringify({title:i,url:o,time:1})).done(function(){$(document.getElementById(o)).find(".leancloud-visitors-count").text(1)}).fail(function(){console.log("Failed to create")})}).fail(function({responseJSON:t}){console.log("LeanCloud Counter Error: "+t.code+" "+t.error)})}$(function(){$.get("https://app-router.leancloud.cn/2/route?appId=6LNbUERxbG0OAnWfmJSbmXiW-MdYXbMMI").done(function({}){/http:\/\/(localhost|127.0.0.1|0.0.0.0)/.test(document.URL)||addCount(function(t,e,n){return $.ajax({method:t,url:"https://leancloud.qcmoke.cn/1.1"+e,headers:{"X-LC-Id":"6LNbUERxbG0OAnWfmJSbmXiW-MdYXbMMI","X-LC-Key":"d2FLy9fmXOTiM8TrokuIuDWx","Content-Type":"application/json"},data:n})})})})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"default",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions)</script><script type="text/javascript">(wpac_init=window.wpac_init||[]).push({widget:"Rating",id:23769,el:"wpac-rating",color:"fc6423"}),function(){var e,t;"WIDGETPACK_LOADED"in window||(WIDGETPACK_LOADED=!0,(e=document.createElement("script")).type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js",(t=document.getElementsByTagName("script")[0]).parentNode.insertBefore(e,t.nextSibling))}()</script><script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).top&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"left","width":80,"height":130},"mobile":{"show":false},"log":false});</script></body></html>